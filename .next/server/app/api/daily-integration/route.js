"use strict";(()=>{var e={};e.id=884,e.ids=[884],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},707:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>h,patchFetch:()=>m,requestAsyncStorage:()=>u,routeModule:()=>l,serverHooks:()=>g,staticGenerationAsyncStorage:()=>d});var r={};n.r(r),n.d(r,{POST:()=>c});var i=n(9303),a=n(8716),o=n(670),s=n(9869);async function c(e){try{let{sessionData:t,ladderResults:n,integrationPreference:r}=await e.json();if(!t)return Response.json({success:!1,error:"Missing session data for daily integration"},{status:400});let i=new s.DailyIntegrationLayer,a=await i.generateDailyIntegration(t,n||{},r);return Response.json(a)}catch(e){return console.error("Error in Daily Integration API:",e),Response.json({success:!1,error:"Internal server error generating daily integration",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let l=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/daily-integration/route",pathname:"/api/daily-integration",filename:"route",bundlePath:"app/api/daily-integration/route"},resolvedPagePath:"/Users/dancross/Documents/GitHub/WovenWebApp/app/api/daily-integration/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:u,staticGenerationAsyncStorage:d,serverHooks:g}=l,h="/api/daily-integration/route";function m(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:d})}},9303:(e,t,n)=>{e.exports=n(517)},9869:(e,t,n)=>{let r=n(3809);class i{constructor(){this.recognitionPatterns=new a,this.weightBelt=new o}async generateDailyIntegration(e,t,n="gentle"){try{r.info("Generating daily integration layer",{sessionId:e.sessionId,preference:n});let i=await this.recognitionPatterns.generatePrompts(e,n),a=await this.weightBelt.createSummary(e,t,n),o=this.buildIntegrationRhythm(e,n);return{success:!0,dailyIntegration:{recognitionLayer:i,weightBelt:a,rhythm:o,preference:n},metadata:{sessionId:e.sessionId,generatedAt:new Date().toISOString(),hookStackCount:e.hookStack?.titles?.length||0,therapeuticMode:t?.entryPoint||"general"}}}catch(t){return r.error("Error generating daily integration layer",{error:t.message,sessionId:e.sessionId}),{success:!1,error:"Unable to generate daily integration",fallback:this.generateFallbackIntegration(e)}}}buildIntegrationRhythm(e,t){let n=e.hookStack?.volatilityIndex||0,r=e.sessionScores?.accuracy||.7,i={minimal:{frequency:"Once per day",duration:"30 seconds",approach:"Quick check-in"},gentle:{frequency:"2-3 times per day",duration:"1-2 minutes",approach:"Mindful noticing"},active:{frequency:"3-4 times per day",duration:"2-5 minutes",approach:"Conscious integration"}},a=i[t]||i.gentle;return n>7?(a.note="High-energy patterns suggest more frequent but shorter check-ins",a.adjustment="Consider more frequent, gentler touches"):r<.6&&(a.note="Lower accuracy suggests slower, deeper integration",a.adjustment="Take more time with each recognition moment"),a}generateFallbackIntegration(e){return{type:"fallback",recognitionLayer:{morningPrompt:"What energy am I noticing as I start this day?",middayPrompt:"How are the patterns from my session showing up?",eveningPrompt:"What did I learn about myself today?"},weightBelt:{coreReminder:"I have astrological patterns that support my awareness.",carryForward:"I can notice without needing to fix or change anything."}}}}class a{constructor(){this.promptTemplates={WB:{morning:"Notice what feels aligned and familiar today",midday:"Check in: What's resonating as expected?",evening:"Acknowledge what felt true to your patterns today"},ABE:{morning:"Pay attention to edge spaces and transitions",midday:"Notice: What's at the boundary of comfortable?",evening:"Reflect on moments that stretched you gently"},OSR:{morning:"Be curious about what feels different or surprising",midday:"Check: What doesn't fit the usual pattern?",evening:"Honor the parts that don't match expectations"}}}async generatePrompts(e,t){let n=this.analyzeSSTPatter(e.sstLogs||[]),r=this.extractThemes(e.hookStack);return{morning:this.buildMorningPrompt(n,r,t),midday:this.buildMiddayPrompt(n,r,t),evening:this.buildEveningPrompt(n,r,t),sstFocus:n.dominant,customPrompts:this.generateCustomPrompts(r,t)}}analyzeSSTPatter(e){let t={WB:0,ABE:0,OSR:0};return e.forEach(e=>{t.hasOwnProperty(e.category)&&t[e.category]++}),{dominant:Object.keys(t).reduce((e,n)=>t[e]>t[n]?e:n),counts:t,pattern:this.interpretPattern(t)}}interpretPattern(e){let t=e.WB+e.ABE+e.OSR;if(0===t)return"exploratory";let n=e.WB/t,r=e.ABE/t,i=e.OSR/t;return n>.6?"aligned":r>.4?"edge-aware":i>.3?"expansive":"balanced"}extractThemes(e){return e?.titles?.length?[...new Set(e.titles.map(e=>{let t=e.title.toLowerCase();return t.includes("relationship")||t.includes("connection")?"relational":t.includes("creative")||t.includes("expression")?"creative":t.includes("change")||t.includes("transformation")?"transitional":t.includes("power")||t.includes("authority")?"personal-power":t.includes("healing")||t.includes("growth")?"developmental":"integrative"}))]:["awareness","presence"]}buildMorningPrompt(e,t,n){let r=this.promptTemplates[e.dominant]?.morning||"Notice what energy you're bringing to this day";if("minimal"===n)return r;let i=this.getThemeAddition(t[0],"morning");return`${r}. ${i}`}buildMiddayPrompt(e,t,n){let r=this.promptTemplates[e.dominant]?.midday||"Pause and check in with your current experience";if("minimal"===n)return r;let i=this.getThemeAddition(t[0],"midday");return`${r} ${i}`}buildEveningPrompt(e,t,n){let r=this.promptTemplates[e.dominant]?.evening||"Reflect on what you noticed about yourself today";if("minimal"===n)return r;let i=this.getThemeAddition(t[0],"evening");return`${r}. ${i}`}getThemeAddition(e,t){let n={relational:{morning:"Especially notice your connections with others.",midday:"How are your relationships feeling?",evening:"What did you learn about connection today?"},creative:{morning:"Pay attention to creative impulses.",midday:"What wants to be expressed?",evening:"Honor any creative stirrings from today."},transitional:{morning:"Notice what's shifting or changing.",midday:"What transitions are you in?",evening:"Acknowledge the changes you're navigating."},default:{morning:"Stay curious about what emerges.",midday:"What patterns are you noticing?",evening:"What insights surfaced today?"}};return n[e]?.[t]||n.default[t]}generateCustomPrompts(e,t){return"minimal"===t?[]:e.map(e=>({theme:e,prompt:`When you notice ${e} energy, pause and ask: What is this trying to show me?`,frequency:"As needed"}))}}class o{constructor(){this.summaryTypes={essence:"Core theme distillation",reminder:"Daily integration anchor",compass:"Decision-making guide",touchstone:"Grounding reference"}}async createSummary(e,t,n){let r=this.distillEssence(e,t),i=this.createDailyReminder(e,n);return{cards:{essence:r,reminder:i,compass:this.buildDecisionCompass(e,t),touchstone:this.createTouchstone(e)},carryForward:this.selectCarryForward(r,i,n),shareableFormat:this.createShareableFormat(r,i,e)}}distillEssence(e,t){let n=e.hookStack?.titles?.[0];return(t?.entryPoint,n)?{title:n.title,essence:`Your ${n.title} energy is actively supporting your growth`,energy:n.polarity||"Balanced",intensity:Math.round(100*n.intensity)+"%"}:{title:"Astrological Awareness",essence:"Your chart reflects patterns worth noticing",energy:"Present and aware"}}createDailyReminder(e,t){let n=e.sessionScores?.accuracy||.7,r=e.hookStack?.titles?.[0]?.title||"your patterns",i={minimal:`Notice ${r} energy when it arises.`,gentle:`You have ${r} support available - trust what you notice.`,active:`Your ${r} patterns are working with you. Pay attention to the signals.`};return{text:i[t]||i.gentle,confidence:`${Math.round(100*n)}% session accuracy`,approach:"Notice before action"}}buildDecisionCompass(e,t){let n=t?.ladderTree?.find(e=>"choicePair"===e.rung),r=e.hookStack?.titles?.[0];return n?{question:"When facing decisions, ask:",compass:"Which choice honors both my boundaries and my growth?",reference:n.content.agencyReminder||"You have agency in your responses"}:{question:"When facing decisions, ask:",compass:"What would support both my stability and my authenticity?",reference:r?`Consider your ${r.title} needs`:"Trust your inner wisdom"}}createTouchstone(e){let t=e.hookStack?.volatilityIndex||0,n=e.driftIndex||0;return t>6||n>.6?{touchstone:"I am stable even when energies are active",grounding:"Breathe and feel your feet on the ground",reminder:"Intensity is temporary; your core self is steady"}:{touchstone:"I can trust what I notice about myself",grounding:"Pause and check in with your body",reminder:"Your patterns are supporting your awareness"}}selectCarryForward(e,t,n){return"minimal"===n?{type:"reminder",content:t.text,usage:"Reference when needed"}:{type:"essence",content:`${e.title}: ${e.essence}`,usage:"Daily awareness anchor"}}createShareableFormat(e,t,n){let r=new Date().toLocaleDateString();return{format:"text",content:`
Daily Integration â€¢ ${r}

Core Theme: ${e.title}
${e.essence}

Daily Reminder: ${t.text}

Generated from your astrological session with ${n.hookStack?.titles?.length||"multiple"} Hook Stack patterns.
            `.trim(),metadata:{sessionId:n.sessionId,generatedAt:new Date().toISOString(),version:"Weight Belt v1.0"}}}}e.exports={DailyIntegrationLayer:i}},3809:e=>{let t=process.env.LOG_LEVEL||"info",n={error:0,warn:1,info:2,debug:3};function r(e){return n[e]<=n[t]}function i(e,t,n={}){let r=new Date().toISOString(),i=Object.keys(n).length>0?JSON.stringify(n):"";return`[${r}] ${e.toUpperCase()}: ${t} ${i}`}e.exports={error:(e,t={})=>{r("error")&&console.error(i("error",e,t))},warn:(e,t={})=>{r("warn")&&console.warn(i("warn",e,t))},info:(e,t={})=>{r("info")&&console.log(i("info",e,t))},debug:(e,t={})=>{r("debug")&&console.log(i("debug",e,t))}}}};var t=require("../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[948],()=>n(707));module.exports=r})();