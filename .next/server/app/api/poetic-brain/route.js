"use strict";(()=>{var e={};e.id=619,e.ids=[619],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},120:(e,t,i)=>{i.r(t),i.d(t,{originalPathname:()=>R,patchFetch:()=>j,requestAsyncStorage:()=>$,routeModule:()=>y,serverHooks:()=>I,staticGenerationAsyncStorage:()=>S});var o={};i.r(o),i.d(o,{POST:()=>x,runtime:()=>f});var r=i(9303),a=i(8716),n=i(670);function s(e){if(null!=e){if("number"==typeof e)return Number.isFinite(e)?e:void 0;if("object"==typeof e&&e&&"number"==typeof e.value)return Number.isFinite(e.value)?e.value:void 0}}function l(e){return void 0===e?{tone:"mixed",descriptor:"mixed tilt"}:e>.25?{tone:"supportive",descriptor:"supportive tilt"}:e<-.25?{tone:"restrictive",descriptor:"restrictive tilt"}:{tone:"mixed",descriptor:"mixed tilt"}}function p(e){return void 0===e?{label:"variable distribution"}:e>=.66?{label:"high volatility (scattered strikes)"}:e<=.33?{label:"low volatility (focused pull)"}:{label:"moderate volatility"}}function u(e){return void 0===e||e<.5?{band:0,label:"Dormant / Baseline"}:e<1.5?{band:1,label:"Murmur / Whisper"}:e<2.5?{band:2,label:"Pulse / Stirring"}:e<3.5?{band:3,label:"Surge / Activation"}:e<4.5?{band:4,label:"Convergence / Compression"}:{band:5,label:"Maximum Threshold / Structural Overload"}}function c(e){if(!e||!Array.isArray(e))return[];let t=[];for(let i of e)i&&("string"==typeof i?t.push({label:i}):"object"==typeof i&&"string"==typeof i.label&&t.push(i));return t.sort((e,t)=>{let i=e.exact?1:0,o=t.exact?1:0;return i!==o?o-i:(e.orb??Number.POSITIVE_INFINITY)-(t.orb??Number.POSITIVE_INFINITY)}).slice(0,3)}function d(e){let t=s(e.seismograph?.magnitude),i=s(e.seismograph?.valence),o=s(e.seismograph?.volatility),{band:r,label:a}=u(t),n=l(i),c=p(o),d=[];return d.push(`Magnitude ${void 0!==t?t.toFixed(2):"—"} (⚡ ${a} at ${r})`),d.push(`Valence ${void 0!==i?i.toFixed(2):"—"} (${n.descriptor})`),d.push(`Volatility ${void 0!==o?o.toFixed(2):"—"} (${c.label})`),{headline:`${a} with ${n.descriptor}`,details:d.join(" \xb7 ")}}var h=i(1067);let b=h.G0([h.Rx(),h.Ry({value:h.Rx(),confidence:h.Rx().optional()})]),m=h.Ry({magnitude:b.optional(),valence:b.optional(),volatility:b.optional(),scaling_strategy:h.Z_().optional()}),v=h.Ry({label:h.Z_().min(1),angle:h.Rx().optional(),orb:h.Rx().optional(),retrograde_involved:h.O7().optional(),exact:h.O7().optional()}),g=h.Ry({climateLine:h.Z_().optional(),constitutionalClimate:h.Z_().optional(),hooks:h.IX(h.G0([h.Z_(),v])).optional(),seismograph:m.optional(),angles:h.IX(h.Yj()).optional(),transits:h.IX(h.Yj()).optional(),focusTheme:h.Z_().optional()}).strict().passthrough(),f="nodejs";async function x(e){try{let{sectionType:t,inputPayload:i}=await e.json();if(!t)return new Response(JSON.stringify({success:!1,error:"MISSING_SECTION_TYPE"}),{status:400,headers:{"Content-Type":"application/json"}});let o=function(e){let t;let{sectionType:i,payload:o}=e;try{t=g.parse(o)}catch(e){return{text:`[Poetic Brain validation error] ${e.message}`,section:i,generatedAt:new Date().toISOString()}}return{text:function(e,t){switch(e){case"MirrorVoice":return function(e){let t=c(e.hooks),i=d(e),o=[];return e.climateLine&&e.climateLine.trim().length>0?o.push(e.climateLine.trim()):o.push(`Climate: ${i.headline}.`),o.push(`Seismograph — ${i.details}.`),o.push(`Hook Stack — ${t.length?t.map(e=>{let t=[];return e.exact&&t.push("exact"),"number"==typeof e.orb&&t.push(`${e.orb.toFixed(1)}\xb0 orb`),e.retrograde_involved&&t.push("retrograde signature"),t.length?`${e.label} (${t.join(", ")})`:e.label}).join(" | "):"No high-charge hooks supplied."}`),o.push("Map, not mandate: treat this as symbolic weather. If it lands, log it; if not, discard and proceed."),o.join("\n")}(t);case"PolarityCardVoice":return function(e){let t=s(e.seismograph?.magnitude),i=s(e.seismograph?.valence),o=s(e.seismograph?.volatility),{band:r,label:a}=u(t),n=l(i),d=p(o),h=c(e.hooks),b="supportive"===n.tone?"Supportive":"restrictive"===n.tone?"Restrictive":"Mixed",m=d.label.includes("high")?"Scattered":d.label.includes("low")?"Focused":"Variable",v=`${b} \xb7 ${m}`,g=[];g.push(`⚡ ${a} (${r})`),void 0!==i&&g.push(`Valence ${i.toFixed(2)} (${n.descriptor})`),void 0!==o&&g.push(`Volatility ${o.toFixed(2)}`);let f=h[0]?.label?` \xb7 Anchor: ${h[0].label}`:"";return`${v}
${g.join(" \xb7 ")}${f}`}(t);default:let i=d(t);return`${e}
${i.details}`}}(i,t),section:i,generatedAt:new Date().toISOString()}}({sectionType:t,payload:i||{}});return new Response(JSON.stringify({success:!0,...o}),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return new Response(JSON.stringify({success:!1,error:e.message||"INTERNAL_ERROR"}),{status:500,headers:{"Content-Type":"application/json"}})}}let y=new r.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/poetic-brain/route",pathname:"/api/poetic-brain",filename:"route",bundlePath:"app/api/poetic-brain/route"},resolvedPagePath:"/Users/dancross/Documents/GitHub/WovenWebApp/app/api/poetic-brain/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:$,staticGenerationAsyncStorage:S,serverHooks:I}=y,R="/api/poetic-brain/route";function j(){return(0,n.patchFetch)({serverHooks:I,staticGenerationAsyncStorage:S})}},9303:(e,t,i)=>{e.exports=i(517)}};var t=require("../../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),o=t.X(0,[948,67],()=>i(120));module.exports=o})();