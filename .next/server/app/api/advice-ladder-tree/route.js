(()=>{var a={};a.id=100,a.ids=[100],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3421:(a,b,c)=>{"use strict";Object.defineProperty(b,"I",{enumerable:!0,get:function(){return g}});let d=c(71237),e=c(55088),f=c(17679);async function g(a,b,c,g){if((0,d.isNodeNextResponse)(b)){var h;b.statusCode=c.status,b.statusMessage=c.statusText;let d=["set-cookie","www-authenticate","proxy-authenticate","vary"];null==(h=c.headers)||h.forEach((a,c)=>{if("x-middleware-set-cookie"!==c.toLowerCase())if("set-cookie"===c.toLowerCase())for(let d of(0,f.splitCookiesString)(a))b.appendHeader(c,d);else{let e=void 0!==b.getHeader(c);(d.includes(c.toLowerCase())||!e)&&b.appendHeader(c,a)}});let{originalResponse:i}=b;c.body&&"HEAD"!==a.method?await (0,e.pipeToNodeResponse)(c.body,i,g):i.end()}}},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},32652:(a,b,c)=>{"use strict";let d=c(58450);class e{constructor(){this.rungs={mirror:new f,container:new g,choicePair:new h,ifThenTrack:new i,crisisContainer:new j}}async processHookStack(a,b,c="general"){try{if(d.info("Processing Hook Stack through Advice Ladder Tree",{hookStackCount:a.titles?.length||0,userNeed:c,sessionId:b.sessionId}),this.isCrisisSignal(c,a,b))return await this.rungs.crisisContainer.engage(a,b);let e=await this.buildProgression(a,b,c);return{success:!0,ladderTree:e,entryPoint:this.determineEntryPoint(c,b),pacing:this.calculatePacing(b),metadata:{hookStackIntegrated:a.titles?.length||0,therapeuticMode:c,progressionDepth:e.length,sessionContext:b.sessionId}}}catch(c){return d.error("Error in Advice Ladder Tree processing",{error:c.message,hookStack:a,sessionContext:b}),{success:!1,error:"Unable to process therapeutic integration",fallback:await this.generateFallbackSupport(a)}}}async buildProgression(a,b,c){let d=[],e=await this.rungs.mirror.reflect(a,b);for(let f of(d.push({rung:"mirror",content:e,purpose:"Recognition & Validation"}),this.determineRungSequence(c,b,e))){let c=await this.rungs[f].process(a,b,d);d.push({rung:f,content:c,purpose:this.getRungPurpose(f)})}return d}isCrisisSignal(a,b,c){return["crisis","emergency","urgent","overwhelmed","can't cope"].some(b=>a.includes(b))||b.volatilityIndex>8||c.driftIndex>.7||c.sstLogs?.some(a=>"OSR"===a.category&&a.clarification?.includes("overwhelming"))}determineEntryPoint(a,b){return a.includes("decision")||a.includes("choice")?"choicePair":a.includes("boundary")||a.includes("safety")?"container":a.includes("action")||a.includes("plan")?"ifThenTrack":"mirror"}calculatePacing(a){let b=a.sessionScores?.accuracy||.7,c=(b+(a.sessionScores?.edgeCapture||.5)+(a.sessionScores?.clarity||.8))/3;return c>.8?"normal":c>.6?"gentle":"extra-gentle"}determineRungSequence(a,b,c){let d=["container","choicePair","ifThenTrack"];return c.confidenceLevel<.6?d=["container"]:a.includes("action")||a.includes("decision")?d=["choicePair","ifThenTrack"]:b.driftIndex>.5&&(d=["container","choicePair"]),d}getRungPurpose(a){return({mirror:"Recognition & Validation",container:"Boundaries & Safety",choicePair:"Agency & Decision Support",ifThenTrack:"Implementation & Monitoring",crisisContainer:"Emergency Support & Stabilization"})[a]||"Integration Support"}async generateFallbackSupport(a){return{type:"fallback",message:"Your astrological climate shows active energy patterns.",suggestion:"Consider taking time to notice what resonates most strongly.",hookReference:a.titles?.[0]||"Current planetary configuration",resources:["Take three deep breaths","Notice what feels most present right now","Consider what support you might need"]}}}class f{async reflect(a,b){let c=a.titles?.[0],d=a.titles?.[1],e=[`The ${c?.title} pattern suggests you're navigating some complex energy right now.`,`Your chart shows ${c?.title} as a primary theme - this makes sense of what you might be experiencing.`,`The astrological climate reveals ${c?.title} energy, which often feels exactly like what you're describing.`];return{recognition:this.selectTemplate(e),validation:this.buildValidation(c,d),confidenceLevel:this.calculateMirrorConfidence(a,b),resonanceCheck:"Does this feel like it captures something true about your current experience?"}}buildValidation(a,b){if(!a)return"Your current astrological climate shows active patterns worth exploring.";let c=`The ${a.title} theme reflects real patterns in your current environment.`;return b&&(c+=` The interplay with ${b.title} adds another layer that might explain the complexity you're feeling.`),c}calculateMirrorConfidence(a,b){return((a.titles?.[0]?.intensity||.5)+(b.sessionScores?.accuracy||.7))/2}selectTemplate(a){return a[Math.floor(Math.random()*a.length)]}}class g{async process(a,b,c){c.find(a=>"mirror"===a.rung)?.content;let d=a.titles?.[0];return{boundaries:this.suggestBoundaries(d,b),safetyCheck:this.createSafetyCheck(a),resources:this.gatherResources(d),pacing:"You can move through this at whatever pace feels right for you."}}suggestBoundaries(a,b){if(!a)return"Consider what boundaries might support you right now.";let c={high_intensity:"With this much energy active, it might help to create some buffer space in your schedule.",interpersonal:"Notice if you need more space in relationships or more connection - both are valid.",internal:"Consider what internal boundaries might help you feel more centered.",default:"What boundaries would help you feel more supported right now?"};return c[this.classifyHookType(a)]||c.default}createSafetyCheck(a){let b=a.volatilityIndex||0;return b>7?"Given the high-energy patterns, check in: Do you feel grounded and safe right now?":b>4?"With moderate energy patterns active, notice what helps you feel most stable.":"Check in with yourself: What do you need to feel safe and supported?"}gatherResources(a){return["Take breaks when you need them","Notice what environments feel most supportive","Trust your instincts about what you need","Remember that boundaries are self-care, not selfishness"]}classifyHookType(a){if(!a||!a.title)return"default";let b=a.title.toLowerCase();return b.includes("relationship")||b.includes("other")||b.includes("partnership")?"interpersonal":a.intensity>.8?"high_intensity":b.includes("inner")||b.includes("self")||b.includes("identity")?"internal":"default"}}class h{async process(a,b,c){let d=a.titles?.[0];return{choicePair:this.generateChoicePair(d,b),agencyReminder:"You have agency in how you respond to these patterns.",decisionSupport:this.offerDecisionSupport(d),noWrongChoice:"There's no wrong choice here - trust what feels most aligned for you."}}generateChoicePair(a,b){return a?(a.intensity||.5)>.7?{optionA:"Channel this energy into creative or productive outlets",optionB:"Create space to process and integrate this energy slowly",context:`The ${a.title} pattern offers strong energy that can be worked with in different ways.`}:{optionA:"Explore what this pattern is inviting you to notice",optionB:"Take time to simply be present with what's emerging",context:`The ${a.title} theme suggests subtle shifts that can be approached gently.`}:{optionA:"Focus on grounding and stability",optionB:"Focus on gentle forward movement",context:"Both approaches can be valuable depending on what you need most."}}offerDecisionSupport(a){return["Notice which option feels more energizing or calming","Consider what you have capacity for right now","Trust your body's wisdom about what feels right","Remember you can adjust your approach as you go"]}}class i{async process(a,b,c){let d=c.find(a=>"choicePair"===a.rung)?.content,e=a.titles?.[0];return{implementation:this.createImplementationPlan(e,d),tracking:this.suggestTracking(e),adjustment:this.buildAdjustmentFramework(),gentleAccountability:"Check in with yourself in a few days to see how this feels."}}createImplementationPlan(a,b){return{ifCondition:this.buildIfCondition(a),thenAction:this.buildThenAction(a),elseOption:this.buildElseOption(a)}}buildIfCondition(a){return a?(a.intensity||.5)>.7?`If you feel the ${a.title} energy building`:`If you notice the ${a.title} pattern emerging`:"If you notice you need support"}buildThenAction(a){if(!a)return"then pause and choose your response consciously";let b=["then take three conscious breaths and choose your response","then pause to ask what you need in this moment","then remember you have choices in how to engage"];return b[Math.floor(Math.random()*b.length)]}buildElseOption(a){return"Otherwise, trust that you're navigating this well and adjust as needed."}suggestTracking(a){return{question:"What would be helpful to notice?",suggestions:["How does your energy feel?","What patterns are you noticing?","What's working well?","What might need adjustment?"],frequency:"Check in with yourself when it feels natural to do so."}}buildAdjustmentFramework(){return{permission:"You can adjust this approach at any time.",signals:"If something doesn't feel right, trust that and modify.",flexibility:"What works today might be different tomorrow, and that's completely normal."}}}class j{async engage(a,b){d.info("Crisis Container engaged",{sessionId:b.sessionId});let c=this.assessCrisisPacing(b);return{type:"crisis-support",immediate:this.immediateStabilization(c),grounding:this.groundingProtocol(c),boundaries:this.crisisBoundaries(),followUp:this.crisisFollowUp(),balanceMeter:this.balanceMeterGuidance(c),resources:this.crisisResources()}}assessCrisisPacing(a){let b=a.volatilityIndex||0,c=a.driftIndex||0;return b>8||c>.8?"extra-slow":b>6||c>.6?"slow":"gentle"}immediateStabilization(a){let b={"extra-slow":{step1:"Right now, just focus on breathing.",step2:"Feel your feet on the ground.",step3:"You are safe in this moment."},slow:{step1:"Take a deep breath and feel your body.",step2:"Notice that you are physically safe right now.",step3:"You don't have to solve everything at once."},gentle:{step1:"Pause and breathe consciously.",step2:"Ground yourself in the present moment.",step3:"Remember that this intensity will shift."}};return b[a]||b.gentle}groundingProtocol(a){return{breathing:"Breathe in for 4, hold for 4, out for 6",sensing:"Notice 5 things you can see, 4 you can touch, 3 you can hear",affirmation:"I am safe right now. I can handle this one moment at a time.",pacing:`Taking this at ${a} pace is exactly right.`}}crisisBoundaries(){return{permission:"It's okay to not be okay right now.",limits:"You don't owe anyone explanations about what you need.",protection:"Your primary job is to take care of yourself.",timeline:"You don't have to figure everything out today."}}crisisFollowUp(){return{checkIn:"Check in with yourself in 2-4 hours.",professional:"If this continues to feel overwhelming, consider reaching out to a counselor or therapist.",support:"Consider who in your life you could reach out to for support.",selfCompassion:"Be as kind to yourself as you would be to a good friend going through this."}}balanceMeterGuidance(a){return{currentSetting:a,adjustment:"You can slow down even more if you need to.",calibration:"Trust your body about what pace feels sustainable.",permission:"There's no rush. Healing happens at its own pace."}}crisisResources(){return["Crisis Text Line: Text HOME to 741741","National Suicide Prevention Lifeline: 988","Remember: This is temporary, even when it doesn't feel like it","Your feelings are valid and you deserve support"]}}a.exports={AdviceLadderTree:e}},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},48934:(a,b,c)=>{"use strict";c.r(b),c.d(b,{handler:()=>D,patchFetch:()=>C,routeModule:()=>y,serverHooks:()=>B,workAsyncStorage:()=>z,workUnitAsyncStorage:()=>A});var d={};c.r(d),c.d(d,{POST:()=>x});var e=c(95736),f=c(9117),g=c(4044),h=c(39326),i=c(32324),j=c(77533),k=c(32822),l=c(261),m=c(54290),n=c(85328),o=c(38928),p=c(46595),q=c(3421),r=c(17679),s=c(41681),t=c(63446),u=c(86439),v=c(51356),w=c(32652);async function x(a){try{let{hookStack:b,sessionContext:c,userNeed:d}=await a.json();if(!b||!c)return Response.json({success:!1,error:"Missing required data for Advice Ladder Tree processing"},{status:400});let e=new w.AdviceLadderTree,f=await e.processHookStack(b,c,d);return Response.json(f)}catch(a){return console.error("Error in Advice Ladder Tree API:",a),Response.json({success:!1,error:"Internal server error processing therapeutic integration",details:a instanceof Error?a.message:"Unknown error"},{status:500})}}let y=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/advice-ladder-tree/route",pathname:"/api/advice-ladder-tree",filename:"route",bundlePath:"app/api/advice-ladder-tree/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"/Users/dancross/Documents/GitHub/WovenWebApp/app/api/advice-ladder-tree/route.ts",nextConfigOutput:"",userland:d}),{workAsyncStorage:z,workUnitAsyncStorage:A,serverHooks:B}=y;function C(){return(0,g.patchFetch)({workAsyncStorage:z,workUnitAsyncStorage:A})}async function D(a,b,c){var d;let e="/api/advice-ladder-tree/route";"/index"===e&&(e="/");let g=await y.prepare(a,b,{srcPage:e,multiZoneDraftMode:!1});if(!g)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:w,params:x,nextConfig:z,isDraftMode:A,prerenderManifest:B,routerServerContext:C,isOnDemandRevalidate:D,revalidateOnlyGenerated:E,resolvedPathname:F,clientReferenceManifest:G,serverActionsManifest:H}=g,I=(0,l.normalizeAppPath)(e),J=!!(B.dynamicRoutes[I]||B.routes[F]);if(J&&!A){let a=!!B.routes[F],b=B.dynamicRoutes[I];if(b&&!1===b.fallback&&!a)throw new u.NoFallbackError}let K=null;!J||y.isDev||A||(K="/index"===(K=F)?"/":K);let L=!0===y.isDev||!J,M=J&&!L;H&&G&&(0,j.setReferenceManifestsSingleton)({page:e,clientReferenceManifest:G,serverActionsManifest:H,serverModuleMap:(0,k.createServerModuleMap)({serverActionsManifest:H})});let N=a.method||"GET",O=(0,i.getTracer)(),P=O.getActiveScopeSpan(),Q={params:x,prerenderManifest:B,renderOpts:{experimental:{cacheComponents:!!z.experimental.cacheComponents,authInterrupts:!!z.experimental.authInterrupts},supportsDynamicResponse:L,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=z.experimental)?void 0:d.cacheLife,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>y.onRequestError(a,b,d,C)},sharedContext:{buildId:w}},R=new m.NodeNextRequest(a),S=new m.NodeNextResponse(b),T=n.NextRequestAdapter.fromNodeNextRequest(R,(0,n.signalFromNodeResponse)(b));try{let d=async a=>y.handle(T,Q).finally(()=>{if(!a)return;a.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let c=O.getRootSpanAttributes();if(!c)return;if(c.get("next.span_type")!==o.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${c.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let d=c.get("next.route");if(d){let b=`${N} ${d}`;a.setAttributes({"next.route":d,"http.route":d,"next.span_name":b}),a.updateName(b)}else a.updateName(`${N} ${e}`)}),g=async g=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!(0,h.getRequestMeta)(a,"minimalMode")&&D&&E&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(g);a.fetchMetrics=Q.renderOpts.fetchMetrics;let i=Q.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=Q.renderOpts.collectedTags;if(!J)return await (0,q.I)(R,S,e,Q.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,r.toNodeOutgoingHttpHeaders)(e.headers);j&&(b[t.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==Q.renderOpts.collectedRevalidate&&!(Q.renderOpts.collectedRevalidate>=t.INFINITE_CACHE)&&Q.renderOpts.collectedRevalidate,d=void 0===Q.renderOpts.collectedExpire||Q.renderOpts.collectedExpire>=t.INFINITE_CACHE?void 0:Q.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==f?void 0:f.isStale)&&await y.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,p.c)({isStaticGeneration:M,isOnDemandRevalidate:D})},C),b}},l=await y.handleResponse({req:a,nextConfig:z,cacheKey:K,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:B,isRoutePPREnabled:!1,isOnDemandRevalidate:D,revalidateOnlyGenerated:E,responseGenerator:k,waitUntil:c.waitUntil});if(!J)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,h.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",D?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),A&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,r.fromNodeOutgoingHttpHeaders)(l.value.headers);return(0,h.getRequestMeta)(a,"minimalMode")&&J||m.delete(t.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,s.getCacheControlHeader)(l.cacheControl)),await (0,q.I)(R,S,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};P?await g(P):await O.withPropagatedContext(a.headers,()=>O.trace(o.BaseServerSpan.handleRequest,{spanName:`${N} ${e}`,kind:i.SpanKind.SERVER,attributes:{"http.method":N,"http.target":a.url}},g))}catch(b){if(b instanceof u.NoFallbackError||await y.onRequestError(a,b,{routerKind:"App Router",routePath:I,routeType:"route",revalidateReason:(0,p.c)({isStaticGeneration:M,isOnDemandRevalidate:D})}),J)throw b;return await (0,q.I)(R,S,new Response(null,{status:500})),null}}},58450:a=>{"use strict";let b=process.env.LOG_LEVEL||"info",c={error:0,warn:1,info:2,debug:3};function d(a){return c[a]<=c[b]}function e(a,b,c={}){let d=new Date().toISOString(),f=Object.keys(c).length>0?JSON.stringify(c):"";return`[${d}] ${a.toUpperCase()}: ${b} ${f}`}a.exports={error:(a,b={})=>{d("error")&&console.error(e("error",a,b))},warn:(a,b={})=>{d("warn")&&console.warn(e("warn",a,b))},info:(a,b={})=>{d("info")&&console.log(e("info",a,b))},debug:(a,b={})=>{d("debug")&&console.log(e("debug",a,b))}}},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},95736:(a,b,c)=>{"use strict";a.exports=c(44870)},96487:()=>{}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[828],()=>b(b.s=48934));module.exports=c})();