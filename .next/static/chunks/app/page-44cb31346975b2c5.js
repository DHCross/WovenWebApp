(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6861:function(e,t,n){Promise.resolve().then(n.bind(n,1260))},1260:function(e,t,n){"use strict";n.d(t,{default:function(){return o}});var a=n(7437),i=n(2265);function o(){let[e,t]=(0,i.useState)(!1),[n,o]=(0,i.useState)(!1),[l,r]=(0,i.useState)(null),[s,c]=(0,i.useState)(null),d=(0,i.useRef)(null);(0,i.useEffect)(()=>{let e=!1;return async function(){try{var n,a;let i;"function"==typeof(null===(n=window.auth0)||void 0===n?void 0:n.createAuth0Client)||"function"==typeof window.createAuth0Client||await new Promise((e,t)=>{let n=document.createElement("script");n.src="/vendor/auth0-spa-js.production.js",n.async=!0,n.onload=()=>e(),n.onerror=()=>t(Error("Failed to load Auth0 SDK")),document.head.appendChild(n)});try{let e=await fetch("/api/auth-config",{cache:"no-store"});if(!e.ok)throw Error("Auth config failed: ".concat(e.status," ").concat(e.statusText));i=await e.json(),console.log("Auth config received:",i)}catch(n){console.warn("Could not fetch auth config, using development fallback:",n),e||(r("Auth not available (functions not running)"),t(!0));return}if(!(null==i?void 0:i.domain)||!(null==i?void 0:i.clientId))throw Error("Invalid Auth0 config - missing domain or clientId");let l=(null===(a=window.auth0)||void 0===a?void 0:a.createAuth0Client)||window.createAuth0Client;if("function"!=typeof l)throw Error("Auth0 SDK not available after load");let s=await l({domain:String(i.domain).replace(/^https?:\/\//,""),clientId:i.clientId,authorizationParams:{redirect_uri:window.location.origin+"/"}});d.current=s;let u=window.location.search;if(u.includes("code=")&&u.includes("state=")){await s.handleRedirectCallback();let e=new URL(window.location.href);e.search="",window.history.replaceState({},"",e.toString())}let h=await s.isAuthenticated(),f=null;if(h)try{let e=await s.getUser();f=(null==e?void 0:e.name)||(null==e?void 0:e.email)||null}catch(e){}e||(c(f),o(h),t(!0))}catch(n){e||(r((null==n?void 0:n.message)||"Auth init failed"),t(!0))}}(),()=>{e=!0}},[]);let u=async()=>{try{var e;await (null===(e=d.current)||void 0===e?void 0:e.loginWithRedirect({authorizationParams:{redirect_uri:window.location.origin+"/",connection:"google-oauth2"}}))}catch(e){r((null==e?void 0:e.message)||"Login failed")}};return(0,a.jsx)("section",{className:"mt-8",children:(0,a.jsxs)("div",{className:"rounded-xl border border-slate-800 bg-slate-900/40 p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold tracking-tight",children:"Start with Math Brain"}),(0,a.jsx)("p",{className:"mt-2 text-slate-400",children:"Run the geometry first. Then, once you’re signed in, jump into Chat to synthesize the narrative."}),(0,a.jsxs)("div",{className:"mt-6 flex flex-wrap gap-3",children:[(0,a.jsx)("a",{href:"/math-brain",target:"_blank",rel:"noopener noreferrer",className:"rounded-md bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-500",children:"Open Math Brain"}),!e&&(0,a.jsx)("button",{disabled:!0,className:"rounded-md bg-slate-800 px-4 py-2 text-slate-400",children:"Loading auth…"}),e&&!n&&(0,a.jsx)("button",{onClick:u,className:"rounded-md border border-slate-700 bg-slate-800 px-4 py-2 text-slate-100 hover:bg-slate-700",children:"Continue with Google"}),e&&(n?(0,a.jsx)("a",{href:"/chat",className:"rounded-md px-4 py-2 bg-emerald-600 text-white hover:bg-emerald-500",title:"Open Poetic Brain (Chat)",children:"Open Poetic Brain"}):(0,a.jsx)("span",{role:"link","aria-disabled":"true",tabIndex:-1,className:"rounded-md px-4 py-2 cursor-not-allowed bg-slate-800 text-slate-500",title:"Sign in to enable Poetic Brain",children:"Open Poetic Brain"}))]}),n&&(0,a.jsxs)("p",{className:"mt-3 text-xs text-slate-500",children:["Signed in",s?" as ".concat(s):"",". Chat is now enabled."]}),l&&(0,a.jsx)("p",{className:"mt-3 text-xs text-rose-400",children:l})]})})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=6861)}),_N_E=e.O()}]);