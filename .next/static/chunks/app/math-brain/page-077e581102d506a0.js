(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[780],{2037:function(e,t,a){Promise.resolve().then(a.bind(a,6187))},6187:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return i},dynamic:function(){return s}});var l=a(7437),r=a(2265);let s="force-dynamic";function n(e){let{title:t,children:a}=e;return(0,l.jsxs)("section",{className:"rounded-lg border border-slate-700 bg-slate-800/60 p-4",children:[(0,l.jsx)("h2",{className:"text-lg font-medium text-slate-100",children:t}),(0,l.jsx)("div",{className:"mt-3",children:a})]})}function i(){var e,t;let a=(0,r.useMemo)(()=>new Date,[]),s=e=>e.toISOString().slice(0,10),i=s(a),d=s(new Date(a.getTime()+5184e5)),[o,c]=(0,r.useState)({name:"Subject A",year:1990,month:1,day:1,hour:12,minute:0,city:"New York",nation:"US",latitude:40.7128,longitude:-74.006,timezone:"GMT",zodiac_type:"Tropic"}),[m,u]=(0,r.useState)(i),[x,h]=(0,r.useState)(d),[p,b]=(0,r.useState)("NATAL_TRANSITS"),[g,y]=(0,r.useState)("daily"),[v,j]=(0,r.useState)(!1),[N,f]=(0,r.useState)(null),[w,S]=(0,r.useState)(null),[C,k]=(0,r.useState)(!1),[_,T]=(0,r.useState)(!1),A=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=!1;return async function(){try{var t,a;"function"==typeof(null===(t=window.auth0)||void 0===t?void 0:t.createAuth0Client)||"function"==typeof window.createAuth0Client||await new Promise((e,t)=>{let a=document.createElement("script");a.src="/vendor/auth0-spa-js.production.js",a.async=!0,a.onload=()=>e(),a.onerror=()=>t(Error("Failed to load Auth0 SDK")),document.head.appendChild(a)});let l=null;try{let e=await fetch("/api/auth-config",{cache:"no-store"});if(!e.ok)throw Error("Auth config failed: ".concat(e.status));l=await e.json()}catch(t){e||k(!0);return}let r=(null===(a=window.auth0)||void 0===a?void 0:a.createAuth0Client)||window.createAuth0Client;if("function"!=typeof r)throw Error("Auth0 SDK not available");let s=await r({domain:String(l.domain).replace(/^https?:\/\//,""),clientId:l.clientId,authorizationParams:{redirect_uri:window.location.origin+"/math-brain"}});A.current=s;let n=window.location.search;if(n.includes("code=")&&n.includes("state=")){await s.handleRedirectCallback();let e=new URL(window.location.href);e.search="",window.history.replaceState({},"",e.toString())}let i=await s.isAuthenticated();e||(T(i),k(!0))}catch(t){e||k(!0)}}(),()=>{e=!0}},[]);let F=async()=>{try{var e;await (null===(e=A.current)||void 0===e?void 0:e.loginWithRedirect({authorizationParams:{redirect_uri:window.location.origin+"/math-brain",connection:"google-oauth2"}}))}catch(e){f((null==e?void 0:e.message)||"Login failed")}},z=(0,r.useMemo)(()=>{let e=[o.name,o.city,o.nation,o.timezone,o.zodiac_type],t=[Number(o.year),Number(o.month),Number(o.day),Number(o.hour),Number(o.minute),Number(o.latitude),Number(o.longitude)];return e.every(Boolean)&&t.every(e=>!Number.isNaN(e))&&!!m&&!!x},[o,m,x]);async function q(e){if(e.preventDefault(),z){j(!0),f(null),S(null);try{let e={mode:p,personA:{...o,year:Number(o.year),month:Number(o.month),day:Number(o.day),hour:Number(o.hour),minute:Number(o.minute),latitude:Number(o.latitude),longitude:Number(o.longitude)},transitStartDate:m,transitEndDate:x,transitStep:g},t=await fetch("/api/astrology-mathbrain",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await t.json();if(!t.ok||(null==a?void 0:a.success)===!1){let e=(null==a?void 0:a.error)||"Request failed (".concat(t.status,")");throw Error(e)}S(a)}catch(e){f((null==e?void 0:e.message)||"Unexpected error")}finally{j(!1)}}}return(0,l.jsxs)("main",{className:"mx-auto max-w-4xl px-6 py-10",children:[(0,l.jsxs)("header",{className:"text-center",children:[(0,l.jsx)("h1",{className:"text-3xl font-semibold tracking-tight",children:"Math Brain"}),(0,l.jsx)("p",{className:"mt-3 text-slate-400",children:"Geometry first. Generate your chart math here, then head to Poetic Brain."})]}),(0,l.jsxs)("div",{className:"mt-6 flex flex-wrap gap-3 justify-center",children:[(0,l.jsx)("a",{href:"/",className:"rounded-md border border-slate-700 bg-slate-800 px-4 py-2 text-slate-100 hover:bg-slate-700",children:"Back Home"}),(0,l.jsx)("a",{href:"/index.html",className:"rounded-md bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-500",target:"_blank",rel:"noopener noreferrer",children:"Open Legacy Math Brain"}),C&&_?(0,l.jsx)("a",{href:"/chat",className:"rounded-md bg-emerald-600 px-4 py-2 text-white hover:bg-emerald-500",children:"Continue to Poetic Brain"}):(0,l.jsx)("button",{type:"button",onClick:F,className:"rounded-md border border-slate-700 bg-slate-800 px-4 py-2 text-slate-100 hover:bg-slate-700",title:"Sign in to enable Poetic Brain",children:"Sign in to Continue"})]}),(0,l.jsxs)("form",{onSubmit:q,className:"mt-10 grid grid-cols-1 gap-6",children:[(0,l.jsx)(n,{title:"Person A (required)",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"a-name",className:"block text-sm text-slate-300",children:"Name"}),(0,l.jsx)("input",{id:"a-name",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500",value:o.name,onChange:e=>c({...o,name:e.target.value}),required:!0})]}),(0,l.jsxs)("div",{className:"grid grid-cols-5 gap-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"a-year",className:"block text-xs text-slate-300",children:"Year"}),(0,l.jsx)("input",{id:"a-year",type:"number",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-2 py-2 text-slate-100",value:o.year,onChange:e=>c({...o,year:e.target.value}),required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"a-month",className:"block text-xs text-slate-300",children:"Month"}),(0,l.jsx)("input",{id:"a-month",type:"number",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-2 py-2 text-slate-100",value:o.month,onChange:e=>c({...o,month:e.target.value}),min:1,max:12,required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"a-day",className:"block text-xs text-slate-300",children:"Day"}),(0,l.jsx)("input",{id:"a-day",type:"number",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-2 py-2 text-slate-100",value:o.day,onChange:e=>c({...o,day:e.target.value}),min:1,max:31,required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"a-hour",className:"block text-xs text-slate-300",children:"Hour"}),(0,l.jsx)("input",{id:"a-hour",type:"number",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-2 py-2 text-slate-100",value:o.hour,onChange:e=>c({...o,hour:e.target.value}),min:0,max:23,required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"a-minute",className:"block text-xs text-slate-300",children:"Minute"}),(0,l.jsx)("input",{id:"a-minute",type:"number",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-2 py-2 text-slate-100",value:o.minute,onChange:e=>c({...o,minute:e.target.value}),min:0,max:59,required:!0})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"a-city",className:"block text-sm text-slate-300",children:"City"}),(0,l.jsx)("input",{id:"a-city",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100",value:o.city,onChange:e=>c({...o,city:e.target.value}),required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"a-nation",className:"block text-sm text-slate-300",children:"Nation"}),(0,l.jsx)("input",{id:"a-nation",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100",value:o.nation,onChange:e=>c({...o,nation:e.target.value}),required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"a-lat",className:"block text-sm text-slate-300",children:"Latitude"}),(0,l.jsx)("input",{id:"a-lat",type:"number",step:"any",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100",value:o.latitude,onChange:e=>c({...o,latitude:e.target.value}),required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"a-lon",className:"block text-sm text-slate-300",children:"Longitude"}),(0,l.jsx)("input",{id:"a-lon",type:"number",step:"any",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100",value:o.longitude,onChange:e=>c({...o,longitude:e.target.value}),required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"a-tz",className:"block text-sm text-slate-300",children:"Timezone"}),(0,l.jsx)("input",{id:"a-tz",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100",value:o.timezone,onChange:e=>c({...o,timezone:e.target.value}),placeholder:"e.g., GMT or UTC",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"a-zodiac",className:"block text-sm text-slate-300",children:"Zodiac Type"}),(0,l.jsxs)("select",{id:"a-zodiac",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100",value:o.zodiac_type,onChange:e=>c({...o,zodiac_type:e.target.value}),children:[(0,l.jsx)("option",{value:"Tropic",children:"Tropic"}),(0,l.jsx)("option",{value:"Sidereal",children:"Sidereal"})]})]})]})}),(0,l.jsxs)(n,{title:"Transits",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"t-start",className:"block text-sm text-slate-300",children:"Start Date"}),(0,l.jsx)("input",{id:"t-start",type:"date",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100",value:m,onChange:e=>u(e.target.value)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"t-end",className:"block text-sm text-slate-300",children:"End Date"}),(0,l.jsx)("input",{id:"t-end",type:"date",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100",value:x,onChange:e=>h(e.target.value)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"t-step",className:"block text-sm text-slate-300",children:"Step"}),(0,l.jsxs)("select",{id:"t-step",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100",value:g,onChange:e=>y(e.target.value),children:[(0,l.jsx)("option",{value:"daily",children:"Daily"}),(0,l.jsx)("option",{value:"weekly",children:"Weekly"}),(0,l.jsx)("option",{value:"monthly",children:"Monthly"})]})]})]}),(0,l.jsx)("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"t-mode",className:"block text-sm text-slate-300",children:"Mode"}),(0,l.jsxs)("select",{id:"t-mode",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100",value:p,onChange:e=>b(e.target.value),children:[(0,l.jsx)("option",{value:"NATAL_ONLY",children:"Natal only"}),(0,l.jsx)("option",{value:"NATAL_TRANSITS",children:"Natal + Transits"})]})]})})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"All processing is geometry-first and non-deterministic. Your data isn’t stored."}),(0,l.jsx)("button",{type:"submit",disabled:!z||v,className:"inline-flex items-center rounded-md bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-500 disabled:opacity-50",children:v?"Computing…":"Generate Report"})]})]}),N&&(0,l.jsxs)("div",{className:"mt-6 rounded-md border border-red-700 bg-red-900/30 p-4 text-red-200",children:[(0,l.jsx)("p",{className:"font-medium",children:"Error"}),(0,l.jsx)("p",{className:"mt-1 text-sm",children:N})]}),w&&(0,l.jsxs)("div",{className:"mt-8 grid grid-cols-1 gap-6",children:[(null==w?void 0:null===(t=w.person_a)||void 0===t?void 0:null===(e=t.derived)||void 0===e?void 0:e.seismograph_summary)&&(0,l.jsx)(n,{title:"Seismograph Summary",children:(0,l.jsx)("div",{className:"text-sm text-slate-300",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-400",children:"Magnitude"}),(0,l.jsx)("p",{className:"text-slate-100",children:w.person_a.derived.seismograph_summary.magnitude})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-400",children:"Valence"}),(0,l.jsx)("p",{className:"text-slate-100",children:w.person_a.derived.seismograph_summary.valence})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-400",children:"Volatility"}),(0,l.jsx)("p",{className:"text-slate-100",children:w.person_a.derived.seismograph_summary.volatility})]})]})})}),(0,l.jsx)(n,{title:"Raw Result (debug)",children:(0,l.jsx)("pre",{className:"max-h-[28rem] overflow-auto rounded-md bg-slate-950 p-4 text-xs text-slate-200",children:JSON.stringify(w,null,2)})}),(0,l.jsx)("div",{className:"flex items-center justify-end",children:(0,l.jsx)("button",{type:"button",onClick:function(){if(w)try{let e={timestamp:Date.now(),meta:{person:{name:o.name,birthDate:"".concat(o.year,"-").concat(String(o.month).padStart(2,"0"),"-").concat(String(o.day).padStart(2,"0")),birthTime:"".concat(String(o.hour).padStart(2,"0"),":").concat(String(o.minute).padStart(2,"0")),birthLocation:"".concat(o.city,", ").concat(o.nation)},context:"Mode: ".concat(p,"; Transits: ").concat(m," → ").concat(x," (").concat(g,")")},reportData:w};sessionStorage.setItem("woven_report_for_raven",JSON.stringify(e)),window.location.href="/chat"}catch(e){}},className:"inline-flex items-center rounded-md bg-emerald-600 px-4 py-2 text-white hover:bg-emerald-500",children:"Send to Poetic Brain →"})})]}),(0,l.jsxs)("p",{className:"mt-8 text-center text-xs text-slate-500",children:["Poetic Brain at ",(0,l.jsx)("span",{className:"font-medium text-slate-300",children:"/chat"})," is gated by Auth0 and requires login."]})]})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=2037)}),_N_E=e.O()}]);