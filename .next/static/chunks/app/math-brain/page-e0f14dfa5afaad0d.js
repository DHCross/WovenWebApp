(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[780],{2037:function(e,t,l){Promise.resolve().then(l.bind(l,6674))},6674:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return h},dynamic:function(){return m}});var s=l(7437),a=l(2265);function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return null;let l=e.trim(),s=l.match(/^\s*(-?\d+(?:\.\d+)?)\s*[,\s]+\s*(-?\d+(?:\.\d+)?)\s*$/);if(s){let e=Number(s[1]),l=Number(s[2]);return!Number.isFinite(e)||!Number.isFinite(l)||Math.abs(e)>90||Math.abs(l)>180||t.rejectZeroZero&&0===e&&0===l?null:{lat:e,lon:l}}let a=l.replace(/[°º]/g,"\xb0").replace(/'/g,"′").replace(/"/g,"″").replace(/\s+/g," ").trim(),i=a.split(",").map(e=>e.trim()).filter(Boolean);if(2!==i.length){let e=a.split(" "),t=e.findIndex(e=>/[NS]$/i.test(e));if(t>-1&&t<e.length-1&&(i=[e.slice(0,t+1).join(" "),e.slice(t+1).join(" ")]),2!==i.length)return null}let r=n(i[0],["N","S"]),o=n(i[1],["E","W"]);return null==r||null==o||Math.abs(r)>90||Math.abs(o)>180||t.rejectZeroZero&&0===r&&0===o?null:{lat:r,lon:o}}function n(e,t){let l=e.toUpperCase().replace(/[°º]/g,"\xb0").replace(/'/g,"′").replace(/"/g,"″").replace(/[^0-9NSEW°′″\s\.\-]/g," ").replace(/\s+/g," ").trim(),s=l.match(/([NSEW])$/),a=s?s[1]:void 0,i=l.replace(/[NSEW]$/,"").trim().split(/[°′″\s]+/).filter(Boolean).map(Number);if(!i.length)return null;let n=i[0],r=i[1]||0,o=i[2]||0;if([n,r,o].some(e=>Number.isNaN(e))||r<0||r>=60||o<0||o>=60)return null;let d=Math.abs(n)+Math.abs(r)/60+Math.abs(o)/3600;return a?("S"===a||"W"===a)&&(d=-d):n<0&&(d=-d),d}function r(e,t){return Number.isFinite(e)&&Number.isFinite(t)?"".concat(e.toFixed(6),", ").concat(t.toFixed(6)):""}var o=l(5216);function d(e){let{onStateChange:t}=e,l=(0,a.useRef)(null),[s,i]=(0,a.useState)({authReady:!1,authed:!1,authEnvOk:!0,authStatus:null}),n=(0,a.useCallback)(async()=>{try{var e;if(!l.current){console.error("Auth client not ready.");return}await (null===(e=l.current)||void 0===e?void 0:e.loginWithRedirect({authorizationParams:{redirect_uri:(0,o.g)(),connection:"google-oauth2"}}))}catch(e){console.error("Login failed",e)}},[]);(0,a.useEffect)(()=>{let e=!1;return async function(){try{var t,s;"function"==typeof(null===(t=window.auth0)||void 0===t?void 0:t.createAuth0Client)||"function"==typeof window.createAuth0Client||await new Promise((e,t)=>{let l=document.createElement("script");l.src="/vendor/auth0-spa-js.production.js",l.async=!0,l.onload=()=>e(),l.onerror=()=>t(Error("Failed to load Auth0 SDK")),document.head.appendChild(l)});let a=null;try{let t=await fetch("/api/auth-config",{cache:"no-store"});if(!t.ok)throw Error("Auth config failed: ".concat(t.status));if(!(null==(a=await t.json())?void 0:a.domain)||!(null==a?void 0:a.clientId)){e||i(e=>({...e,authEnvOk:!1,authReady:!0}));return}e||i(e=>({...e,authStatus:{domain:String(a.domain),clientId:String(a.clientId)},authEnvOk:!0}))}catch(t){e||i(e=>({...e,authEnvOk:!1,authReady:!0}));return}let n=(null===(s=window.auth0)||void 0===s?void 0:s.createAuth0Client)||window.createAuth0Client;if("function"!=typeof n)throw Error("Auth0 SDK not available");let r=await n({domain:String(a.domain).replace(/^https?:\/\//,""),clientId:a.clientId,authorizationParams:{redirect_uri:(0,o.g)()}});l.current=r;let d=window.location.search;if(d.includes("code=")&&d.includes("state=")){try{await r.handleRedirectCallback()}catch(e){console.warn("Auth0 handleRedirectCallback error (continuing):",(null==e?void 0:e.message)||e)}finally{let e=new URL(window.location.href);e.search="",window.history.replaceState({},"",e.toString())}if(await r.isAuthenticated()){window.location.replace("/chat?from=math-brain");return}}let c=await r.isAuthenticated();e||i(e=>({...e,authed:c,authReady:!0}))}catch(t){e||i(e=>({...e,authReady:!0,authEnvOk:!1}))}}(),()=>{e=!0}},[]);let r=(0,a.useCallback)(()=>({...s,login:n}),[s,n]);return(0,a.useEffect)(()=>{t(r())},[r,t]),null}var c=l(816),u=l(357);let m="force-dynamic";function x(e){let{title:t,children:l,className:a=""}=e;return(0,s.jsxs)("section",{className:"rounded-lg border border-slate-700 bg-slate-800/60 p-4 ".concat(a),children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-slate-100",children:t}),(0,s.jsx)("div",{className:"mt-3",children:l})]})}function h(){var e,t,n,o,m,h,p,b,g,v,N,f,y,j,S,w,_,A,T,k,C,M;let R="true"===u.env.NEXT_PUBLIC_ENABLE_LEGACY_LINK,P=(0,a.useMemo)(()=>new Date,[]),B=e=>e.toISOString().slice(0,10),F=B(P),O=B(new Date(P.getTime()+5184e5)),[D,L]=(0,a.useState)({name:"Dan",year:1973,month:7,day:24,hour:14,minute:30,city:"Bryn Mawr",state:"PA",latitude:40.0167,longitude:-75.3,timezone:"America/New_York",zodiac_type:"Tropic"}),[E,I]=(0,a.useState)("40\xb01'N, 75\xb018'W"),[z,Y]=(0,a.useState)(null),[U,H]=(0,a.useState)(!0),[J,W]=(0,a.useState)(F),[q,Z]=(0,a.useState)(O),[V,G]=(0,a.useState)("NATAL_ONLY"),[$,K]=(0,a.useState)("daily"),[X,Q]=(0,a.useState)(!1),[ee,et]=(0,a.useState)(null),[el,es]=(0,a.useState)(null),[ea,ei]=(0,a.useState)(!1),[en,er]=(0,a.useState)({name:"",year:"",month:"",day:"",hour:"",minute:"",city:"",state:"",latitude:"",longitude:"",timezone:"",zodiac_type:"Tropic"}),[eo,ed]=(0,a.useState)(""),[ec,eu]=(0,a.useState)(null),[em,ex]=(0,a.useState)(!0),[eh,ep]=(0,a.useState)("PARTNER"),[eb,eg]=(0,a.useState)(""),[ev,eN]=(0,a.useState)(""),[ef,ey]=(0,a.useState)(!1),[ej,eS]=(0,a.useState)(""),ew=(0,a.useMemo)(()=>(0,c.jA)(D),[D]),[e_,eA]=(0,a.useState)(()=>(0,c.jA)(D)?"planetary_only":"user_provided"),eT=(0,a.useMemo)(()=>(0,c.jA)(en),[en]),ek=(0,a.useMemo)(()=>ew&&"user_provided"!==e_,[ew,e_]);(0,a.useMemo)(()=>eT&&"user_provided"!==e_,[eT,e_]),(0,a.useEffect)(()=>{ew||"user_provided"===e_?ew&&"user_provided"===e_&&eA("planetary_only"):eA("user_provided")},[ew]);let eC=(0,a.useMemo)(()=>["GMT","UTC","US/Eastern","US/Central","US/Mountain","US/Pacific","US/Alaska","US/Hawaii","America/New_York","America/Chicago","America/Denver","America/Los_Angeles","America/Phoenix","America/Anchorage"],[]);(0,a.useMemo)(()=>[{label:"January",value:1},{label:"February",value:2},{label:"March",value:3},{label:"April",value:4},{label:"May",value:5},{label:"June",value:6},{label:"July",value:7},{label:"August",value:8},{label:"September",value:9},{label:"October",value:10},{label:"November",value:11},{label:"December",value:12}],[]);let eM=(e,t)=>e.replace(/\D+/g,"").slice(0,t),eR=(e,t,l)=>{let s=Number(e);return Number.isNaN(s)?NaN:Math.min(l,Math.max(t,s))},[eP,eB]=(0,a.useState)("A_LOCAL"),[eF,eO]=(0,a.useState)("30\xb010'N, 85\xb040'W"),[eD,eL]=(0,a.useState)(null),[eE,eI]=(0,a.useState)(()=>i("30\xb010'N, 85\xb040'W")),[ez,eY]=(0,a.useState)("Panama City, FL"),[eU,eH]=(0,a.useState)("US/Central"),[eJ,eW]=(0,a.useState)(!1),[eq,eZ]=(0,a.useState)(!1),[eV,eG]=(0,a.useState)(!0),[e$,eK]=(0,a.useState)(null),[eX,eQ]=(0,a.useState)(!0),[e0,e1]=(0,a.useState)(null);(0,a.useRef)(null);let e2=(0,a.useRef)(null),e3=(0,a.useRef)(null),e4=(0,a.useRef)(0),[e5,e6]=(0,a.useState)(null),[e7,e9]=(0,a.useState)(()=>{try{let e=window.localStorage.getItem("mb.reportType");return"mirror"===e||"balance"===e?e:"mirror"}catch(e){return"mirror"}});(0,a.useEffect)(()=>{try{let e=new URL(window.location.href).searchParams.get("report");("mirror"===e||"balance"===e)&&e9(e)}catch(e){}},[]),(0,a.useEffect)(()=>{try{window.localStorage.setItem("mb.reportType",e7)}catch(e){}},[e7]);let[e8,te]=(0,a.useState)(!1),[tt,tl]=(0,a.useState)(!0),[ts,ta]=(0,a.useState)(null),ti=(0,a.useRef)(null),[tn,tr]=(0,a.useState)(()=>{let e=window.localStorage.getItem("weeklyAgg");return"max"===e||"mean"===e?e:"mean"});(0,a.useEffect)(()=>{try{window.localStorage.setItem("weeklyAgg",tn)}catch(e){}},[tn]),(0,a.useEffect)(()=>{try{let e=window.localStorage.getItem("mb.lastInputs");te(!!e)}catch(e){te(!1)}},[]);let to=(0,a.useMemo)(()=>["SYNASTRY","SYNASTRY_TRANSITS","COMPOSITE","DUAL_NATAL_TRANSITS"],[]);async function td(){try{let e=e2.current||document.body,t=(await Promise.all([l.e(125),l.e(505),l.e(632),l.e(337),l.e(729)]).then(l.t.bind(l,7127,23))).default,s=new Date().toISOString().slice(0,10);await t().from(e).set({margin:.5,filename:"math-brain-report-".concat(s,".pdf"),image:{type:"jpeg",quality:.95},html2canvas:{scale:2,useCORS:!0,backgroundColor:"#0f1115"},jsPDF:{unit:"in",format:"letter",orientation:"portrait"}}).save()}catch(e){e6("Could not generate PDF"),setTimeout(()=>e6(null),2e3)}}function tc(){var e,t,l,s;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"AUTO";try{let t={schema:"mb-1",mode:V,step:$,startDate:J,endDate:q,includePersonB:ea,translocation:eP,personA:D,personB:en,relationshipType:eh,relationshipTier:eb,relationshipRole:ev,exEstranged:ef,relationshipNotes:ej},l=!!(ea&&en&&((null===(e=en.name)||void 0===e?void 0:e.toString().trim())||null!=en.latitude||null!=en.longitude||en.timezone||en.year||en.month||en.day||en.hour||en.minute)),s="A_B"===a?ea:l;"A_ONLY"!==a&&s||(delete t.personB,t.includePersonB=!1);let i=JSON.stringify(t,null,2),n=new Blob([i],{type:"application/json"}),r=new Date().toISOString().replace(/[-:]/g,"").replace(/\..+$/,""),o="A_ONLY"===a?"math_brain_setup_A_".concat(r,".json"):"math_brain_setup_".concat(r,".json"),d=window;if("function"==typeof d.showSaveFilePicker){(async()=>{try{let e=await d.showSaveFilePicker({suggestedName:o,types:[{description:"JSON files",accept:{"application/json":[".json"]}}]}),t=await e.createWritable();await t.write(n),await t.close();try{e6("Saved setup JSON"),setTimeout(()=>e6(null),1800)}catch(e){}}catch(l){let e=URL.createObjectURL(n),t=document.createElement("a");t.href=e,t.download=o,document.body.appendChild(t),t.click(),setTimeout(()=>{document.body.removeChild(t),URL.revokeObjectURL(e);try{e6("Saved setup JSON"),setTimeout(()=>e6(null),1800)}catch(e){}},150)}})();return}let c=URL.createObjectURL(n),u=document.createElement("a");u.href=c,u.download=o,document.body.appendChild(u),"download"in HTMLAnchorElement.prototype?u.click():window.open(c,"_blank","noopener"),setTimeout(()=>{try{document.body.removeChild(u)}catch(e){}try{URL.revokeObjectURL(c)}catch(e){}try{e6("Saved setup JSON"),setTimeout(()=>e6(null),1800)}catch(e){}},300)}catch(e){console.error("Save setup failed:",e);try{null===(s=navigator)||void 0===s||null===(l=s.clipboard)||void 0===l||null===(t=l.writeText)||void 0===t||t.call(l,JSON.stringify({mode:V,step:$,startDate:J,endDate:q,includePersonB:ea,translocation:eP,personA:D,personB:en},null,2)).then(()=>{e6("Saved to clipboard (download blocked)"),setTimeout(()=>e6(null),2200)}).catch(()=>{e6("Save setup failed"),setTimeout(()=>e6(null),2200)})}catch(e){}}}async function tu(e){var t,l,s,a,n;let o=null===(t=e.target.files)||void 0===t?void 0:t[0];if(o){try{let e=await o.text(),t=JSON.parse(e);ta(null);let d="object"==typeof t&&!!t&&(t.personA||t.period||t.relocation),c="object"==typeof t&&!!t&&t.personA&&(null!=t.personA.latitude||t.personA.coords),u="string"==typeof(null==t?void 0:t.schema);if(!d&&!c&&!u)throw Error("Invalid setup shape: expected .math_brain.json minimal schema or internal export.");if((d||u)&&!c){let e=t.personA||{},l=e.coords||"",s=l?i(String(l),{rejectZeroZero:!0}):null,[a,n,o]=String(e.date||"").split("-").map(e=>Number(e)),[d,c]=String(e.time||"").split(":").map(e=>Number(e));if(l&&!s)throw Error("Invalid personA.coords");let u={...D};if(e.name&&(u.name=String(e.name)),Number.isFinite(a)&&(u.year=a),Number.isFinite(n)&&(u.month=n),Number.isFinite(o)&&(u.day=o),Number.isFinite(d)&&(u.hour=d),Number.isFinite(c)&&(u.minute=c),e.timezone&&(u.timezone=String(e.timezone)),s&&(u.latitude=s.lat,u.longitude=s.lon,I(r(s.lat,s.lon)),Y(null),H(!0)),t.zodiacType&&(u.zodiac_type=String(t.zodiacType)),L(u),t.personB){let e=t.personB,l=e.coords?i(String(e.coords),{rejectZeroZero:!0}):null,s={...en};e.name&&(s.name=String(e.name)),l&&(s.latitude=String(l.lat),s.longitude=String(l.lon),ed(r(l.lat,l.lon)),eu(null),ex(!0)),e.timezone&&(s.timezone=String(e.timezone)),er(s),ei(!0)}if(t.relationship_context){let e=t.relationship_context;e.type&&ep(String(e.type).toUpperCase()),e.intimacy_tier&&eg(String(e.intimacy_tier))}if(t.period){let e=t.period;e.start&&W(String(e.start)),e.end&&Z(String(e.end)),e.step&&K(String(e.step).toLowerCase())}if(t.relocation){let e=t.relocation;if(e.mode&&eB(String(e.mode)),e.coords){let t=i(String(e.coords),{rejectZeroZero:!0});t&&(eI(t),eO(String(e.coords)))}}}else t.personA&&L(t.personA),t.personB&&er(t.personB),"boolean"==typeof t.includePersonB&&ei(t.includePersonB),t.mode&&G(t.mode),t.step&&K(t.step),t.startDate&&W(t.startDate),t.endDate&&Z(t.endDate),"boolean"==typeof t.exEstranged&&ey(t.exEstranged),"string"==typeof t.relationshipNotes&&eS(t.relationshipNotes),"string"==typeof t.relationshipTier&&eg(t.relationshipTier),"string"==typeof t.relationshipRole&&eN(t.relationshipRole),t.translocation&&eB(t.translocation),(null===(l=t.personA)||void 0===l?void 0:l.latitude)!=null&&(null===(s=t.personA)||void 0===s?void 0:s.longitude)!=null&&(I(r(Number(t.personA.latitude),Number(t.personA.longitude))),Y(null),H(!0)),(null===(a=t.personB)||void 0===a?void 0:a.latitude)!=null&&(null===(n=t.personB)||void 0===n?void 0:n.longitude)!=null&&(ed(r(Number(t.personB.latitude),Number(t.personB.longitude))),eu(null),ex(!0))}catch(e){}e.currentTarget&&(e.currentTarget.value="")}}(0,a.useEffect)(()=>{!ea&&to.includes(V)&&G("NATAL_TRANSITS")},[ea,V,to]),(0,a.useEffect)(()=>{if(ea){var e;null===(e=e3.current)||void 0===e||e.focus()}},[ea]);let tm=(0,a.useMemo)(()=>{let e=[D.name,D.city,D.state,D.timezone,D.zodiac_type],t=ew&&"user_provided"!==e_,l="balance"===e7,s=[Number(D.year),Number(D.month),Number(D.day),...t?[]:[Number(D.hour),Number(D.minute)],...l?[Number(D.latitude),Number(D.longitude)]:[]],a=e.every(Boolean)&&s.every(e=>!Number.isNaN(e))&&U;if(!["SYNASTRY","SYNASTRY_TRANSITS","COMPOSITE","DUAL_NATAL_TRANSITS"].includes(V))return"mirror"===e7?a:a&&!!J&&!!q;if(!ea)return!1;let i=[en.name,en.city,en.state,en.timezone,en.zodiac_type],n=eT&&"user_provided"!==e_,r=[Number(en.year),Number(en.month),Number(en.day),...n?[]:[Number(en.hour),Number(en.minute)],Number(en.latitude),Number(en.longitude)],o=i.every(Boolean)&&r.every(e=>!Number.isNaN(e))&&em,d=!0;return"PARTNER"===eh&&(d=!!eb),"FAMILY"===eh&&(d=!!ev),a&&o&&d&&!!J&&!!q},[D,en,ea,eh,eb,ev,V,J,q,U,em,ew,eT,e_]),tx=(0,a.useMemo)(()=>{let e=(0,c.N8)(e7,!1,D);return"balance"===e7&&!e.hasLoc||!tm||!!X},[tm,X,D,e7]),th=(0,a.useMemo)(()=>{try{return"1"===new URL(window.location.href).searchParams.get("debug")}catch(e){return!1}},[]),tp=(0,a.useMemo)(()=>({reportType:e7,needsLocation:(0,c.N8)(e7,!1,D),canSubmit:tm,submitDisabled:tx,authReady:eJ,authed:eq,aCoordsValid:U,bCoordsValid:em,includePersonB:ea,timeUnknown:ew,timeUnknownB:eT,timePolicy:e_,personA_lat_type:typeof D.latitude,personA_lon_type:typeof D.longitude}),[e7,tm,tx,eJ,eq,U,em,ea,ew,eT,e_,D]);async function tb(e){e.preventDefault();let t=(0,c.N8)(e7,!1,D);if("balance"===e7&&!t.hasLoc){e6("Transits need current location to place houses correctly. Add a location or switch to Mirror (no transits)."),setTimeout(()=>e6(null),2500);return}if(!tm)return;let l=Date.now();if(!(l-e4.current<800)){e4.current=l,"undefined"!=typeof performance&&performance.now(),Q(!0),et(null),es(null);try{let e={mode:V,personA:{...D,nation:"US",year:Number(D.year),month:Number(D.month),day:Number(D.day),hour:Number(D.hour),minute:Number(D.minute),latitude:Number(D.latitude),longitude:Number(D.longitude)},time_policy:ew?e_:"user_provided",transitStartDate:J,transitEndDate:q,transitStep:$,context:{mode:"balance"===e7?"balance_meter":"mirror"},translocation:"A_LOCAL"===eP||"B_LOCAL"===eP||"MIDPOINT"===eP?{applies:!0,method:"A_LOCAL"===eP?"A_local":"B_LOCAL"===eP?"B_local":"Midpoint",coords:eE?{latitude:eE.lat,longitude:eE.lon}:void 0,current_location:ez||void 0,tz:eU||void 0}:{applies:!1,method:"Natal"}};try{tt&&(window.localStorage.setItem("mb.lastInputs",JSON.stringify({mode:V,step:$,startDate:J,endDate:q,includePersonB:ea,translocation:eP,relationshipType:eh,relationshipTier:eb,relationshipRole:ev,exEstranged:ef,relationshipNotes:ej,personA:D,personB:en})),te(!0))}catch(e){}["SYNASTRY","SYNASTRY_TRANSITS","COMPOSITE","DUAL_NATAL_TRANSITS"].includes(V)&&ea&&(e.personB={...en,nation:"US",year:Number(en.year),month:Number(en.month),day:Number(en.day),hour:Number(en.hour),minute:Number(en.minute),latitude:Number(en.latitude),longitude:Number(en.longitude)},e.relationship_context={type:eh,intimacy_tier:"PARTNER"===eh?eb:void 0,role:"PARTNER"!==eh?ev:void 0,ex_estranged:"FRIEND"===eh?void 0:ef,notes:ej||void 0});let t=await fetch("/api/astrology-mathbrain",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),l=await t.json();if(!t.ok||(null==l?void 0:l.success)===!1){let e=(null==l?void 0:l.error)||"Request failed (".concat(t.status,")");throw"mirror"===e7&&(e6("Mirror preparation failed"),setTimeout(()=>e6(null),2500)),Error(e)}es(l);try{var s,a;(null==l?void 0:null===(s=l.person_a)||void 0===s?void 0:s.meta)||null==l||null===(a=l.provenance)||void 0===a||a.time_meta_a}catch(e){}}catch(e){"mirror"===e7&&(e6("Mirror preparation failed"),setTimeout(()=>e6(null),2500)),et((null==e?void 0:e.message)||"Unexpected error")}finally{Q(!1)}}}return(0,s.jsxs)("main",{className:"mx-auto max-w-6xl px-6 py-12",children:[(0,s.jsx)(d,{onStateChange:(0,a.useCallback)(e=>{eW(e.authReady),eZ(e.authed),eG(e.authEnvOk),eK(e.authStatus),e1(()=>e.login)},[])}),!eV&&eX&&(0,s.jsxs)("div",{className:"mb-4 flex items-start justify-between gap-3 rounded-md border border-amber-700 bg-amber-900/30 p-3 text-amber-200",children:[(0,s.jsx)("p",{className:"text-sm",children:"Auth0 environment not configured (AUTH0_*). Sign-in is disabled; Poetic Brain gating will be unavailable."}),(0,s.jsx)("button",{type:"button",onClick:()=>eQ(!1),className:"rounded-md border border-amber-700 px-2 py-1 text-xs text-amber-100 hover:bg-amber-800/50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-amber-400","aria-label":"Dismiss banner",children:"Dismiss"})]}),(0,s.jsxs)("header",{className:"text-center print:hidden",children:[(0,s.jsx)("h1",{className:"text-4xl md:text-5xl font-bold tracking-tight text-slate-100",children:"Math Brain"}),(0,s.jsx)("p",{className:"mt-4 text-base md:text-lg text-slate-300",children:"Run the geometry first. Then, once you're signed in, jump into Chat to synthesize the narrative."}),(0,s.jsxs)("div",{className:"mt-6 flex items-center justify-center gap-4 text-sm text-slate-400",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"rounded bg-amber-600 px-2 py-1 text-xs font-medium text-slate-100",children:"FIELD"}),(0,s.jsx)("span",{className:"text-xs",children:"Geometric calculation engine"})]}),(0,s.jsx)("span",{className:"text-slate-600",children:"→"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 opacity-50",children:[(0,s.jsx)("span",{className:"rounded bg-slate-700 px-2 py-1 text-xs font-medium text-slate-400",children:"MAP"}),(0,s.jsx)("span",{className:"text-xs",children:"Raven handles"})]}),(0,s.jsx)("span",{className:"text-slate-600",children:"→"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 opacity-50",children:[(0,s.jsx)("span",{className:"rounded bg-slate-700 px-2 py-1 text-xs font-medium text-slate-400",children:"VOICE"}),(0,s.jsx)("span",{className:"text-xs",children:"Raven handles"})]})]})]}),eJ&&(0,s.jsx)("div",{className:"mt-3 mx-auto max-w-3xl rounded-md border border-slate-700 bg-slate-900/50 p-2 text-[12px] text-slate-300 print:hidden",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"inline-block h-2 w-2 rounded-full ".concat(eV?"bg-emerald-500":"bg-amber-500"),"aria-hidden":!0}),(0,s.jsx)("span",{className:"font-medium",children:"Auth status"}),(0,s.jsx)("span",{className:"text-slate-400",children:eV?"Configured":"Misconfigured"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-slate-400",children:[(0,s.jsxs)("div",{title:"Auth0 Domain (from /api/auth-config)",children:["Domain: ",(0,s.jsx)("span",{className:"text-slate-200",children:(null==e$?void 0:e$.domain)||"—"})]}),(0,s.jsxs)("div",{title:"Auth0 Client ID (redacted)",children:["Client: ",(0,s.jsx)("span",{className:"text-slate-200",children:(null==e$?void 0:e$.clientId)?String(e$.clientId).slice(0,4)+"…":"—"})]}),(0,s.jsxs)("div",{title:"Google connection expected to be enabled in Auth0 app",children:["Google: ",(0,s.jsx)("span",{className:"text-slate-200",children:"expected"})]})]})]})}),(0,s.jsxs)("div",{className:"mt-8 flex flex-wrap gap-3 justify-center print:hidden",children:[(0,s.jsx)("a",{href:"/",className:"rounded-md border border-slate-700 bg-slate-800 px-4 py-2 text-slate-100 hover:bg-slate-700",children:"Back Home"}),R&&(0,s.jsx)("a",{href:"/index.html",className:"rounded-md bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-500",target:"_blank",rel:"noopener noreferrer",children:"Open Legacy Math Brain"}),eJ&&eq?(0,s.jsx)("a",{href:"/chat",className:"rounded-md bg-emerald-600 px-4 py-2 text-white hover:bg-emerald-500",children:"Go to Poetic Brain"}):(0,s.jsx)("button",{type:"button",onClick:()=>{e0?e0():et("Sign-in is disabled. Configure AUTH0_* and reload.")},disabled:!eJ||!e0,className:"rounded-md border border-slate-700 bg-slate-800 px-4 py-2 text-slate-100 hover:bg-slate-700 disabled:opacity-50",title:"Sign in to enable Poetic Brain",children:"Sign in for Poetic Brain"})]}),e8&&(0,s.jsxs)("div",{className:"mt-6 flex items-center justify-center gap-3 print:hidden",children:[(0,s.jsx)("div",{className:"rounded-md border border-slate-700 bg-slate-800/60 px-3 py-2 text-slate-200 text-sm",children:"Saved people found."}),(0,s.jsx)("button",{type:"button",onClick:function(){try{let e=window.localStorage.getItem("mb.lastInputs");if(!e)return;let t=JSON.parse(e);t.personA&&L(t.personA),t.personB&&er(t.personB),"boolean"==typeof t.includePersonB&&ei(t.includePersonB),t.mode&&G(t.mode),t.step&&K(t.step),t.startDate&&W(t.startDate),t.endDate&&Z(t.endDate),t.relationshipType&&ep(t.relationshipType),"boolean"==typeof t.exEstranged&&ey(t.exEstranged),"string"==typeof t.relationshipNotes&&eS(t.relationshipNotes),"string"==typeof t.relationshipTier&&eg(t.relationshipTier),"string"==typeof t.relationshipRole&&eN(t.relationshipRole),t.translocation&&eB(t.translocation)}catch(e){}},className:"rounded-md bg-indigo-600 px-3 py-2 text-white hover:bg-indigo-500 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",children:"Load People"}),(0,s.jsx)("button",{type:"button",onClick:function(){try{window.localStorage.removeItem("mb.lastInputs"),te(!1),tl(!0)}catch(e){}},className:"rounded-md border border-slate-700 bg-slate-800 px-3 py-2 text-slate-100 hover:bg-slate-700 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400",children:"Clear"})]}),(0,s.jsxs)("form",{onSubmit:tb,className:"mt-10 print:hidden",children:[th&&(0,s.jsxs)("div",{className:"mb-4 rounded-md border border-slate-600 bg-slate-900/60 p-3 text-xs text-slate-200",children:[(0,s.jsx)("div",{className:"font-medium mb-2",children:"Debug — gating state"}),(0,s.jsx)("pre",{className:"whitespace-pre-wrap break-words text-[12px]",children:JSON.stringify(tp,null,2)})]}),(0,s.jsxs)("div",{className:"mb-4 flex flex-wrap items-center justify-between gap-3 rounded-md border border-slate-700 bg-slate-900/50 p-3",children:[(0,s.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm text-slate-200",children:[(0,s.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-600 bg-slate-900 text-indigo-600 focus:ring-indigo-500",checked:tt,onChange:e=>tl(e.target.checked)}),"Remember people for next time"]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,s.jsxs)("div",{className:"inline-flex overflow-hidden rounded-md border border-slate-700 bg-slate-800",children:[(0,s.jsx)("button",{type:"button",onClick:()=>tc("A_ONLY"),className:"px-3 py-1.5 text-slate-100 hover:bg-slate-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400",title:"Save only Person A’s setup to JSON","aria-label":"Save only Person A setup",children:"Save A"}),(0,s.jsx)("div",{className:"h-6 w-px bg-slate-700 my-1"}),(0,s.jsx)("button",{type:"button",onClick:()=>tc("A_B"),className:"px-3 py-1.5 text-slate-100 hover:bg-slate-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400",title:"Save Person A + B (if included)","aria-label":"Save Person A and B setup",children:"Save A+B"})]}),(0,s.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=ti.current)||void 0===e?void 0:e.click()},className:"rounded-md border border-slate-700 bg-slate-800 px-3 py-1.5 text-slate-100 hover:bg-slate-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400","aria-label":"Load a setup from a JSON file",children:"Load setup…"}),(0,s.jsx)("input",{ref:ti,type:"file",accept:"application/json",onChange:tu,className:"hidden","aria-label":"Upload setup JSON file"})]}),ts&&(0,s.jsx)("div",{className:"mt-2 text-xs text-red-400",children:ts})]}),(0,s.jsxs)("section",{"aria-labelledby":"report-type-heading",className:"mb-6 rounded-lg border border-slate-700 bg-slate-800/60 p-4",children:[(0,s.jsx)("h3",{id:"report-type-heading",className:"text-sm font-medium text-slate-200",children:"Report Type"}),(0,s.jsxs)("div",{className:"mt-3 flex items-center justify-between gap-3",children:[(0,s.jsxs)("fieldset",{className:"inline-flex overflow-hidden rounded-md border border-slate-700 bg-slate-800 px-0 py-0",children:[(0,s.jsx)("legend",{className:"sr-only",children:"Choose report type"}),(0,s.jsxs)("label",{className:"px-3 py-1.5 text-sm cursor-pointer ".concat("mirror"===e7?"bg-indigo-600 text-white":"text-slate-200 hover:bg-slate-700"),title:"Send to Poetic Brain",onClick:()=>e9("mirror"),children:[(0,s.jsx)("input",{type:"radio",name:"reportType",value:"mirror",className:"sr-only",checked:"mirror"===e7,onChange:()=>e9("mirror")}),"Mirror",(0,s.jsx)("span",{className:"ml-1 text-[11px] text-slate-300/80",children:"(send to Poetic Brain)"})]}),(0,s.jsxs)("label",{className:"px-3 py-1.5 text-sm cursor-pointer ".concat("balance"===e7?"bg-indigo-600 text-white":"text-slate-200 hover:bg-slate-700"),title:"Show gauges on screen",onClick:()=>e9("balance"),children:[(0,s.jsx)("input",{type:"radio",name:"reportType",value:"balance",className:"sr-only",checked:"balance"===e7,onChange:()=>e9("balance")}),"Balance Meter",(0,s.jsx)("span",{className:"ml-1 text-[11px] text-slate-300/80",children:"(gauges on screen)"})]})]}),"mirror"===e7&&(0,s.jsx)("div",{className:"text-xs text-slate-400",children:eJ&&!eq?"Sign in to deliver Mirror to Poetic Brain":"Handoff only — no on-screen gauges"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2 items-start",children:[(0,s.jsx)(x,{title:"Person A (required)",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-name",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Name"}),(0,s.jsx)("input",{id:"a-name",placeholder:"Your Name",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-center text-slate-100 placeholder:text-slate-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:D.name,onChange:e=>L({...D,name:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{className:"grid grid-cols-5 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-year",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Year"}),(0,s.jsx)("input",{id:"a-year",type:"text",inputMode:"numeric",className:"mt-1 w-full min-w-[80px] h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:String(D.year),onChange:e=>L({...D,year:eM(e.target.value,4)}),placeholder:"YYYY",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-month",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Month"}),(0,s.jsx)("input",{id:"a-month",type:"text",inputMode:"numeric",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-center text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:String(null!==(y=D.month)&&void 0!==y?y:""),onChange:e=>{let t=eM(e.target.value,2);L({...D,month:t})},onBlur:e=>{let t=eR(eM(e.target.value,2),1,12);L(e=>({...e,month:Number.isNaN(t)?"":String(t).padStart(2,"0")}))},placeholder:"MM",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-day",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Day"}),(0,s.jsx)("input",{id:"a-day",type:"text",inputMode:"numeric",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-center text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:String(null!==(j=D.day)&&void 0!==j?j:""),onChange:e=>{let t=eM(e.target.value,2);L({...D,day:t})},onBlur:e=>{let t=eR(eM(e.target.value,2),1,31);L(e=>({...e,day:Number.isNaN(t)?"":String(t).padStart(2,"0")}))},placeholder:"DD",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-hour",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Hour"}),(0,s.jsx)("input",{id:"a-hour",type:"text",inputMode:"numeric",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:String(null!==(S=D.hour)&&void 0!==S?S:""),onChange:e=>{let t=eM(e.target.value,2);L({...D,hour:t})},onBlur:e=>{let t=eR(eM(e.target.value,2),0,23);L(e=>({...e,hour:Number.isNaN(t)?"":String(t).padStart(2,"0")}))},placeholder:"HH",required:!ek})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-minute",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Minute"}),(0,s.jsx)("input",{id:"a-minute",type:"text",inputMode:"numeric",className:"mt-1 w-full min-w-[60px] h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:String(null!==(w=D.minute)&&void 0!==w?w:""),onChange:e=>{let t=eM(e.target.value,2);L({...D,minute:t})},onBlur:e=>{let t=eR(eM(e.target.value,2),0,59);L(e=>({...e,minute:Number.isNaN(t)?"":String(t).padStart(2,"0")}))},placeholder:"MM",required:!ek})]})]}),"            ",(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-city",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"City"}),(0,s.jsx)("input",{id:"a-city",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:D.city,onChange:e=>L({...D,city:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-state",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"State / Province"}),(0,s.jsx)("input",{id:"a-state",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:D.state,onChange:e=>L({...D,state:e.target.value}),required:!0}),(0,s.jsx)("p",{className:"mt-1 text-[11px] text-slate-500",children:"Nation assumed “US” for API compatibility."})]}),(0,s.jsxs)("div",{className:"sm:col-span-2",children:[(0,s.jsx)("label",{htmlFor:"a-coords",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Birth Coordinates"}),(0,s.jsx)("input",{id:"a-coords",type:"text",className:"mt-1 w-full rounded-md border bg-slate-900 px-3 py-2 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 ".concat(z?"border-red-600":"border-slate-600"),value:E,onChange:e=>{let t=e.target.value;I(t);let l=i(t,{rejectZeroZero:!0});l?(L({...D,latitude:l.lat,longitude:l.lon}),Y(null),H(!0)):(Y('Invalid coordinates. Try "40\xb042′N, 74\xb00′W" or "40.7128, -74.006".'),H(!1))},"aria-describedby":"a-coords-help",placeholder:"e.g., 40\xb042′N, 74\xb00′W or 40.7128, -74.006",required:!0}),(0,s.jsx)("p",{id:"a-coords-help",className:"mt-1 text-xs text-slate-400",children:"Examples: 40\xb042′N, 74\xb00′W \xb7 34\xb03′S, 18\xb025′E \xb7 40.7128, -74.006"}),z?(0,s.jsx)("p",{className:"mt-1 text-xs text-red-400",children:z}):(0,s.jsxs)("p",{className:"mt-1 text-xs text-slate-400",children:["Normalized: ",r(Number(D.latitude),Number(D.longitude))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-tz",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Timezone"}),(0,s.jsx)("select",{id:"a-tz",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:D.timezone,onChange:e=>L({...D,timezone:e.target.value}),required:!0,children:eC.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-zodiac",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Zodiac Type"}),(0,s.jsxs)("select",{id:"a-zodiac",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100",value:D.zodiac_type,onChange:e=>L({...D,zodiac_type:e.target.value}),children:[(0,s.jsx)("option",{value:"Tropic",children:"Tropic"}),(0,s.jsx)("option",{value:"Sidereal",children:"Sidereal"})]})]}),ew&&(0,s.jsx)("div",{className:"sm:col-span-2",children:(0,s.jsxs)("fieldset",{className:"rounded-md border border-slate-700 bg-slate-900/50 p-3",children:[(0,s.jsx)("legend",{className:"px-1 text-xs font-medium text-slate-200",children:"Birth time policy"}),(0,s.jsxs)("div",{className:"mt-2 grid grid-cols-1 gap-2 sm:grid-cols-3",children:[(0,s.jsxs)("label",{className:"flex cursor-pointer items-start gap-2 rounded-md border px-3 py-2 text-xs ".concat("planetary_only"===e_?"border-indigo-600 bg-indigo-900/20 text-slate-100":"border-slate-700 bg-slate-800/50 text-slate-300 hover:bg-slate-800"),children:[(0,s.jsx)("input",{type:"radio",name:"time-policy",className:"mt-0.5",checked:"planetary_only"===e_,onChange:()=>eA("planetary_only")}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:"Planetary-only"}),(0,s.jsx)("div",{className:"text-slate-400",children:"No houses/angles; tightest, falsifiable geometry"})]})]}),(0,s.jsxs)("label",{className:"flex cursor-pointer items-start gap-2 rounded-md border px-3 py-2 text-xs ".concat("whole_sign"===e_?"border-indigo-600 bg-indigo-900/20 text-slate-100":"border-slate-700 bg-slate-800/50 text-slate-300 hover:bg-slate-800"),children:[(0,s.jsx)("input",{type:"radio",name:"time-policy",className:"mt-0.5",checked:"whole_sign"===e_,onChange:()=>eA("whole_sign")}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:"Whole-sign houses"}),(0,s.jsx)("div",{className:"text-slate-400",children:"House semantics without exact time; angles still suppressed"})]})]}),(0,s.jsxs)("label",{className:"flex cursor-pointer items-start gap-2 rounded-md border px-3 py-2 text-xs ".concat("sensitivity_scan"===e_?"border-indigo-600 bg-indigo-900/20 text-slate-100":"border-slate-700 bg-slate-800/50 text-slate-300 hover:bg-slate-800"),children:[(0,s.jsx)("input",{type:"radio",name:"time-policy",className:"mt-0.5",checked:"sensitivity_scan"===e_,onChange:()=>eA("sensitivity_scan")}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:"Sensitivity scan"}),(0,s.jsx)("div",{className:"text-slate-400",children:"Test a window of possible times; house-dependent insights flagged"})]})]})]})]})})]})}),(0,s.jsxs)(x,{title:"Person B (optional for relational)",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsx)("p",{className:"text-xs text-slate-400",children:"Add a second person for synastry/composite modes."}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"inline-flex rounded-md border border-slate-700 bg-slate-800 p-1",children:[(0,s.jsx)("button",{type:"button",onClick:function(){ea&&er(e=>({...e,year:String(D.year),month:String(D.month),day:String(D.day),hour:String(D.hour),minute:String(D.minute),city:D.city,state:D.state,latitude:String(D.latitude),longitude:String(D.longitude),timezone:D.timezone,zodiac_type:D.zodiac_type}))},disabled:!ea,className:"px-2 py-1 text-xs text-slate-100 hover:bg-slate-700 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",title:"Copy Person A details to Person B (keeps B name)",children:"Copy A→B"}),(0,s.jsx)("div",{className:"mx-1 h-5 w-px bg-slate-700"}),(0,s.jsx)("button",{type:"button",onClick:function(){ea&&(L(e=>{var t,l,s,a,i,n,r;return{...e,name:en.name||e.name,year:null!==(t=en.year)&&void 0!==t?t:e.year,month:null!==(l=en.month)&&void 0!==l?l:e.month,day:null!==(s=en.day)&&void 0!==s?s:e.day,hour:null!==(a=en.hour)&&void 0!==a?a:e.hour,minute:null!==(i=en.minute)&&void 0!==i?i:e.minute,city:en.city||e.city,state:en.state||e.state,latitude:null!==(n=en.latitude)&&void 0!==n?n:e.latitude,longitude:null!==(r=en.longitude)&&void 0!==r?r:e.longitude,timezone:en.timezone||e.timezone,zodiac_type:en.zodiac_type||e.zodiac_type}}),er(e=>({...e,year:String(D.year),month:String(D.month),day:String(D.day),hour:String(D.hour),minute:String(D.minute),city:D.city,state:D.state,latitude:String(D.latitude),longitude:String(D.longitude),timezone:D.timezone,zodiac_type:D.zodiac_type})))},disabled:!ea,className:"px-2 py-1 text-xs text-slate-100 hover:bg-slate-700 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",title:"Swap A/B (relationship settings unchanged)",children:"Swap A/B"}),(0,s.jsx)("div",{className:"mx-1 h-5 w-px bg-slate-700"}),(0,s.jsx)("button",{type:"button",onClick:function(){ea&&er({name:"",year:"",month:"",day:"",hour:"",minute:"",city:"",state:"",latitude:"",longitude:"",timezone:"",zodiac_type:"Tropic"})},disabled:!ea,className:"px-2 py-1 text-xs text-slate-100 hover:bg-slate-700 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",title:"Clear all Person B fields",children:"Clear B"}),(0,s.jsx)("div",{className:"mx-1 h-5 w-px bg-slate-700"}),(0,s.jsx)("button",{type:"button",onClick:function(){if(!ea)return;let e=new Date;er(t=>({...t,year:String(e.getUTCFullYear()),month:String(e.getUTCMonth()+1),day:String(e.getUTCDate()),hour:String(e.getUTCHours()),minute:String(e.getUTCMinutes()),timezone:"UTC",city:t.city||"",state:t.state||"",latitude:t.latitude||"",longitude:t.longitude||""}))},disabled:!ea,className:"px-2 py-1 text-xs text-slate-100 hover:bg-slate-700 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",title:"Set Person B date/time to now (UTC)",children:"Set B = Now (UTC)"})]}),(0,s.jsxs)("label",{htmlFor:"toggle-include-b-a",className:"inline-flex items-center gap-2 text-sm text-slate-200 cursor-pointer",children:[(0,s.jsx)("input",{id:"toggle-include-b-a",type:"checkbox",className:"h-4 w-4 rounded border-slate-600 bg-slate-900 text-indigo-600 focus:ring-indigo-500",checked:ea,onChange:e=>ei(e.target.checked)}),"Include Person B"]})]})]}),(0,s.jsx)("div",{className:"mt-4 ".concat(ea?"":"opacity-50"),children:(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-name",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Name"}),(0,s.jsx)("input",{id:"b-name",ref:e3,placeholder:"Their Name",disabled:!ea,className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-center text-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:opacity-50",value:en.name,onChange:e=>er({...en,name:e.target.value})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-5 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-year",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Year"}),(0,s.jsx)("input",{id:"b-year",type:"text",inputMode:"numeric",disabled:!ea,className:"mt-1 w-full min-w-[80px] h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:String(en.year),onChange:e=>er({...en,year:eM(e.target.value,4)}),placeholder:"YYYY"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-month",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Month"}),(0,s.jsx)("input",{id:"b-month",type:"text",inputMode:"numeric",disabled:!ea,className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-center text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:String(null!==(_=en.month)&&void 0!==_?_:""),onChange:e=>{let t=eM(e.target.value,2);er({...en,month:t})},onBlur:e=>{let t=eR(eM(e.target.value,2),1,12);er(e=>({...e,month:Number.isNaN(t)?"":String(t).padStart(2,"0")}))},placeholder:"MM"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-day",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Day"}),(0,s.jsx)("input",{id:"b-day",type:"text",inputMode:"numeric",disabled:!ea,className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:String(null!==(A=en.day)&&void 0!==A?A:""),onChange:e=>{let t=eM(e.target.value,2);er({...en,day:t})},onBlur:e=>{let t=eR(eM(e.target.value,2),1,31);er(e=>({...e,day:Number.isNaN(t)?"":String(t).padStart(2,"0")}))},placeholder:"DD"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-hour",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Hour"}),(0,s.jsx)("input",{id:"b-hour",type:"text",inputMode:"numeric",disabled:!ea,className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:String(null!==(T=en.hour)&&void 0!==T?T:""),onChange:e=>{let t=eM(e.target.value,2);er({...en,hour:t})},onBlur:e=>{let t=eR(eM(e.target.value,2),0,23);er(e=>({...e,hour:Number.isNaN(t)?"":String(t).padStart(2,"0")}))},placeholder:"HH"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-minute",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Minute"}),(0,s.jsx)("input",{id:"b-minute",type:"text",inputMode:"numeric",disabled:!ea,className:"mt-1 w-full min-w-[60px] h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:String(null!==(k=en.minute)&&void 0!==k?k:""),onChange:e=>{let t=eM(e.target.value,2);er({...en,minute:t})},onBlur:e=>{let t=eR(eM(e.target.value,2),0,59);er(e=>({...e,minute:Number.isNaN(t)?"":String(t).padStart(2,"0")}))},placeholder:"MM"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-city",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"City"}),(0,s.jsx)("input",{id:"b-city",disabled:!ea,className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:en.city,onChange:e=>er({...en,city:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-state",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"State / Province"}),(0,s.jsx)("input",{id:"b-state",disabled:!ea,className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:en.state,onChange:e=>er({...en,state:e.target.value})}),(0,s.jsx)("p",{className:"mt-1 text-[11px] text-slate-500",children:"Nation assumed “US” for API compatibility."})]}),(0,s.jsxs)("div",{className:"sm:col-span-2",children:[(0,s.jsx)("label",{htmlFor:"b-coords",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Birth Coordinates (B)"}),(0,s.jsx)("input",{id:"b-coords",type:"text",disabled:!ea,className:"mt-1 w-full rounded-md border bg-slate-900 px-3 py-2 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 ".concat(ec?"border-red-600":"border-slate-600"),value:eo,onChange:e=>{let t=e.target.value;if(ed(t),!ea)return;let l=i(t,{rejectZeroZero:!0});l?(er({...en,latitude:l.lat,longitude:l.lon}),eu(null),ex(!0)):(eu("Invalid coordinates"),ex(!1))},placeholder:"e.g., 34\xb003′S, 18\xb025′E or -34.0500, 18.4167"}),(0,s.jsx)("p",{className:"mt-1 text-xs text-slate-400",children:"Examples: 40\xb042′N, 74\xb00′W \xb7 34\xb03′S, 18\xb025′E \xb7 40.7128, -74.006"}),(0,s.jsxs)("p",{className:"mt-1 text-xs text-slate-400",children:["Normalized: ",Number(en.latitude)||Number(en.longitude)?r(Number(en.latitude),Number(en.longitude)):"—"]}),ec&&(0,s.jsx)("p",{className:"mt-1 text-xs text-red-400",children:ec})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-tz",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Timezone"}),(0,s.jsx)("select",{id:"b-tz",disabled:!ea,className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:en.timezone,onChange:e=>er({...en,timezone:e.target.value}),children:eC.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-zodiac",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Zodiac Type"}),(0,s.jsxs)("select",{id:"b-zodiac",disabled:!ea,className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 disabled:opacity-50",value:en.zodiac_type,onChange:e=>er({...en,zodiac_type:e.target.value}),children:[(0,s.jsx)("option",{value:"Tropic",children:"Tropic"}),(0,s.jsx)("option",{value:"Sidereal",children:"Sidereal"})]})]})]})})]}),(0,s.jsxs)(x,{title:"Relationship Context",children:[(0,s.jsx)("div",{className:"mb-2 flex items-center justify-between",children:(0,s.jsx)("p",{className:"text-xs text-slate-400",children:"These fields unlock when Person B is included."})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 ".concat(ea?"":"opacity-50"),children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"rel-type",className:"block text-sm text-slate-300",children:"Type"}),(0,s.jsxs)("select",{id:"rel-type",disabled:!ea,className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100",value:eh,onChange:e=>{ep(e.target.value),eg(""),eN("")},children:[(0,s.jsx)("option",{value:"PARTNER",children:"Partner"}),(0,s.jsx)("option",{value:"FRIEND",children:"Friend / Colleague"}),(0,s.jsx)("option",{value:"FAMILY",children:"Family"})]}),(0,s.jsxs)("div",{className:"mt-2 text-[11px] text-slate-400",children:[(0,s.jsx)("div",{className:"font-medium text-slate-300",children:"Primary Relational Tiers (scope):"}),(0,s.jsx)("div",{children:"• Partner — full map access, including intimacy arcs & legacy patterns."}),(0,s.jsx)("div",{children:"• Friend / Colleague — emotional, behavioral, social dynamics; intimacy overlays de-emphasized."}),(0,s.jsx)("div",{children:"• Family — legacy patterns and behavioral overlays; sexual resonance suppressed."}),(0,s.jsx)("div",{children:"• Acquaintance — light pattern echoes only; intimacy dynamics locked."})]})]}),"PARTNER"===eh&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"rel-tier",className:"block text-sm text-slate-300",children:"Intimacy Tier"}),(0,s.jsxs)("select",{id:"rel-tier",disabled:!ea,className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100",value:eb,onChange:e=>eg(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"Select…"}),(0,s.jsx)("option",{value:"P1",children:"P1 — Platonic partners"}),(0,s.jsx)("option",{value:"P2",children:"P2 — Friends-with-benefits"}),(0,s.jsx)("option",{value:"P3",children:"P3 — Situationship (unclear/unstable)"}),(0,s.jsx)("option",{value:"P4",children:"P4 — Low-commitment romantic or sexual"}),(0,s.jsx)("option",{value:"P5a",children:"P5a — Committed romantic + sexual"}),(0,s.jsx)("option",{value:"P5b",children:"P5b — Committed romantic, non-sexual"})]}),ea&&["SYNASTRY","SYNASTRY_TRANSITS","COMPOSITE","DUAL_NATAL_TRANSITS"].includes(V)&&!eb&&(0,s.jsx)("p",{className:"mt-1 text-xs text-amber-400",children:"Partner relationships require an intimacy tier."})]}),"FAMILY"===eh&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"rel-role",className:"block text-sm text-slate-300",children:"Role"}),(0,s.jsxs)("select",{id:"rel-role",disabled:!ea,className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100",value:ev,onChange:e=>eN(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"Select…"}),(0,s.jsx)("option",{value:"Parent",children:"Parent"}),(0,s.jsx)("option",{value:"Offspring",children:"Offspring"}),(0,s.jsx)("option",{value:"Sibling",children:"Sibling"}),(0,s.jsx)("option",{value:"Cousin",children:"Cousin"}),(0,s.jsx)("option",{value:"Extended",children:"Extended"}),(0,s.jsx)("option",{value:"Guardian",children:"Guardian"}),(0,s.jsx)("option",{value:"Mentor",children:"Mentor"}),(0,s.jsx)("option",{value:"Other",children:"Other"}),(0,s.jsx)("option",{value:"Custom",children:"Custom"})]}),ea&&["SYNASTRY","SYNASTRY_TRANSITS","COMPOSITE","DUAL_NATAL_TRANSITS"].includes(V)&&!eb&&(0,s.jsx)("p",{className:"mt-1 text-xs text-amber-400",children:"Partner relationships require an intimacy tier."})]}),"FRIEND"===eh&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"rel-role-f",className:"block text-sm text-slate-300",children:"Role (optional)"}),(0,s.jsxs)("select",{id:"rel-role-f",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100",value:ev,onChange:e=>eN(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"—"}),(0,s.jsx)("option",{value:"Acquaintance",children:"Acquaintance"}),(0,s.jsx)("option",{value:"Mentor",children:"Mentor"}),(0,s.jsx)("option",{value:"Other",children:"Other"}),(0,s.jsx)("option",{value:"Custom",children:"Custom"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{id:"rel-ex",type:"checkbox",className:"h-4 w-4 rounded border-slate-600 bg-slate-900 text-indigo-600 focus:ring-indigo-500",checked:ef,onChange:e=>ey(e.target.checked),disabled:!ea||"FRIEND"===eh}),(0,s.jsx)("label",{htmlFor:"rel-ex",className:"text-sm text-slate-300",children:"Ex / Estranged"})]}),(0,s.jsxs)("div",{className:"sm:col-span-2",children:[(0,s.jsx)("label",{htmlFor:"rel-notes",className:"block text-sm text-slate-300",children:"Notes"}),(0,s.jsx)("textarea",{id:"rel-notes",disabled:!ea,className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",rows:3,placeholder:"Optional context (max 500 chars)",value:ej,onChange:e=>eS(e.target.value.slice(0,500))})]})]})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(x,{title:"Transits",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"t-start",className:"block text-sm text-slate-300",children:"Start Date"}),(0,s.jsx)("input",{id:"t-start",type:"date",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:J,onChange:e=>W(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"t-end",className:"block text-sm text-slate-300",children:"End Date"}),(0,s.jsx)("input",{id:"t-end",type:"date",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:q,onChange:e=>Z(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"t-step",className:"block text-sm text-slate-300",children:"Step"}),(0,s.jsxs)("select",{id:"t-step",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:$,onChange:e=>K(e.target.value),children:[(0,s.jsx)("option",{value:"daily",children:"Daily"}),(0,s.jsx)("option",{value:"weekly",children:"Weekly"}),(0,s.jsx)("option",{value:"monthly",children:"Monthly"})]})]})]}),(0,s.jsxs)("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"t-mode",className:"block text-sm text-slate-300",children:"Mode"}),(0,s.jsxs)("select",{id:"t-mode",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:V,onChange:e=>{let t=e.target.value;G(t),["SYNASTRY","SYNASTRY_TRANSITS","COMPOSITE","DUAL_NATAL_TRANSITS"].includes(t)&&ei(!0)},children:[(0,s.jsx)("option",{value:"NATAL_ONLY",children:"Natal only"}),(0,s.jsx)("option",{value:"NATAL_TRANSITS",children:"Natal + Transits"}),(0,s.jsx)("option",{value:"DUAL_NATAL_TRANSITS",children:"Dual Natal + Transits (A & B, no synastry)"}),(0,s.jsx)("option",{value:"SYNASTRY",children:"Synastry (A ↔ B)"}),(0,s.jsx)("option",{value:"SYNASTRY_TRANSITS",children:"Synastry + Transits"}),(0,s.jsx)("option",{value:"COMPOSITE",children:"Composite (midpoint) + Relational Mirror"})]}),!ea&&(0,s.jsx)("p",{className:"mt-1 text-xs text-amber-400",children:"Selecting a relational mode will enable “Include Person B”."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"t-reloc",className:"block text-sm text-slate-300",children:"Relocation (angles/houses)"}),(0,s.jsxs)("select",{id:"t-reloc",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:eP,onChange:e=>eB(e.target.value),children:[(0,s.jsx)("option",{value:"NONE",children:"None (Natal Base)"}),(0,s.jsx)("option",{value:"A_LOCAL",children:"Person A"}),(0,s.jsx)("option",{value:"B_LOCAL",disabled:!ea,children:"Person B"}),(0,s.jsx)("option",{value:"MIDPOINT",disabled:!ea,children:"Midpoint (A + B)"})]}),(0,s.jsx)("p",{className:"mt-1 text-xs text-slate-400",children:"Clinical toggle only; no narrative. If not applied, angles/houses remain natal."}),(0,s.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"Note: Midpoint here relocates houses to the geographic midpoint; Composite mode above creates the midpoint chart."}),"NONE"!==eP?(0,s.jsxs)("div",{className:"mt-4 inline-flex items-center gap-2 rounded-full border border-emerald-700 bg-emerald-900/30 px-3 py-1 text-xs text-emerald-200",children:[(0,s.jsx)("span",{className:"inline-block h-1.5 w-1.5 rounded-full bg-emerald-400","aria-hidden":!0}),(0,s.jsx)("span",{className:"font-medium",children:"Relocated to:"}),(0,s.jsx)("span",{className:"text-emerald-100",children:ez||"Custom"}),(0,s.jsxs)("span",{className:"text-emerald-300",children:["(",eU||D.timezone||"—",")"]})]}):null]})]}),"NONE"!==eP&&(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("label",{htmlFor:"t-reloc-coords",className:"block text-sm text-slate-300",children:"Relocation Coordinates"}),(0,s.jsx)("input",{id:"t-reloc-coords",type:"text",className:"mt-1 w-full h-10 rounded-md border bg-slate-900 px-3 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 ".concat(eD?"border-red-600":"border-slate-600"),value:eF,onChange:e=>{let t=e.target.value;eO(t);let l=i(t,{rejectZeroZero:!0});l?(eI(l),eL(null)):(eI(null),eL("Invalid coordinates"))},placeholder:"e.g., 30\xb010′N, 85\xb040′W"}),(0,s.jsxs)("p",{className:"mt-1 text-xs text-slate-400",children:["Default: 30\xb010′N, 85\xb040′W \xb7 Normalized: ",eE?r(eE.lat,eE.lon):"—"]}),eD&&(0,s.jsx)("p",{className:"mt-1 text-xs text-red-400",children:eD}),(0,s.jsxs)("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"t-reloc-label",className:"block text-sm text-slate-300",children:"Relocation Label"}),(0,s.jsx)("input",{id:"t-reloc-label",type:"text",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:ez,onChange:e=>eY(e.target.value),placeholder:"e.g., Panama City, FL"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"t-reloc-tz",className:"block text-sm text-slate-300",children:"Relocation Timezone"}),(0,s.jsx)("select",{id:"t-reloc-tz",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:eU,onChange:e=>eH(e.target.value),children:eC.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]})]})]}),"weekly"===$&&(0,s.jsxs)("div",{className:"mt-2 flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-xs text-slate-400",children:"Weekly aggregation"}),(0,s.jsx)("button",{type:"button",className:"h-5 w-5 rounded-full border border-slate-600 text-[11px] text-slate-300 hover:bg-slate-700/60 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",title:"Mean = average of daily values per week; Max = highest daily value per week","aria-label":"Help: Weekly aggregation semantics",children:"?"}),(0,s.jsxs)("div",{role:"group","aria-label":"Weekly aggregation",className:"inline-flex overflow-hidden rounded-md border border-slate-700 bg-slate-800",children:[(0,s.jsx)("button",{type:"button",onClick:()=>tr("mean"),className:"px-3 py-1 text-xs ".concat("mean"===tn?"bg-indigo-600 text-white":"text-slate-200 hover:bg-slate-700"," focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500"),children:"Mean"}),(0,s.jsx)("button",{type:"button",onClick:()=>tr("max"),className:"px-3 py-1 text-xs ".concat("max"===tn?"bg-indigo-600 text-white":"text-slate-200 hover:bg-slate-700"," focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500"),children:"Max"})]})]}),"NONE"!==eP&&(0,s.jsxs)("div",{className:"mt-3 inline-flex items-center gap-2 rounded-full border border-emerald-700 bg-emerald-900/30 px-3 py-1 text-xs text-emerald-200",children:[(0,s.jsx)("span",{className:"inline-block h-1.5 w-1.5 rounded-full bg-emerald-400","aria-hidden":!0}),(0,s.jsx)("span",{className:"font-medium",children:"Relocated to:"}),(0,s.jsx)("span",{className:"text-emerald-100",children:ez||"—"}),(0,s.jsx)("span",{className:"text-emerald-300",children:eU||D.timezone||"—"})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"All processing is geometry-first and non-deterministic. Your data isn’t stored."}),(0,s.jsxs)("div",{className:"mr-2 hidden sm:flex items-center gap-2 text-[11px] text-slate-400",children:[(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 rounded-full border border-slate-700 bg-slate-800 px-2 py-0.5",children:[(0,s.jsx)("span",{className:"text-slate-300",children:"Mode:"}),(0,s.jsx)("span",{className:"text-slate-100",children:V.replace(/_/g," ")})]}),(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 rounded-full border border-slate-700 bg-slate-800 px-2 py-0.5",children:[(0,s.jsx)("span",{className:"text-slate-300",children:"Report:"}),(0,s.jsx)("span",{className:"text-slate-100 capitalize",children:e7})]})]}),(0,s.jsx)("button",{type:"submit",disabled:tx,className:"inline-flex items-center rounded-md px-4 py-2 text-white disabled:opacity-50 bg-indigo-600 hover:bg-indigo-500",children:X?"Mapping geometry…":"balance"===e7?"Generate Report":"Prepare Mirror"})]}),["SYNASTRY","SYNASTRY_TRANSITS","COMPOSITE","DUAL_NATAL_TRANSITS"].includes(V)&&!ea&&(0,s.jsx)("p",{className:"mt-2 text-xs text-amber-400",children:"Hint: Toggle “Include Person B” and fill in required fields to enable relational modes."})]})]})]}),ee&&(0,s.jsxs)("div",{className:"mt-6 rounded-md border border-red-700 bg-red-900/30 p-4 text-red-200",children:[(0,s.jsx)("p",{className:"font-medium",children:"Error"}),(0,s.jsx)("p",{className:"mt-1 text-sm",children:ee})]}),X&&(0,s.jsxs)("div",{className:"mt-8 grid grid-cols-1 gap-6 print:hidden",children:[(0,s.jsxs)("section",{className:"rounded-lg border border-slate-700 bg-slate-800/60 p-4",children:[(0,s.jsx)("div",{className:"h-5 w-40 rounded bg-slate-700 animate-pulse"}),(0,s.jsxs)("div",{className:"mt-4 grid grid-cols-3 gap-3",children:[(0,s.jsx)("div",{className:"h-16 rounded bg-slate-700/70 animate-pulse"}),(0,s.jsx)("div",{className:"h-16 rounded bg-slate-700/70 animate-pulse"}),(0,s.jsx)("div",{className:"h-16 rounded bg-slate-700/70 animate-pulse"})]})]}),(0,s.jsxs)("section",{className:"rounded-lg border border-slate-700 bg-slate-800/60 p-4",children:[(0,s.jsx)("div",{className:"h-5 w-56 rounded bg-slate-700 animate-pulse"}),(0,s.jsx)("div",{className:"mt-4 h-24 rounded bg-slate-700/60 animate-pulse"})]})]}),el&&(0,s.jsxs)("div",{className:"mt-8 grid grid-cols-1 gap-6",children:[(()=>{var e,t;let l=(null==el?void 0:null===(e=el.person_a)||void 0===e?void 0:e.meta)||(null==el?void 0:null===(t=el.provenance)||void 0===t?void 0:t.time_meta_a);if(!l)return null;let a=!!l.houses_suppressed,i=String(l.time_precision||""),n=l.effective_time_used;return(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[a&&(0,s.jsx)("div",{className:"rounded-md border border-slate-700 bg-slate-800/70 px-3 py-1 text-xs text-slate-200",children:"Angles unavailable without birth time; houses suppressed."}),n&&(0,s.jsxs)("div",{className:"inline-flex items-center gap-2 rounded-full border border-emerald-700 bg-emerald-900/30 px-3 py-1 text-xs text-emerald-200",children:[(0,s.jsx)("span",{className:"inline-block h-1.5 w-1.5 rounded-full bg-emerald-400","aria-hidden":!0}),(0,s.jsx)("span",{className:"font-medium",children:"Effective time"}),(0,s.jsx)("span",{className:"text-emerald-100",children:n})]}),"unknown"===i&&"planetary_only"===e_&&(0,s.jsx)("div",{className:"rounded-md border border-amber-700 bg-amber-900/30 px-3 py-1 text-xs text-amber-200",children:"Using planetary-only mode. You can run a sensitivity scan for house-dependent work."})]})})(),(0,s.jsxs)("div",{className:"flex items-center justify-between gap-4 print:hidden",children:[(0,s.jsx)("div",{className:"text-sm text-slate-400",children:eJ&&eq?(0,s.jsxs)("span",{children:["Download your report, then visit ",(0,s.jsx)("a",{href:"/chat",className:"text-emerald-400 hover:text-emerald-300 underline",children:"Poetic Brain"})," to upload it for interpretation."]}):(0,s.jsxs)("span",{children:["Download your report below. ",(0,s.jsx)("a",{href:"/chat",className:"text-slate-300 hover:text-slate-200 underline",children:"Sign in to Poetic Brain"})," to upload it for interpretation."]})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:function(){if(el)try{let e=new Blob([JSON.stringify(el,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),l=document.createElement("a"),s=new Date().toISOString().slice(0,10).replace(/-/g,"");l.href=t,l.download="math-brain-result-".concat(s,".json"),document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(t);try{e6("Downloading result JSON"),setTimeout(()=>e6(null),1400)}catch(e){}}catch(e){}},className:"rounded-md border border-slate-700 bg-slate-800 px-3 py-1.5 text-slate-100 hover:bg-slate-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400","aria-label":"Download result JSON",children:"Download JSON"}),(0,s.jsx)("button",{type:"button",onClick:td,className:"rounded-md border border-slate-700 bg-slate-800 px-3 py-1.5 text-slate-100 hover:bg-slate-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400","aria-label":"Download PDF",children:"Download PDF"})]})]}),"balance"===e7&&(0,s.jsxs)(s.Fragment,{children:[Object.keys((null==el?void 0:null===(M=el.person_a)||void 0===M?void 0:null===(C=M.chart)||void 0===C?void 0:C.transitsByDate)||{}).length>0?null:(0,s.jsx)("div",{className:"rounded-md border border-amber-700 bg-amber-900/30 p-3 text-amber-200",children:(0,s.jsx)("p",{className:"text-sm",children:"No daily series data returned. Double-check your dates, step, and inputs, then try again. If this persists, view the Raw Result (debug) below."})}),(()=>{var e,t;let l=null==el?void 0:el.woven_map;if(!(null==l?void 0:null===(t=l.hook_stack)||void 0===t?void 0:null===(e=t.hooks)||void 0===e?void 0:e.length))return null;let a=l.hook_stack.hooks||[];return(0,s.jsxs)(x,{title:"Hook Stack — Recognition Gateway",children:[(0,s.jsxs)("div",{className:"mb-3 text-sm text-slate-400",children:["Front-door UX: ",a.length," high-charge patterns from tightest aspects",l.hook_stack.tier_1_orbs>0&&" \xb7 ".concat(l.hook_stack.tier_1_orbs," Tier-1 (≤1\xb0)"),"\xb7 Coverage: ",l.hook_stack.coverage]}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:a.map((e,t)=>{var l,a;return(0,s.jsxs)("div",{className:"rounded-md border border-amber-600/30 bg-amber-900/20 p-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,s.jsx)("div",{className:"text-amber-100 font-medium leading-tight",children:e.title}),e.is_tier_1&&(0,s.jsx)("span",{className:"ml-2 inline-flex items-center rounded bg-amber-600 px-1.5 py-0.5 text-xs font-medium text-amber-100",children:"T1"})]}),(0,s.jsxs)("div",{className:"text-xs text-amber-200/70 space-y-1",children:[(0,s.jsxs)("div",{children:["Orb: ",null===(l=e.orb)||void 0===l?void 0:l.toFixed(1),"\xb0 \xb7 Intensity: ",Math.round(e.intensity)]}),(0,s.jsxs)("div",{children:[(null===(a=e.planets)||void 0===a?void 0:a.join(" "))||""," ",e.aspect_type]})]})]},t)})}),(0,s.jsx)("div",{className:"mt-3 text-xs text-slate-400",children:'Purpose: Bypass analysis → trigger "that\'s me" recognition → open depth work'})]})})(),(()=>{var e,t,l,a,i;let n=null==el?void 0:el.woven_map;if(!n)return null;let r=n.integration_factors||{},o=Array.isArray(n.time_series)?n.time_series:[],d=null===(e=o[0])||void 0===e?void 0:e.date,c=null===(t=o[o.length-1])||void 0===t?void 0:t.date;return(0,s.jsxs)(x,{title:"Woven Map (data-only)",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-300",children:"Integration Factors"}),(0,s.jsx)("div",{className:"mt-2 space-y-2",children:[{key:"fertile_field",label:"Fertile Field"},{key:"harmonic_resonance",label:"Harmonic Resonance"},{key:"expansion_lift",label:"Expansion Lift"},{key:"combustion_clarity",label:"Combustion Clarity"},{key:"liberation_release",label:"Liberation / Release"},{key:"integration",label:"Integration"}].map(e=>{var t;let{key:l,label:a}=e,i=Math.max(0,Math.min(100,Number(null!==(t=r[l])&&void 0!==t?t:0)));return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-400",children:[(0,s.jsx)("span",{children:a}),(0,s.jsxs)("span",{children:[i,"%"]})]}),(0,s.jsxs)("svg",{viewBox:"0 0 100 6",className:"h-1.5 w-full",children:[(0,s.jsx)("rect",{x:"0",y:"0",width:"100",height:"6",className:"fill-slate-700"}),(0,s.jsx)("rect",{x:"0",y:"0",width:i,height:"6",className:"fill-emerald-500"})]})]},String(l))})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-300",children:"Time Series"}),(0,s.jsxs)("div",{className:"mt-2 text-xs text-slate-400",children:["Entries: ",o.length||0,d&&c?" \xb7 ".concat(d," → ").concat(c):""]}),(0,s.jsx)("div",{className:"mt-2 max-h-40 overflow-auto rounded border border-slate-700 bg-slate-900/40 p-2",children:(0,s.jsxs)("table",{className:"w-full text-xs text-slate-300",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"text-slate-400",children:[(0,s.jsx)("th",{className:"text-left font-medium",children:"Date"}),(0,s.jsx)("th",{className:"text-right font-medium",children:"Mag"}),(0,s.jsx)("th",{className:"text-right font-medium",children:"Val"}),(0,s.jsx)("th",{className:"text-right font-medium",children:"Vol"})]})}),(0,s.jsx)("tbody",{children:o.slice(-10).map((e,t)=>{var l,a,i;return(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"py-0.5 pr-2",children:e.date}),(0,s.jsx)("td",{className:"py-0.5 text-right",children:Number(null!==(l=e.magnitude)&&void 0!==l?l:0).toFixed(2)}),(0,s.jsx)("td",{className:"py-0.5 text-right",children:Number(null!==(a=e.valence)&&void 0!==a?a:0).toFixed(2)}),(0,s.jsx)("td",{className:"py-0.5 text-right",children:Number(null!==(i=e.volatility)&&void 0!==i?i:0).toFixed(2)})]},t)})})]})})]})]}),(0,s.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-3 sm:grid-cols-4",children:[(0,s.jsxs)("div",{className:"rounded-md border border-slate-700 bg-slate-900/40 p-3 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Natal aspects (A)"}),(0,s.jsx)("div",{className:"text-lg text-slate-100",children:null!==(i=null===(a=n.natal_summary)||void 0===a?void 0:null===(l=a.major_aspects)||void 0===l?void 0:l.length)&&void 0!==i?i:0})]}),(0,s.jsxs)("div",{className:"rounded-md border border-slate-700 bg-slate-900/40 p-3 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Polarity cards (hooks)"}),(0,s.jsx)("div",{className:"text-lg text-slate-100",children:Array.isArray(n.polarity_cards)?n.polarity_cards.length:0})]}),(0,s.jsxs)("div",{className:"rounded-md border border-slate-700 bg-slate-900/40 p-3 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Report type"}),(0,s.jsx)("div",{className:"text-lg text-slate-100 capitalize",children:n.type||"solo"})]}),(0,s.jsxs)("div",{className:"rounded-md border border-slate-700 bg-slate-900/40 p-3 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Schema"}),(0,s.jsx)("div",{className:"text-xs text-slate-100",children:n.schema})]})]})]})})(),(()=>{let e=null==el?void 0:el.context;if(!(null==e?void 0:e.translocation))return null;let t=e.translocation;return(0,s.jsx)(x,{title:"Translocation Context",className:"print:hidden",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-4 text-sm text-slate-300",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Applies"}),(0,s.jsx)("div",{className:"text-slate-100",children:t.applies?"Yes":"No"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Method"}),(0,s.jsx)("div",{className:"text-slate-100",children:(()=>{let e=String(t.method||"Natal");return/^A[_ ]?local$/i.test(e)||"A_local"===e?"Person A":/^B[_ ]?local$/i.test(e)||"B_local"===e?"Person B":/^midpoint$/i.test(e)?"Person A + B":/^natal$/i.test(e)?"None (Natal Base)":e})()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"House System"}),(0,s.jsx)("div",{className:"text-slate-100",children:t.house_system||"Placidus"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"TZ"}),(0,s.jsx)("div",{className:"text-slate-100",children:t.tz||(null==D?void 0:D.timezone)||"—"})]})]})})})(),(()=>{var e,t,l,a,i,n,r,o;let d=null==el?void 0:null===(t=el.person_a)||void 0===t?void 0:null===(e=t.derived)||void 0===e?void 0:e.seismograph_summary;if(!d)return null;let c=Number(null!==(i=d.magnitude)&&void 0!==i?i:0),u=Number(null!==(n=d.valence)&&void 0!==n?n:0),m=Number(null!==(r=d.volatility)&&void 0!==r?r:0);return(0,s.jsxs)(x,{title:"Balance Meter",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[(0,s.jsxs)("span",{className:"inline-flex items-center gap-2 rounded bg-slate-700/60 px-3 py-1 text-slate-100",children:[(0,s.jsx)("span",{children:"⚡"}),(0,s.jsx)("span",{children:"Magnitude"}),(0,s.jsxs)("span",{className:"text-slate-300",children:["\xb7 ",c>=3?"Surge":c>=1?"Active":"Calm"]})]}),(0,s.jsxs)("span",{className:"inline-flex items-center gap-2 rounded bg-slate-700/60 px-3 py-1 text-slate-100",children:[(0,s.jsx)("span",{children:"\uD83C\uDF13"}),(0,s.jsx)("span",{children:"Valence"}),(0,s.jsxs)("span",{className:"text-slate-300",children:["\xb7 ",u>.5?"Supportive":u<-.5?"Challenging":"Mixed"]})]}),(0,s.jsxs)("span",{className:"inline-flex items-center gap-2 rounded bg-slate-700/60 px-3 py-1 text-slate-100",children:[(0,s.jsx)("span",{children:"\uD83D\uDD37"}),(0,s.jsx)("span",{children:"Volatility"}),(0,s.jsxs)("span",{className:"text-slate-300",children:["\xb7 ",m>=3?"Scattered":m>=1?"Variable":"Stable"]})]})]}),(()=>{var e,t;let l=(null==el?void 0:null===(t=el.person_a)||void 0===t?void 0:null===(e=t.chart)||void 0===e?void 0:e.transitsByDate)||{},a=Object.keys(l).sort();if(!a.length)return null;let i=a.map(e=>{var t,s,a,i,n,r,o,d,c;return{date:e,magnitude:Number(null!==(o=null===(s=l[e])||void 0===s?void 0:null===(t=s.seismograph)||void 0===t?void 0:t.magnitude)&&void 0!==o?o:0),valence:Number(null!==(d=null===(i=l[e])||void 0===i?void 0:null===(a=i.seismograph)||void 0===a?void 0:a.valence)&&void 0!==d?d:0),volatility:Number(null!==(c=null===(r=l[e])||void 0===r?void 0:null===(n=r.seismograph)||void 0===n?void 0:n.volatility)&&void 0!==c?c:0)}}),n="weekly"===$?(()=>{let e=[];for(let t=0;t<i.length;t+=7){let l=i.slice(t,t+7);if(!l.length)continue;let s=e=>e.reduce((e,t)=>e+t,0)/e.length,a=e=>e.reduce((e,t)=>Math.max(e,t),-1/0),n="max"===tn?a:s;e.push([{date:l[0].date,magnitude:Number(n(l.map(e=>e.magnitude)).toFixed(2)),valence:Number(n(l.map(e=>e.valence)).toFixed(2)),volatility:Number(n(l.map(e=>e.volatility)).toFixed(2))}])}return e.map(e=>e[0])})():i,r=Math.min(28,n.length),o=n.slice(-r);return(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("div",{className:"mb-1 text-[11px] text-slate-400",children:"Legend: ⚡ Magnitude \xb7 \uD83C\uDF13 Valence \xb7 \uD83D\uDD37 Volatility"}),(0,s.jsxs)("div",{className:"mb-1 flex justify-between text-[10px] text-slate-500",children:[(0,s.jsx)("span",{children:"Top ≈ 5"}),(0,s.jsx)("span",{children:"Date labels show MM-DD"})]}),(()=>{var e,t;let l=null===(e=o[0])||void 0===e?void 0:e.date,a=null===(t=o[o.length-1])||void 0===t?void 0:t.date;return l&&a?(0,s.jsxs)("div",{className:"mb-1 text-[10px] text-slate-500",children:[l," | ",a]}):null})(),(0,s.jsx)("div",{className:"flex items-end gap-2 overflow-x-auto rounded border border-slate-700 bg-slate-900/40 p-2",children:o.map((e,t)=>{let l=Math.max(0,Math.min(96,Math.round(e.magnitude/5*96))),a=Math.max(0,Math.min(96,Math.round(Math.min(5,Math.abs(e.valence))/5*96))),i=Math.max(0,Math.min(96,Math.round(e.volatility/5*96)));return(0,s.jsxs)("div",{className:"flex w-6 flex-col items-center justify-end gap-0.5",children:[(0,s.jsxs)("svg",{width:"16",height:"96",viewBox:"0 0 16 96",className:"block",children:[(0,s.jsx)("rect",{x:"0",y:96-l,width:"5",height:l,className:"fill-indigo-500 opacity-80"}),(0,s.jsx)("rect",{x:"6",y:96-a,width:"4",height:a,className:"fill-emerald-500 opacity-70"}),(0,s.jsx)("rect",{x:"11",y:96-i,width:"5",height:i,className:"fill-sky-500 opacity-70"})]}),(0,s.jsx)("div",{className:"text-[10px] text-center text-slate-400 truncate w-full",title:e.date,children:e.date.slice(5)})]},t)})})]})})(),(0,s.jsx)("div",{className:"mt-4 grid grid-cols-1 gap-3 sm:grid-cols-2 md:grid-cols-3",children:(()=>{let e=Math.min(1,Math.max(0,c/5)),t=Math.min(1,Math.max(0,m/5)),l=(Math.max(-2,Math.min(2,u))+2)/4;return[{name:"Fertile Field",hint:"Growth-friendly openings",score:.7*l+(1-t)*.3},{name:"Harmonic Resonance",hint:"Easier flow and alignment",score:.6*l+(1-t)*.4},{name:"Expansion Lift",hint:"Momentum and reach",score:.6*e+.4*l},{name:"Combustion Clarity",hint:"Honest frictions surface",score:.5*e+.5*t},{name:"Liberation / Release",hint:"Letting go, reset",score:.7*t+(1-l)*.3},{name:"Integration",hint:"Synthesis and grounding",score:(1-t)*.6+.4*l}].map((e,t)=>{let l=Math.round(100*e.score);return(0,s.jsxs)("div",{className:"rounded-md border border-slate-700 bg-slate-800/50 p-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"text-slate-100 font-medium",children:e.name}),(0,s.jsxs)("div",{className:"text-xs text-slate-400",children:[l,"%"]})]}),(0,s.jsxs)("svg",{viewBox:"0 0 100 8",className:"mt-2 h-2 w-full",children:[(0,s.jsx)("rect",{x:"0",y:"0",width:"100",height:"8",className:"fill-slate-700"}),(0,s.jsx)("rect",{x:"0",y:"0",width:l,height:"8",className:"fill-emerald-500"})]}),(0,s.jsx)("p",{className:"mt-2 text-xs text-slate-400",children:e.hint})]},t)})})()}),(0,s.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-3 sm:grid-cols-4",children:[(0,s.jsxs)("div",{className:"rounded-md border border-slate-700 bg-slate-900/40 p-3 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Magnitude"}),(0,s.jsx)("div",{className:"text-lg text-slate-100",children:c.toFixed(2)})]}),(0,s.jsxs)("div",{className:"rounded-md border border-slate-700 bg-slate-900/40 p-3 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Valence"}),(0,s.jsx)("div",{className:"text-lg text-slate-100",children:u.toFixed(2)})]}),(0,s.jsxs)("div",{className:"rounded-md border border-slate-700 bg-slate-900/40 p-3 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Volatility"}),(0,s.jsx)("div",{className:"text-lg text-slate-100",children:m.toFixed(2)})]}),(0,s.jsxs)("div",{className:"rounded-md border border-slate-700 bg-slate-900/40 p-3 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"SFD"}),(0,s.jsx)("div",{className:"text-lg text-slate-100",children:null!==(o=null==el?void 0:null===(a=el.person_a)||void 0===a?void 0:null===(l=a.sfd)||void 0===l?void 0:l.sfd)&&void 0!==o?o:"—"})]})]})]})})(),(null==el?void 0:null===(t=el.person_a)||void 0===t?void 0:null===(e=t.derived)||void 0===e?void 0:e.seismograph_summary)&&(0,s.jsx)(x,{title:"Seismograph Summary",className:"print:hidden",children:(0,s.jsx)("div",{className:"text-sm text-slate-300",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-slate-400",children:"Magnitude"}),(0,s.jsx)("p",{className:"text-slate-100",children:el.person_a.derived.seismograph_summary.magnitude})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-slate-400",children:"Valence"}),(0,s.jsx)("p",{className:"text-slate-100",children:el.person_a.derived.seismograph_summary.valence})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-slate-400",children:"Volatility"}),(0,s.jsx)("p",{className:"text-slate-100",children:el.person_a.derived.seismograph_summary.volatility})]})]})})}),(null==el?void 0:null===(o=el.person_b)||void 0===o?void 0:null===(n=o.derived)||void 0===n?void 0:n.seismograph_summary)&&(0,s.jsx)(x,{title:"Person B — Seismograph Summary",className:"print:hidden",children:(0,s.jsx)("div",{className:"text-sm text-slate-300",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-slate-400",children:"Magnitude"}),(0,s.jsx)("p",{className:"text-slate-100",children:el.person_b.derived.seismograph_summary.magnitude})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-slate-400",children:"Valence"}),(0,s.jsx)("p",{className:"text-slate-100",children:el.person_b.derived.seismograph_summary.valence})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-slate-400",children:"Volatility"}),(0,s.jsx)("p",{className:"text-slate-100",children:el.person_b.derived.seismograph_summary.volatility})]})]})})}),((null==el?void 0:el.synastry_relational_mirror)||(null==el?void 0:el.relational_mirror))&&(0,s.jsx)(x,{title:"Relational Mirror",className:"print:hidden",children:(0,s.jsxs)("div",{className:"text-sm text-slate-300 space-y-2",children:[(0,s.jsx)("p",{className:"text-slate-200 font-medium",children:"Climate"}),(0,s.jsx)("p",{className:"text-slate-300",children:(null==el?void 0:null===(h=el.synastry_relational_mirror)||void 0===h?void 0:null===(m=h.mirror_voice)||void 0===m?void 0:m.relationship_climate)||(null==el?void 0:null===(b=el.relational_mirror)||void 0===b?void 0:null===(p=b.mirror_voice)||void 0===p?void 0:p.relationship_climate)||"—"}),(0,s.jsx)("p",{className:"text-slate-200 font-medium",children:"Polarity"}),(0,s.jsx)("p",{className:"text-slate-300",children:(null==el?void 0:null===(v=el.synastry_relational_mirror)||void 0===v?void 0:null===(g=v.mirror_voice)||void 0===g?void 0:g.polarity_summary)||(null==el?void 0:null===(f=el.relational_mirror)||void 0===f?void 0:null===(N=f.mirror_voice)||void 0===N?void 0:N.polarity_summary)||"—"})]})}),(()=>{var e,t,l;let a=(null==el?void 0:null===(t=el.person_a)||void 0===t?void 0:null===(e=t.chart)||void 0===e?void 0:e.transitsByDate)||{},i=Object.keys(a).sort();if(!i.length)return null;let n=a[i[i.length-1]],r=null==n?void 0:null===(l=n.transit_table)||void 0===l?void 0:l.markdown;return r?(0,s.jsx)(x,{title:"Raw Geometry (latest day)",children:(0,s.jsx)("pre",{className:"max-h-[24rem] overflow-auto rounded bg-slate-950 p-3 text-xs text-slate-200 whitespace-pre-wrap",children:r})}):null})(),(0,s.jsx)(x,{title:"Raw Result (debug)",className:"print:hidden",children:(0,s.jsx)("pre",{className:"max-h-[28rem] overflow-auto rounded-md bg-slate-950 p-4 text-xs text-slate-200",children:JSON.stringify(el,null,2)})}),(0,s.jsx)("div",{className:"flex items-center justify-center text-sm text-slate-400 print:hidden",children:(0,s.jsxs)("span",{children:["For narrative interpretation, download your report and upload it to ",(0,s.jsx)("a",{href:"/chat",className:"text-emerald-400 hover:text-emerald-300 underline",children:"Poetic Brain"}),"."]})})]})]}),"balance"===e7&&(!Number(D.latitude)||!Number(D.longitude)||!D.timezone)&&(0,s.jsx)("div",{className:"mt-4 rounded-md border border-red-700 bg-red-900/30 p-3 text-red-200",children:(0,s.jsx)("p",{className:"text-sm",children:"Transits need current location to place houses correctly. Add a location or switch to Mirror (no transits)."})}),!D.hour&&!D.minute&&(0,s.jsx)("div",{className:"mt-4 rounded-md border border-slate-700 bg-slate-800/70 p-3 text-slate-200",children:(0,s.jsx)("p",{className:"text-sm",children:"Angles unavailable without birth time; houses suppressed."})}),e5&&(0,s.jsx)("div",{className:"fixed bottom-4 left-1/2 z-50 -translate-x-1/2 rounded-md border border-red-700 bg-red-900/80 px-4 py-2 text-sm text-red-100 shadow-lg",children:e5}),(0,s.jsxs)("p",{className:"mt-8 text-center text-xs text-slate-500 print:hidden",children:["Poetic Brain at ",(0,s.jsx)("span",{className:"font-medium text-slate-300",children:"/chat"})," is gated by Auth0 and requires login."]})]})}},5216:function(e,t,l){"use strict";function s(){return window.location.origin+"/math-brain"}l.d(t,{g:function(){return s}})},816:function(e,t,l){"use strict";function s(e,t,l){let s="balance"===e||"mirror"===e&&t,a=null==l?void 0:l.latitude,i=null==l?void 0:l.longitude,n="number"==typeof a||"string"==typeof a&&""!==a.trim()&&Number.isFinite(Number(a)),r="number"==typeof i||"string"==typeof i&&""!==i.trim()&&Number.isFinite(Number(i)),o=!!(null==l?void 0:l.timezone),d=!!l&&n&&r&&o,c="number"==typeof(null==l?void 0:l.hour)||"string"==typeof(null==l?void 0:l.hour)&&""!==l.hour,u="number"==typeof(null==l?void 0:l.minute)||"string"==typeof(null==l?void 0:l.minute)&&""!==l.minute;return{needsLoc:s,hasLoc:d,hasBirthTime:c&&u,canSubmit:!s||s&&d}}function a(e){let t=e.translocation;return t&&t.applies?{active:!0,lens:"".concat(t.current_location).concat(t.house_system?" ("+t.house_system+")":""),disclosure:"Relocation ON – Houses remapped to ".concat(t.current_location),invariants:"Planetary geometry identical; only arena (House channels) shifted"}:{active:!1,lens:(null==t?void 0:t.current_location)||"Natal Base",disclosure:"Relocation OFF – natal House mapping in effect",invariants:"Planets, signs, aspects as computed from natal coordinates"}}function i(e){if(!e)return!0;let t="number"==typeof e.hour||"string"==typeof e.hour&&""!==e.hour,l="number"==typeof e.minute||"string"==typeof e.minute&&""!==e.minute;return!(t&&l)}l.d(t,{N8:function(){return s},TG:function(){return a},jA:function(){return i}})},357:function(e,t,l){"use strict";var s,a;e.exports=(null==(s=l.g.process)?void 0:s.env)&&"object"==typeof(null==(a=l.g.process)?void 0:a.env)?l.g.process:l(8081)},8081:function(e){!function(){var t={229:function(e){var t,l,s,a=e.exports={};function i(){throw Error("setTimeout has not been defined")}function n(){throw Error("clearTimeout has not been defined")}function r(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(l){try{return t.call(null,e,0)}catch(l){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{l="function"==typeof clearTimeout?clearTimeout:n}catch(e){l=n}}();var o=[],d=!1,c=-1;function u(){d&&s&&(d=!1,s.length?o=s.concat(o):c=-1,o.length&&m())}function m(){if(!d){var e=r(u);d=!0;for(var t=o.length;t;){for(s=o,o=[];++c<t;)s&&s[c].run();c=-1,t=o.length}s=null,d=!1,function(e){if(l===clearTimeout)return clearTimeout(e);if((l===n||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}(e)}}function x(e,t){this.fun=e,this.array=t}function h(){}a.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var l=1;l<arguments.length;l++)t[l-1]=arguments[l];o.push(new x(e,t)),1!==o.length||d||r(m)},x.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=h,a.addListener=h,a.once=h,a.off=h,a.removeListener=h,a.removeAllListeners=h,a.emit=h,a.prependListener=h,a.prependOnceListener=h,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},l={};function s(e){var a=l[e];if(void 0!==a)return a.exports;var i=l[e]={exports:{}},n=!0;try{t[e](i,i.exports,s),n=!1}finally{n&&delete l[e]}return i.exports}s.ab="//";var a=s(229);e.exports=a}()}},function(e){e.O(0,[971,23,744],function(){return e(e.s=2037)}),_N_E=e.O()}]);