(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[780],{2037:function(e,t,l){Promise.resolve().then(l.bind(l,6674))},6674:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return h},dynamic:function(){return m}});var s=l(7437),a=l(2265);function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return null;let l=e.trim(),s=l.match(/^\s*(-?\d+(?:\.\d+)?)\s*[,\s]+\s*(-?\d+(?:\.\d+)?)\s*$/);if(s){let e=Number(s[1]),l=Number(s[2]);return!Number.isFinite(e)||!Number.isFinite(l)||Math.abs(e)>90||Math.abs(l)>180||t.rejectZeroZero&&0===e&&0===l?null:{lat:e,lon:l}}let a=l.replace(/[°º]/g,"\xb0").replace(/'/g,"′").replace(/"/g,"″").replace(/\s+/g," ").trim(),i=a.split(",").map(e=>e.trim()).filter(Boolean);if(2!==i.length){let e=a.split(" "),t=e.findIndex(e=>/[NS]$/i.test(e));if(t>-1&&t<e.length-1&&(i=[e.slice(0,t+1).join(" "),e.slice(t+1).join(" ")]),2!==i.length)return null}let r=n(i[0],["N","S"]),o=n(i[1],["E","W"]);return null==r||null==o||Math.abs(r)>90||Math.abs(o)>180||t.rejectZeroZero&&0===r&&0===o?null:{lat:r,lon:o}}function n(e,t){let l=e.toUpperCase().replace(/[°º]/g,"\xb0").replace(/'/g,"′").replace(/"/g,"″").replace(/[^0-9NSEW°′″\s\.\-]/g," ").replace(/\s+/g," ").trim(),s=l.match(/([NSEW])$/),a=s?s[1]:void 0,i=l.replace(/[NSEW]$/,"").trim().split(/[°′″\s]+/).filter(Boolean).map(Number);if(!i.length)return null;let n=i[0],r=i[1]||0,o=i[2]||0;if([n,r,o].some(e=>Number.isNaN(e))||r<0||r>=60||o<0||o>=60)return null;let d=Math.abs(n)+Math.abs(r)/60+Math.abs(o)/3600;return a?("S"===a||"W"===a)&&(d=-d):n<0&&(d=-d),d}function r(e,t){return Number.isFinite(e)&&Number.isFinite(t)?"".concat(e.toFixed(6),", ").concat(t.toFixed(6)):""}var o=l(5216);function d(e){let{onStateChange:t}=e,l=(0,a.useRef)(null),[s,i]=(0,a.useState)({authReady:!1,authed:!1,authEnvOk:!0,authStatus:null}),n=async()=>{try{var e;if(!l.current){console.error("Auth client not ready.");return}await (null===(e=l.current)||void 0===e?void 0:e.loginWithRedirect({authorizationParams:{redirect_uri:(0,o.g)(),connection:"google-oauth2"}}))}catch(e){console.error("Login failed",e)}};return(0,a.useEffect)(()=>{let e=!1;return async function(){try{var t,s;"function"==typeof(null===(t=window.auth0)||void 0===t?void 0:t.createAuth0Client)||"function"==typeof window.createAuth0Client||await new Promise((e,t)=>{let l=document.createElement("script");l.src="/vendor/auth0-spa-js.production.js",l.async=!0,l.onload=()=>e(),l.onerror=()=>t(Error("Failed to load Auth0 SDK")),document.head.appendChild(l)});let a=null;try{let t=await fetch("/api/auth-config",{cache:"no-store"});if(!t.ok)throw Error("Auth config failed: ".concat(t.status));if(!(null==(a=await t.json())?void 0:a.domain)||!(null==a?void 0:a.clientId)){e||i(e=>({...e,authEnvOk:!1,authReady:!0}));return}e||i(e=>({...e,authStatus:{domain:String(a.domain),clientId:String(a.clientId)},authEnvOk:!0}))}catch(t){e||i(e=>({...e,authEnvOk:!1,authReady:!0}));return}let n=(null===(s=window.auth0)||void 0===s?void 0:s.createAuth0Client)||window.createAuth0Client;if("function"!=typeof n)throw Error("Auth0 SDK not available");let r=await n({domain:String(a.domain).replace(/^https?:\/\//,""),clientId:a.clientId,authorizationParams:{redirect_uri:(0,o.g)()}});l.current=r;let d=window.location.search;if(d.includes("code=")&&d.includes("state=")){await r.handleRedirectCallback();let e=new URL(window.location.href);if(e.search="",window.history.replaceState({},"",e.toString()),await r.isAuthenticated()){window.location.replace("/chat?from=math-brain");return}}let c=await r.isAuthenticated();e||i(e=>({...e,authed:c,authReady:!0}))}catch(t){e||i(e=>({...e,authReady:!0,authEnvOk:!1}))}}(),()=>{e=!0}},[]),(0,a.useEffect)(()=>{t({...s,login:n})},[s,t]),null}var c=l(816),u=l(357);let m="force-dynamic";function x(e){let{title:t,children:l,className:a=""}=e;return(0,s.jsxs)("section",{className:"rounded-lg border border-slate-700 bg-slate-800/60 p-4 ".concat(a),children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-slate-100",children:t}),(0,s.jsx)("div",{className:"mt-3",children:l})]})}function h(){var e,t,l,n,o,m,h,p,b,g,v,N,f,y;let j="true"===u.env.NEXT_PUBLIC_ENABLE_LEGACY_LINK,S=(0,a.useMemo)(()=>new Date,[]),w=e=>e.toISOString().slice(0,10),_=w(S),A=w(new Date(S.getTime()+5184e5)),[T,k]=(0,a.useState)({name:"Dan",year:1973,month:7,day:24,hour:14,minute:30,city:"Bryn Mawr",state:"PA",latitude:40.0167,longitude:-75.3,timezone:"US/Eastern",zodiac_type:"Tropic"}),[C,R]=(0,a.useState)("40\xb01'N, 75\xb018'W"),[M,P]=(0,a.useState)(null),[F,O]=(0,a.useState)(!0),[E,D]=(0,a.useState)(_),[I,L]=(0,a.useState)(A),[B,z]=(0,a.useState)("NATAL_TRANSITS"),[Y,U]=(0,a.useState)("daily"),[H,J]=(0,a.useState)(!1),[W,q]=(0,a.useState)(null),[Z,V]=(0,a.useState)(null),[G,$]=(0,a.useState)(!0),[K,X]=(0,a.useState)({name:"",year:"",month:"",day:"",hour:"",minute:"",city:"",state:"",latitude:"",longitude:"",timezone:"",zodiac_type:"Tropic"}),[Q,ee]=(0,a.useState)(""),[et,el]=(0,a.useState)(null),[es,ea]=(0,a.useState)(!0),[ei,en]=(0,a.useState)("PARTNER"),[er,eo]=(0,a.useState)(""),[ed,ec]=(0,a.useState)(""),[eu,em]=(0,a.useState)(!1),[ex,eh]=(0,a.useState)(""),ep=(0,a.useMemo)(()=>(0,c.jA)(T),[T]),[eb,eg]=(0,a.useState)(()=>(0,c.jA)(T)?"planetary_only":"user_provided"),ev=(0,a.useMemo)(()=>(0,c.jA)(K),[K]),eN=(0,a.useMemo)(()=>ep&&"user_provided"!==eb,[ep,eb]);(0,a.useMemo)(()=>ev&&"user_provided"!==eb,[ev,eb]),(0,a.useEffect)(()=>{ep||"user_provided"===eb?ep&&"user_provided"===eb&&eg("planetary_only"):eg("user_provided")},[ep]);let ef=(0,a.useMemo)(()=>["GMT","UTC","US/Eastern","US/Central","US/Mountain","US/Pacific","US/Alaska","US/Hawaii","America/New_York","America/Chicago","America/Denver","America/Los_Angeles","America/Phoenix","America/Anchorage"],[]),ey=(0,a.useMemo)(()=>[{label:"January",value:1},{label:"February",value:2},{label:"March",value:3},{label:"April",value:4},{label:"May",value:5},{label:"June",value:6},{label:"July",value:7},{label:"August",value:8},{label:"September",value:9},{label:"October",value:10},{label:"November",value:11},{label:"December",value:12}],[]),ej=(e,t)=>e.replace(/\D+/g,"").slice(0,t),eS=e=>{let t=String(null!=e?e:"");if(!t)return"";let l=ej(t,2);return l?1===l.length?"0"+l:l:""},ew=(e,t,l)=>{let s=Number(e);return Number.isNaN(s)?NaN:Math.min(l,Math.max(t,s))},[e_,eA]=(0,a.useState)("A_LOCAL"),[eT,ek]=(0,a.useState)("30\xb010'N, 85\xb040'W"),[eC,eR]=(0,a.useState)(null),[eM,eP]=(0,a.useState)(()=>i("30\xb010'N, 85\xb040'W")),[eF,eO]=(0,a.useState)("Panama City, FL"),[eE,eD]=(0,a.useState)("US/Central"),[eI,eL]=(0,a.useState)(!1),[eB,ez]=(0,a.useState)(!1),[eY,eU]=(0,a.useState)(!0),[eH,eJ]=(0,a.useState)(null),[eW,eq]=(0,a.useState)(!0),[eZ,eV]=(0,a.useState)(null);(0,a.useRef)(null);let eG=(0,a.useRef)(null),e$=(0,a.useRef)(0),[eK,eX]=(0,a.useState)(null),[eQ,e0]=(0,a.useState)(()=>{try{let e=window.localStorage.getItem("mb.reportType");return"mirror"===e||"balance"===e?e:"mirror"}catch(e){return"mirror"}});(0,a.useEffect)(()=>{try{let e=new URL(window.location.href).searchParams.get("report");("mirror"===e||"balance"===e)&&e0(e)}catch(e){}},[]),(0,a.useEffect)(()=>{try{window.localStorage.setItem("mb.reportType",eQ)}catch(e){}},[eQ]);let[e1,e2]=(0,a.useState)(!1),[e3,e4]=(0,a.useState)(!0),[e5,e6]=(0,a.useState)(null),e7=(0,a.useRef)(null),[e9,e8]=(0,a.useState)(()=>{let e=window.localStorage.getItem("weeklyAgg");return"max"===e||"mean"===e?e:"mean"});(0,a.useEffect)(()=>{try{window.localStorage.setItem("weeklyAgg",e9)}catch(e){}},[e9]),(0,a.useEffect)(()=>{try{let e=window.localStorage.getItem("mb.lastInputs");e2(!!e)}catch(e){e2(!1)}},[]);let te=(0,a.useMemo)(()=>["SYNASTRY","SYNASTRY_TRANSITS","COMPOSITE","DUAL_NATAL_TRANSITS"],[]);function tt(){if(Z)try{var e,t;let l={createdAt:new Date().toISOString(),from:"math-brain",inputs:{mode:B,step:Y,startDate:E,endDate:I,includePersonB:G,translocation:e_,relationship:{type:ei,intimacy_tier:"PARTNER"===ei?er:void 0,role:"PARTNER"!==ei?ed:void 0,ex_estranged:"FRIEND"===ei?void 0:eu,notes:ex||void 0},personA:T,personB:K},resultPreview:{hasDaily:!!(null==Z?void 0:null===(t=Z.person_a)||void 0===t?void 0:null===(e=t.chart)||void 0===e?void 0:e.transitsByDate)}};window.localStorage.setItem("mb.lastSession",JSON.stringify(l)),window.location.href="/chat?from=math-brain"}catch(e){}}function tl(){var e,t,l,s;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"AUTO";try{let t={schema:"mb-1",mode:B,step:Y,startDate:E,endDate:I,includePersonB:G,translocation:e_,personA:T,personB:K,relationshipType:ei,relationshipTier:er,relationshipRole:ed,exEstranged:eu,relationshipNotes:ex},l=!!(G&&K&&((null===(e=K.name)||void 0===e?void 0:e.toString().trim())||null!=K.latitude||null!=K.longitude||K.timezone||K.year||K.month||K.day||K.hour||K.minute)),s="A_B"===a?G:l;"A_ONLY"!==a&&s||(delete t.personB,t.includePersonB=!1);let i=JSON.stringify(t,null,2),n=new Blob([i],{type:"application/json"}),r=new Date().toISOString().replace(/[-:]/g,"").replace(/\..+$/,""),o="A_ONLY"===a?"math_brain_setup_A_".concat(r,".json"):"math_brain_setup_".concat(r,".json"),d=window;if("function"==typeof d.showSaveFilePicker){(async()=>{try{let e=await d.showSaveFilePicker({suggestedName:o,types:[{description:"JSON files",accept:{"application/json":[".json"]}}]}),t=await e.createWritable();await t.write(n),await t.close();try{eX("Saved setup JSON"),setTimeout(()=>eX(null),1800)}catch(e){}}catch(l){let e=URL.createObjectURL(n),t=document.createElement("a");t.href=e,t.download=o,document.body.appendChild(t),t.click(),setTimeout(()=>{document.body.removeChild(t),URL.revokeObjectURL(e);try{eX("Saved setup JSON"),setTimeout(()=>eX(null),1800)}catch(e){}},150)}})();return}let c=URL.createObjectURL(n),u=document.createElement("a");u.href=c,u.download=o,document.body.appendChild(u),"download"in HTMLAnchorElement.prototype?u.click():window.open(c,"_blank","noopener"),setTimeout(()=>{try{document.body.removeChild(u)}catch(e){}try{URL.revokeObjectURL(c)}catch(e){}try{eX("Saved setup JSON"),setTimeout(()=>eX(null),1800)}catch(e){}},300)}catch(e){console.error("Save setup failed:",e);try{null===(s=navigator)||void 0===s||null===(l=s.clipboard)||void 0===l||null===(t=l.writeText)||void 0===t||t.call(l,JSON.stringify({mode:B,step:Y,startDate:E,endDate:I,includePersonB:G,translocation:e_,personA:T,personB:K},null,2)).then(()=>{eX("Saved to clipboard (download blocked)"),setTimeout(()=>eX(null),2200)}).catch(()=>{eX("Save setup failed"),setTimeout(()=>eX(null),2200)})}catch(e){}}}async function ts(e){var t,l,s,a,n;let o=null===(t=e.target.files)||void 0===t?void 0:t[0];if(o){try{let e=await o.text(),t=JSON.parse(e);e6(null);let d="object"==typeof t&&!!t&&(t.personA||t.period||t.relocation),c="object"==typeof t&&!!t&&t.personA&&(null!=t.personA.latitude||t.personA.coords),u="string"==typeof(null==t?void 0:t.schema);if(!d&&!c&&!u)throw Error("Invalid setup shape: expected .math_brain.json minimal schema or internal export.");if((d||u)&&!c){let e=t.personA||{},l=e.coords||"",s=l?i(String(l),{rejectZeroZero:!0}):null,[a,n,o]=String(e.date||"").split("-").map(e=>Number(e)),[d,c]=String(e.time||"").split(":").map(e=>Number(e));if(l&&!s)throw Error("Invalid personA.coords");let u={...T};if(e.name&&(u.name=String(e.name)),Number.isFinite(a)&&(u.year=a),Number.isFinite(n)&&(u.month=n),Number.isFinite(o)&&(u.day=o),Number.isFinite(d)&&(u.hour=d),Number.isFinite(c)&&(u.minute=c),e.timezone&&(u.timezone=String(e.timezone)),s&&(u.latitude=s.lat,u.longitude=s.lon,R(r(s.lat,s.lon)),P(null),O(!0)),t.zodiacType&&(u.zodiac_type=String(t.zodiacType)),k(u),t.personB){let e=t.personB,l=e.coords?i(String(e.coords),{rejectZeroZero:!0}):null,s={...K};e.name&&(s.name=String(e.name)),l&&(s.latitude=String(l.lat),s.longitude=String(l.lon),ee(r(l.lat,l.lon)),el(null),ea(!0)),e.timezone&&(s.timezone=String(e.timezone)),X(s),$(!0)}if(t.relationship_context){let e=t.relationship_context;e.type&&en(String(e.type).toUpperCase()),e.intimacy_tier&&eo(String(e.intimacy_tier))}if(t.period){let e=t.period;e.start&&D(String(e.start)),e.end&&L(String(e.end)),e.step&&U(String(e.step).toLowerCase())}if(t.relocation){let e=t.relocation;if(e.mode&&eA(String(e.mode)),e.coords){let t=i(String(e.coords),{rejectZeroZero:!0});t&&(eP(t),ek(String(e.coords)))}}}else t.personA&&k(t.personA),t.personB&&X(t.personB),"boolean"==typeof t.includePersonB&&$(t.includePersonB),t.mode&&z(t.mode),t.step&&U(t.step),t.startDate&&D(t.startDate),t.endDate&&L(t.endDate),"boolean"==typeof t.exEstranged&&em(t.exEstranged),"string"==typeof t.relationshipNotes&&eh(t.relationshipNotes),"string"==typeof t.relationshipTier&&eo(t.relationshipTier),"string"==typeof t.relationshipRole&&ec(t.relationshipRole),t.translocation&&eA(t.translocation),(null===(l=t.personA)||void 0===l?void 0:l.latitude)!=null&&(null===(s=t.personA)||void 0===s?void 0:s.longitude)!=null&&(R(r(Number(t.personA.latitude),Number(t.personA.longitude))),P(null),O(!0)),(null===(a=t.personB)||void 0===a?void 0:a.latitude)!=null&&(null===(n=t.personB)||void 0===n?void 0:n.longitude)!=null&&(ee(r(Number(t.personB.latitude),Number(t.personB.longitude))),el(null),ea(!0))}catch(e){}e.currentTarget.value=""}}(0,a.useEffect)(()=>{!G&&te.includes(B)&&z("NATAL_TRANSITS")},[G,B,te]),(0,a.useEffect)(()=>{if(G){var e;null===(e=eG.current)||void 0===e||e.focus()}},[G]);let ta=(0,a.useMemo)(()=>{let e=[T.name,T.city,T.state,T.timezone,T.zodiac_type],t=ep&&"user_provided"!==eb,l=[Number(T.year),Number(T.month),Number(T.day),...t?[]:[Number(T.hour),Number(T.minute)],Number(T.latitude),Number(T.longitude)],s=e.every(Boolean)&&l.every(e=>!Number.isNaN(e))&&F;if(!["SYNASTRY","SYNASTRY_TRANSITS","COMPOSITE","DUAL_NATAL_TRANSITS"].includes(B))return s&&!!E&&!!I;if(!G)return!1;let a=[K.name,K.city,K.state,K.timezone,K.zodiac_type],i=ev&&"user_provided"!==eb,n=[Number(K.year),Number(K.month),Number(K.day),...i?[]:[Number(K.hour),Number(K.minute)],Number(K.latitude),Number(K.longitude)],r=a.every(Boolean)&&n.every(e=>!Number.isNaN(e))&&es,o=!0;return"PARTNER"===ei&&(o=!!er),"FAMILY"===ei&&(o=!!ed),s&&r&&o&&!!E&&!!I},[T,K,G,ei,er,ed,B,E,I,F,es,ep,ev,eb]),ti=(0,a.useMemo)(()=>{let e=(0,c.N8)(eQ,!1,T);return"balance"===eQ&&!e.hasLoc||!ta||!!H},[ta,H,T,eQ]),tn=(0,a.useMemo)(()=>{try{return"1"===new URL(window.location.href).searchParams.get("debug")}catch(e){return!1}},[]),tr=(0,a.useMemo)(()=>({reportType:eQ,needsLocation:(0,c.N8)(eQ,!1,T),canSubmit:ta,submitDisabled:ti,authReady:eI,authed:eB,aCoordsValid:F,bCoordsValid:es,includePersonB:G,timeUnknown:ep,timeUnknownB:ev,timePolicy:eb,personA_lat_type:typeof T.latitude,personA_lon_type:typeof T.longitude}),[eQ,ta,ti,eI,eB,F,es,G,ep,ev,eb,T]);async function to(e){e.preventDefault();let t=(0,c.N8)(eQ,!1,T);if("balance"===eQ&&!t.hasLoc){eX("Transits need current location to place houses correctly. Add a location or switch to Mirror (no transits)."),setTimeout(()=>eX(null),2500);return}if(!ta)return;let l=Date.now();if(!(l-e$.current<800)){e$.current=l,"undefined"!=typeof performance&&performance.now(),J(!0),q(null),V(null);try{var s,a,i,n,r,o,d;let e={mode:B,personA:{...T,nation:"US",year:Number(T.year),month:Number(T.month),day:Number(T.day),hour:Number(T.hour),minute:Number(T.minute),latitude:Number(T.latitude),longitude:Number(T.longitude)},time_policy:ep?eb:"user_provided",transitStartDate:E,transitEndDate:I,transitStep:Y,context:{mode:"balance"===eQ?"balance_meter":"mirror"},translocation:"A_LOCAL"===e_||"B_LOCAL"===e_||"MIDPOINT"===e_?{applies:!0,method:"A_LOCAL"===e_?"A_local":"B_LOCAL"===e_?"B_local":"Midpoint",coords:eM?{latitude:eM.lat,longitude:eM.lon}:void 0,current_location:eF||void 0,tz:eE||void 0}:{applies:!1,method:"Natal"}};try{e3&&(window.localStorage.setItem("mb.lastInputs",JSON.stringify({mode:B,step:Y,startDate:E,endDate:I,includePersonB:G,translocation:e_,relationshipType:ei,relationshipTier:er,relationshipRole:ed,exEstranged:eu,relationshipNotes:ex,personA:T,personB:K})),e2(!0))}catch(e){}["SYNASTRY","SYNASTRY_TRANSITS","COMPOSITE","DUAL_NATAL_TRANSITS"].includes(B)&&G&&(e.personB={...K,nation:"US",year:Number(K.year),month:Number(K.month),day:Number(K.day),hour:Number(K.hour),minute:Number(K.minute),latitude:Number(K.latitude),longitude:Number(K.longitude)},e.relationship_context={type:ei,intimacy_tier:"PARTNER"===ei?er:void 0,role:"PARTNER"!==ei?ed:void 0,ex_estranged:"FRIEND"===ei?void 0:eu,notes:ex||void 0});let t=await fetch("/api/astrology-mathbrain",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),l=await t.json();if(!t.ok||(null==l?void 0:l.success)===!1){let e=(null==l?void 0:l.error)||"Request failed (".concat(t.status,")");throw"mirror"===eQ&&(eX("Mirror preparation failed"),setTimeout(()=>eX(null),2500)),Error(e)}V(l);try{(null==l?void 0:null===(s=l.person_a)||void 0===s?void 0:s.meta)||null==l||null===(a=l.provenance)||void 0===a||a.time_meta_a}catch(e){}try{let e=(null==l?void 0:null===(n=l.person_a)||void 0===n?void 0:null===(i=n.derived)||void 0===i?void 0:i.seismograph_summary)||{},t=Number(null!==(r=e.magnitude)&&void 0!==r?r:0),s=Number(null!==(o=e.valence)&&void 0!==o?o:0),a=Number(null!==(d=e.volatility)&&void 0!==d?d:0),c={createdAt:new Date().toISOString(),from:"math-brain",inputs:{mode:B,step:Y,startDate:E,endDate:I,includePersonB:G,translocation:e_,relationship:{type:ei,intimacy_tier:er,role:ed,ex_estranged:eu,notes:ex},personA:T,personB:K},summary:{magnitude:t,valence:s,volatility:a,magnitudeLabel:t>=3?"Surge":t>=1?"Active":"Calm",valenceLabel:s>.5?"Supportive":s<-.5?"Challenging":"Mixed",volatilityLabel:a>=3?"Scattered":a>=1?"Variable":"Stable"},woven_map:(null==l?void 0:l.woven_map)?{...l.woven_map}:void 0};window.localStorage.setItem("mb.lastSession",JSON.stringify(c))}catch(e){}}catch(e){"mirror"===eQ&&(eX("Mirror preparation failed"),setTimeout(()=>eX(null),2500)),q((null==e?void 0:e.message)||"Unexpected error")}finally{J(!1)}}}return(0,s.jsxs)("main",{className:"mx-auto max-w-6xl px-6 py-12",children:[(0,s.jsx)(d,{onStateChange:e=>{eL(e.authReady),ez(e.authed),eU(e.authEnvOk),eJ(e.authStatus),eV(()=>e.login)}}),!eY&&eW&&(0,s.jsxs)("div",{className:"mb-4 flex items-start justify-between gap-3 rounded-md border border-amber-700 bg-amber-900/30 p-3 text-amber-200",children:[(0,s.jsx)("p",{className:"text-sm",children:"Auth0 environment not configured (AUTH0_*). Sign-in is disabled; Poetic Brain gating will be unavailable."}),(0,s.jsx)("button",{type:"button",onClick:()=>eq(!1),className:"rounded-md border border-amber-700 px-2 py-1 text-xs text-amber-100 hover:bg-amber-800/50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-amber-400","aria-label":"Dismiss banner",children:"Dismiss"})]}),(0,s.jsxs)("header",{className:"text-center print:hidden",children:[(0,s.jsx)("h1",{className:"text-4xl md:text-5xl font-bold tracking-tight text-slate-100",children:"Math Brain"}),(0,s.jsx)("p",{className:"mt-4 text-base md:text-lg text-slate-300",children:"Run the geometry first. Then, once you're signed in, jump into Chat to synthesize the narrative."}),(0,s.jsxs)("div",{className:"mt-6 flex items-center justify-center gap-4 text-sm text-slate-400",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"rounded bg-amber-600 px-2 py-1 text-xs font-medium text-slate-100",children:"FIELD"}),(0,s.jsx)("span",{className:"text-xs",children:"Geometric calculation engine"})]}),(0,s.jsx)("span",{className:"text-slate-600",children:"→"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 opacity-50",children:[(0,s.jsx)("span",{className:"rounded bg-slate-700 px-2 py-1 text-xs font-medium text-slate-400",children:"MAP"}),(0,s.jsx)("span",{className:"text-xs",children:"Raven handles"})]}),(0,s.jsx)("span",{className:"text-slate-600",children:"→"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 opacity-50",children:[(0,s.jsx)("span",{className:"rounded bg-slate-700 px-2 py-1 text-xs font-medium text-slate-400",children:"VOICE"}),(0,s.jsx)("span",{className:"text-xs",children:"Raven handles"})]})]})]}),eI&&(0,s.jsx)("div",{className:"mt-3 mx-auto max-w-3xl rounded-md border border-slate-700 bg-slate-900/50 p-2 text-[12px] text-slate-300 print:hidden",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"inline-block h-2 w-2 rounded-full ".concat(eY?"bg-emerald-500":"bg-amber-500"),"aria-hidden":!0}),(0,s.jsx)("span",{className:"font-medium",children:"Auth status"}),(0,s.jsx)("span",{className:"text-slate-400",children:eY?"Configured":"Misconfigured"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-slate-400",children:[(0,s.jsxs)("div",{title:"Auth0 Domain (from /api/auth-config)",children:["Domain: ",(0,s.jsx)("span",{className:"text-slate-200",children:(null==eH?void 0:eH.domain)||"—"})]}),(0,s.jsxs)("div",{title:"Auth0 Client ID (redacted)",children:["Client: ",(0,s.jsx)("span",{className:"text-slate-200",children:(null==eH?void 0:eH.clientId)?String(eH.clientId).slice(0,4)+"…":"—"})]}),(0,s.jsxs)("div",{title:"Google connection expected to be enabled in Auth0 app",children:["Google: ",(0,s.jsx)("span",{className:"text-slate-200",children:"expected"})]})]})]})}),(0,s.jsxs)("div",{className:"mt-8 flex flex-wrap gap-3 justify-center print:hidden",children:[(0,s.jsx)("a",{href:"/",className:"rounded-md border border-slate-700 bg-slate-800 px-4 py-2 text-slate-100 hover:bg-slate-700",children:"Back Home"}),j&&(0,s.jsx)("a",{href:"/index.html",className:"rounded-md bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-500",target:"_blank",rel:"noopener noreferrer",children:"Open Legacy Math Brain"}),eI&&eB?(0,s.jsx)("a",{href:"/chat?from=math-brain",className:"rounded-md bg-emerald-600 px-4 py-2 text-white hover:bg-emerald-500",children:"Continue to Poetic Brain"}):(0,s.jsx)("button",{type:"button",onClick:()=>{eZ?eZ():q("Sign-in is disabled. Configure AUTH0_* and reload.")},disabled:!eI||!eZ,className:"rounded-md border border-slate-700 bg-slate-800 px-4 py-2 text-slate-100 hover:bg-slate-700 disabled:opacity-50",title:"Sign in to enable Poetic Brain",children:"Sign in to Continue"})]}),e1&&(0,s.jsxs)("div",{className:"mt-6 flex items-center justify-center gap-3 print:hidden",children:[(0,s.jsx)("div",{className:"rounded-md border border-slate-700 bg-slate-800/60 px-3 py-2 text-slate-200 text-sm",children:"A previous session was found."}),(0,s.jsx)("button",{type:"button",onClick:function(){try{let e=window.localStorage.getItem("mb.lastInputs");if(!e)return;let t=JSON.parse(e);t.personA&&k(t.personA),t.personB&&X(t.personB),"boolean"==typeof t.includePersonB&&$(t.includePersonB),t.mode&&z(t.mode),t.step&&U(t.step),t.startDate&&D(t.startDate),t.endDate&&L(t.endDate),t.relationshipType&&en(t.relationshipType),"boolean"==typeof t.exEstranged&&em(t.exEstranged),"string"==typeof t.relationshipNotes&&eh(t.relationshipNotes),"string"==typeof t.relationshipTier&&eo(t.relationshipTier),"string"==typeof t.relationshipRole&&ec(t.relationshipRole),t.translocation&&eA(t.translocation)}catch(e){}},className:"rounded-md bg-indigo-600 px-3 py-2 text-white hover:bg-indigo-500 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",children:"Resume inputs"}),(0,s.jsx)("button",{type:"button",onClick:function(){try{window.localStorage.removeItem("mb.lastInputs"),window.localStorage.removeItem("mb.lastSession"),e2(!1),e4(!0)}catch(e){}},className:"rounded-md border border-slate-700 bg-slate-800 px-3 py-2 text-slate-100 hover:bg-slate-700 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400",children:"Reset"})]}),(0,s.jsxs)("form",{onSubmit:to,className:"mt-10 print:hidden",children:[tn&&(0,s.jsxs)("div",{className:"mb-4 rounded-md border border-slate-600 bg-slate-900/60 p-3 text-xs text-slate-200",children:[(0,s.jsx)("div",{className:"font-medium mb-2",children:"Debug — gating state"}),(0,s.jsx)("pre",{className:"whitespace-pre-wrap break-words text-[12px]",children:JSON.stringify(tr,null,2)})]}),(0,s.jsxs)("div",{className:"mb-4 flex flex-wrap items-center justify-between gap-3 rounded-md border border-slate-700 bg-slate-900/50 p-3",children:[(0,s.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm text-slate-200",children:[(0,s.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-600 bg-slate-900 text-indigo-600 focus:ring-indigo-500",checked:e3,onChange:e=>e4(e.target.checked)}),"Save for next session"]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,s.jsxs)("div",{className:"inline-flex overflow-hidden rounded-md border border-slate-700 bg-slate-800",children:[(0,s.jsx)("button",{type:"button",onClick:()=>tl("A_ONLY"),className:"px-3 py-1.5 text-slate-100 hover:bg-slate-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400",title:"Save only Person A’s setup to JSON","aria-label":"Save only Person A setup",children:"Save A"}),(0,s.jsx)("div",{className:"h-6 w-px bg-slate-700 my-1"}),(0,s.jsx)("button",{type:"button",onClick:()=>tl("A_B"),className:"px-3 py-1.5 text-slate-100 hover:bg-slate-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400",title:"Save Person A + B (if included)","aria-label":"Save Person A and B setup",children:"Save A+B"})]}),(0,s.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=e7.current)||void 0===e?void 0:e.click()},className:"rounded-md border border-slate-700 bg-slate-800 px-3 py-1.5 text-slate-100 hover:bg-slate-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400","aria-label":"Load a setup from a JSON file",children:"Load setup…"}),(0,s.jsx)("input",{ref:e7,type:"file",accept:"application/json",onChange:ts,className:"hidden","aria-label":"Upload setup JSON file"})]}),e5&&(0,s.jsx)("div",{className:"mt-2 text-xs text-red-400",children:e5})]}),(0,s.jsxs)("section",{"aria-labelledby":"report-type-heading",className:"mb-6 rounded-lg border border-slate-700 bg-slate-800/60 p-4",children:[(0,s.jsx)("h3",{id:"report-type-heading",className:"text-sm font-medium text-slate-200",children:"Report Type"}),(0,s.jsxs)("div",{className:"mt-3 flex items-center justify-between gap-3",children:[(0,s.jsxs)("fieldset",{className:"inline-flex overflow-hidden rounded-md border border-slate-700 bg-slate-800 px-0 py-0",children:[(0,s.jsx)("legend",{className:"sr-only",children:"Choose report type"}),(0,s.jsxs)("label",{className:"px-3 py-1.5 text-sm cursor-pointer ".concat("mirror"===eQ?"bg-indigo-600 text-white":"text-slate-200 hover:bg-slate-700"),title:"Send to Poetic Brain",onClick:()=>e0("mirror"),children:[(0,s.jsx)("input",{type:"radio",name:"reportType",value:"mirror",className:"sr-only",checked:"mirror"===eQ,onChange:()=>e0("mirror")}),"Mirror",(0,s.jsx)("span",{className:"ml-1 text-[11px] text-slate-300/80",children:"(send to Poetic Brain)"})]}),(0,s.jsxs)("label",{className:"px-3 py-1.5 text-sm cursor-pointer ".concat("balance"===eQ?"bg-indigo-600 text-white":"text-slate-200 hover:bg-slate-700"),title:"Show gauges on screen",onClick:()=>e0("balance"),children:[(0,s.jsx)("input",{type:"radio",name:"reportType",value:"balance",className:"sr-only",checked:"balance"===eQ,onChange:()=>e0("balance")}),"Balance Meter",(0,s.jsx)("span",{className:"ml-1 text-[11px] text-slate-300/80",children:"(gauges on screen)"})]})]}),"mirror"===eQ&&(0,s.jsx)("div",{className:"text-xs text-slate-400",children:eI&&!eB?"Sign in to deliver Mirror to Poetic Brain":"Handoff only — no on-screen gauges"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2 items-start",children:[(0,s.jsx)(x,{title:"Person A (required)",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-name",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Name"}),(0,s.jsx)("input",{id:"a-name",placeholder:"Your Name",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-center text-slate-100 placeholder:text-slate-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:T.name,onChange:e=>k({...T,name:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{className:"grid grid-cols-5 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-year",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Year"}),(0,s.jsx)("input",{id:"a-year",type:"text",inputMode:"numeric",className:"mt-1 w-full min-w-[80px] h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:String(T.year),onChange:e=>k({...T,year:ej(e.target.value,4)}),placeholder:"YYYY",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-month",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Month"}),(0,s.jsx)("select",{id:"a-month",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-2 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 appearance-none",value:Number(T.month)||1,onChange:e=>k({...T,month:Number(e.target.value)}),required:!0,children:ey.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label.slice(0,3)},e.value))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-day",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Day"}),(0,s.jsx)("input",{id:"a-day",type:"text",inputMode:"numeric",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-center text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:eS(T.day),onChange:e=>{let t=ew(eS(e.target.value),1,31);k({...T,day:Number.isNaN(t)?"":String(t).padStart(2,"0")})},placeholder:"DD",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-hour",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Hour"}),(0,s.jsx)("input",{id:"a-hour",type:"text",inputMode:"numeric",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:eS(T.hour),onChange:e=>{let t=ew(eS(e.target.value),0,23);k({...T,hour:Number.isNaN(t)?"":String(t).padStart(2,"0")})},placeholder:"HH",required:!eN})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-minute",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Minute"}),(0,s.jsx)("input",{id:"a-minute",type:"text",inputMode:"numeric",className:"mt-1 w-full min-w-[60px] h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:eS(T.minute),onChange:e=>{let t=ew(eS(e.target.value),0,59);k({...T,minute:Number.isNaN(t)?"":String(t).padStart(2,"0")})},placeholder:"MM",required:!eN})]})]}),"            ",(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-city",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"City"}),(0,s.jsx)("input",{id:"a-city",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:T.city,onChange:e=>k({...T,city:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-state",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"State / Province"}),(0,s.jsx)("input",{id:"a-state",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:T.state,onChange:e=>k({...T,state:e.target.value}),required:!0}),(0,s.jsx)("p",{className:"mt-1 text-[11px] text-slate-500",children:"Nation assumed “US” for API compatibility."})]}),(0,s.jsxs)("div",{className:"sm:col-span-2",children:[(0,s.jsx)("label",{htmlFor:"a-coords",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Birth Coordinates"}),(0,s.jsx)("input",{id:"a-coords",type:"text",className:"mt-1 w-full rounded-md border bg-slate-900 px-3 py-2 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 ".concat(M?"border-red-600":"border-slate-600"),value:C,onChange:e=>{let t=e.target.value;R(t);let l=i(t,{rejectZeroZero:!0});l?(k({...T,latitude:l.lat,longitude:l.lon}),P(null),O(!0)):(P('Invalid coordinates. Try "40\xb042′N, 74\xb00′W" or "40.7128, -74.006".'),O(!1))},"aria-describedby":"a-coords-help",placeholder:"e.g., 40\xb042′N, 74\xb00′W or 40.7128, -74.006",required:!0}),(0,s.jsx)("p",{id:"a-coords-help",className:"mt-1 text-xs text-slate-400",children:"Examples: 40\xb042′N, 74\xb00′W \xb7 34\xb03′S, 18\xb025′E \xb7 40.7128, -74.006"}),M?(0,s.jsx)("p",{className:"mt-1 text-xs text-red-400",children:M}):(0,s.jsxs)("p",{className:"mt-1 text-xs text-slate-400",children:["Normalized: ",r(Number(T.latitude),Number(T.longitude))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-tz",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Timezone"}),(0,s.jsx)("select",{id:"a-tz",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:T.timezone,onChange:e=>k({...T,timezone:e.target.value}),required:!0,children:ef.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"a-zodiac",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Zodiac Type"}),(0,s.jsxs)("select",{id:"a-zodiac",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100",value:T.zodiac_type,onChange:e=>k({...T,zodiac_type:e.target.value}),children:[(0,s.jsx)("option",{value:"Tropic",children:"Tropic"}),(0,s.jsx)("option",{value:"Sidereal",children:"Sidereal"})]})]}),ep&&(0,s.jsx)("div",{className:"sm:col-span-2",children:(0,s.jsxs)("fieldset",{className:"rounded-md border border-slate-700 bg-slate-900/50 p-3",children:[(0,s.jsx)("legend",{className:"px-1 text-xs font-medium text-slate-200",children:"Birth time policy"}),(0,s.jsxs)("div",{className:"mt-2 grid grid-cols-1 gap-2 sm:grid-cols-3",children:[(0,s.jsxs)("label",{className:"flex cursor-pointer items-start gap-2 rounded-md border px-3 py-2 text-xs ".concat("planetary_only"===eb?"border-indigo-600 bg-indigo-900/20 text-slate-100":"border-slate-700 bg-slate-800/50 text-slate-300 hover:bg-slate-800"),children:[(0,s.jsx)("input",{type:"radio",name:"time-policy",className:"mt-0.5",checked:"planetary_only"===eb,onChange:()=>eg("planetary_only")}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:"Planetary-only"}),(0,s.jsx)("div",{className:"text-slate-400",children:"No houses/angles; tightest, falsifiable geometry"})]})]}),(0,s.jsxs)("label",{className:"flex cursor-pointer items-start gap-2 rounded-md border px-3 py-2 text-xs ".concat("whole_sign"===eb?"border-indigo-600 bg-indigo-900/20 text-slate-100":"border-slate-700 bg-slate-800/50 text-slate-300 hover:bg-slate-800"),children:[(0,s.jsx)("input",{type:"radio",name:"time-policy",className:"mt-0.5",checked:"whole_sign"===eb,onChange:()=>eg("whole_sign")}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:"Whole-sign houses"}),(0,s.jsx)("div",{className:"text-slate-400",children:"House semantics without exact time; angles still suppressed"})]})]}),(0,s.jsxs)("label",{className:"flex cursor-pointer items-start gap-2 rounded-md border px-3 py-2 text-xs ".concat("sensitivity_scan"===eb?"border-indigo-600 bg-indigo-900/20 text-slate-100":"border-slate-700 bg-slate-800/50 text-slate-300 hover:bg-slate-800"),children:[(0,s.jsx)("input",{type:"radio",name:"time-policy",className:"mt-0.5",checked:"sensitivity_scan"===eb,onChange:()=>eg("sensitivity_scan")}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:"Sensitivity scan"}),(0,s.jsx)("div",{className:"text-slate-400",children:"Test a window of possible times; house-dependent insights flagged"})]})]})]})]})})]})}),(0,s.jsxs)(x,{title:"Person B (optional for relational)",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsx)("p",{className:"text-xs text-slate-400",children:"Add a second person for synastry/composite modes."}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"inline-flex rounded-md border border-slate-700 bg-slate-800 p-1",children:[(0,s.jsx)("button",{type:"button",onClick:function(){G&&X(e=>({...e,year:String(T.year),month:String(T.month),day:String(T.day),hour:String(T.hour),minute:String(T.minute),city:T.city,state:T.state,latitude:String(T.latitude),longitude:String(T.longitude),timezone:T.timezone,zodiac_type:T.zodiac_type}))},disabled:!G,className:"px-2 py-1 text-xs text-slate-100 hover:bg-slate-700 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",title:"Copy Person A details to Person B (keeps B name)",children:"Copy A→B"}),(0,s.jsx)("div",{className:"mx-1 h-5 w-px bg-slate-700"}),(0,s.jsx)("button",{type:"button",onClick:function(){G&&(k(e=>{var t,l,s,a,i,n,r;return{...e,name:K.name||e.name,year:null!==(t=K.year)&&void 0!==t?t:e.year,month:null!==(l=K.month)&&void 0!==l?l:e.month,day:null!==(s=K.day)&&void 0!==s?s:e.day,hour:null!==(a=K.hour)&&void 0!==a?a:e.hour,minute:null!==(i=K.minute)&&void 0!==i?i:e.minute,city:K.city||e.city,state:K.state||e.state,latitude:null!==(n=K.latitude)&&void 0!==n?n:e.latitude,longitude:null!==(r=K.longitude)&&void 0!==r?r:e.longitude,timezone:K.timezone||e.timezone,zodiac_type:K.zodiac_type||e.zodiac_type}}),X(e=>({...e,year:String(T.year),month:String(T.month),day:String(T.day),hour:String(T.hour),minute:String(T.minute),city:T.city,state:T.state,latitude:String(T.latitude),longitude:String(T.longitude),timezone:T.timezone,zodiac_type:T.zodiac_type})))},disabled:!G,className:"px-2 py-1 text-xs text-slate-100 hover:bg-slate-700 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",title:"Swap A/B (relationship settings unchanged)",children:"Swap A/B"}),(0,s.jsx)("div",{className:"mx-1 h-5 w-px bg-slate-700"}),(0,s.jsx)("button",{type:"button",onClick:function(){G&&X({name:"",year:"",month:"",day:"",hour:"",minute:"",city:"",state:"",latitude:"",longitude:"",timezone:"",zodiac_type:"Tropic"})},disabled:!G,className:"px-2 py-1 text-xs text-slate-100 hover:bg-slate-700 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",title:"Clear all Person B fields",children:"Clear B"}),(0,s.jsx)("div",{className:"mx-1 h-5 w-px bg-slate-700"}),(0,s.jsx)("button",{type:"button",onClick:function(){if(!G)return;let e=new Date;X(t=>({...t,year:String(e.getUTCFullYear()),month:String(e.getUTCMonth()+1),day:String(e.getUTCDate()),hour:String(e.getUTCHours()),minute:String(e.getUTCMinutes()),timezone:"UTC",city:t.city||"",state:t.state||"",latitude:t.latitude||"",longitude:t.longitude||""}))},disabled:!G,className:"px-2 py-1 text-xs text-slate-100 hover:bg-slate-700 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",title:"Set Person B date/time to now (UTC)",children:"Set B = Now (UTC)"})]}),(0,s.jsxs)("label",{htmlFor:"toggle-include-b-a",className:"inline-flex items-center gap-2 text-sm text-slate-200 cursor-pointer",children:[(0,s.jsx)("input",{id:"toggle-include-b-a",type:"checkbox",className:"h-4 w-4 rounded border-slate-600 bg-slate-900 text-indigo-600 focus:ring-indigo-500",checked:G,onChange:e=>$(e.target.checked)}),"Include Person B"]})]})]}),(0,s.jsx)("div",{className:"mt-4 ".concat(G?"":"opacity-50"),children:(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-name",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Name"}),(0,s.jsx)("input",{id:"b-name",ref:eG,placeholder:"Their Name",disabled:!G,className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-center text-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:opacity-50",value:K.name,onChange:e=>X({...K,name:e.target.value})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-5 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-year",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Year"}),(0,s.jsx)("input",{id:"b-year",type:"text",inputMode:"numeric",disabled:!G,className:"mt-1 w-full min-w-[80px] h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:String(K.year),onChange:e=>X({...K,year:ej(e.target.value,4)}),placeholder:"YYYY"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-month",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Month"}),(0,s.jsx)("select",{id:"b-month",disabled:!G,className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 appearance-none",value:Number(K.month)||1,onChange:e=>X({...K,month:Number(e.target.value)}),children:ey.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label.slice(0,3)},e.value))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-day",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Day"}),(0,s.jsx)("input",{id:"b-day",type:"text",inputMode:"numeric",disabled:!G,className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:eS(K.day),onChange:e=>{let t=ew(eS(e.target.value),1,31);X({...K,day:Number.isNaN(t)?"":String(t).padStart(2,"0")})},placeholder:"DD"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-hour",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Hour"}),(0,s.jsx)("input",{id:"b-hour",type:"text",inputMode:"numeric",disabled:!G,className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:eS(K.hour),onChange:e=>{let t=ew(eS(e.target.value),0,23);X({...K,hour:Number.isNaN(t)?"":String(t).padStart(2,"0")})},placeholder:"HH"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-minute",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Minute"}),(0,s.jsx)("input",{id:"b-minute",type:"text",inputMode:"numeric",disabled:!G,className:"mt-1 w-full min-w-[60px] h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:eS(K.minute),onChange:e=>{let t=ew(eS(e.target.value),0,59);X({...K,minute:Number.isNaN(t)?"":String(t).padStart(2,"0")})},placeholder:"MM"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-city",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"City"}),(0,s.jsx)("input",{id:"b-city",disabled:!G,className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:K.city,onChange:e=>X({...K,city:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-state",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"State / Province"}),(0,s.jsx)("input",{id:"b-state",disabled:!G,className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:K.state,onChange:e=>X({...K,state:e.target.value})}),(0,s.jsx)("p",{className:"mt-1 text-[11px] text-slate-500",children:"Nation assumed “US” for API compatibility."})]}),(0,s.jsxs)("div",{className:"sm:col-span-2",children:[(0,s.jsx)("label",{htmlFor:"b-coords",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Birth Coordinates (B)"}),(0,s.jsx)("input",{id:"b-coords",type:"text",disabled:!G,className:"mt-1 w-full rounded-md border bg-slate-900 px-3 py-2 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 ".concat(et?"border-red-600":"border-slate-600"),value:Q,onChange:e=>{let t=e.target.value;if(ee(t),!G)return;let l=i(t,{rejectZeroZero:!0});l?(X({...K,latitude:l.lat,longitude:l.lon}),el(null),ea(!0)):(el("Invalid coordinates"),ea(!1))},placeholder:"e.g., 34\xb003′S, 18\xb025′E or -34.0500, 18.4167"}),(0,s.jsx)("p",{className:"mt-1 text-xs text-slate-400",children:"Examples: 40\xb042′N, 74\xb00′W \xb7 34\xb03′S, 18\xb025′E \xb7 40.7128, -74.006"}),(0,s.jsxs)("p",{className:"mt-1 text-xs text-slate-400",children:["Normalized: ",Number(K.latitude)||Number(K.longitude)?r(Number(K.latitude),Number(K.longitude)):"—"]}),et&&(0,s.jsx)("p",{className:"mt-1 text-xs text-red-400",children:et})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-tz",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Timezone"}),(0,s.jsx)("select",{id:"b-tz",disabled:!G,className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:K.timezone,onChange:e=>X({...K,timezone:e.target.value}),children:ef.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"b-zodiac",className:"block text-[11px] uppercase tracking-wide text-slate-300",children:"Zodiac Type"}),(0,s.jsxs)("select",{id:"b-zodiac",disabled:!G,className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 disabled:opacity-50",value:K.zodiac_type,onChange:e=>X({...K,zodiac_type:e.target.value}),children:[(0,s.jsx)("option",{value:"Tropic",children:"Tropic"}),(0,s.jsx)("option",{value:"Sidereal",children:"Sidereal"})]})]})]})})]}),(0,s.jsxs)(x,{title:"Relationship Context",children:[(0,s.jsx)("div",{className:"mb-2 flex items-center justify-between",children:(0,s.jsx)("p",{className:"text-xs text-slate-400",children:"These fields unlock when Person B is included."})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 ".concat(G?"":"opacity-50"),children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"rel-type",className:"block text-sm text-slate-300",children:"Type"}),(0,s.jsxs)("select",{id:"rel-type",disabled:!G,className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100",value:ei,onChange:e=>{en(e.target.value),eo(""),ec("")},children:[(0,s.jsx)("option",{value:"PARTNER",children:"Partner"}),(0,s.jsx)("option",{value:"FRIEND",children:"Friend / Colleague"}),(0,s.jsx)("option",{value:"FAMILY",children:"Family"})]}),(0,s.jsxs)("div",{className:"mt-2 text-[11px] text-slate-400",children:[(0,s.jsx)("div",{className:"font-medium text-slate-300",children:"Primary Relational Tiers (scope):"}),(0,s.jsx)("div",{children:"• Partner — full map access, including intimacy arcs & legacy patterns."}),(0,s.jsx)("div",{children:"• Friend / Colleague — emotional, behavioral, social dynamics; intimacy overlays de-emphasized."}),(0,s.jsx)("div",{children:"• Family — legacy patterns and behavioral overlays; sexual resonance suppressed."}),(0,s.jsx)("div",{children:"• Acquaintance — light pattern echoes only; intimacy dynamics locked."})]})]}),"PARTNER"===ei&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"rel-tier",className:"block text-sm text-slate-300",children:"Intimacy Tier"}),(0,s.jsxs)("select",{id:"rel-tier",disabled:!G,className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100",value:er,onChange:e=>eo(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"Select…"}),(0,s.jsx)("option",{value:"P1",children:"P1 — Platonic partners"}),(0,s.jsx)("option",{value:"P2",children:"P2 — Friends-with-benefits"}),(0,s.jsx)("option",{value:"P3",children:"P3 — Situationship (unclear/unstable)"}),(0,s.jsx)("option",{value:"P4",children:"P4 — Low-commitment romantic or sexual"}),(0,s.jsx)("option",{value:"P5a",children:"P5a — Committed romantic + sexual"}),(0,s.jsx)("option",{value:"P5b",children:"P5b — Committed romantic, non-sexual"})]}),G&&["SYNASTRY","SYNASTRY_TRANSITS","COMPOSITE","DUAL_NATAL_TRANSITS"].includes(B)&&!er&&(0,s.jsx)("p",{className:"mt-1 text-xs text-amber-400",children:"Partner relationships require an intimacy tier."})]}),"FAMILY"===ei&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"rel-role",className:"block text-sm text-slate-300",children:"Role"}),(0,s.jsxs)("select",{id:"rel-role",disabled:!G,className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100",value:ed,onChange:e=>ec(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"Select…"}),(0,s.jsx)("option",{value:"Parent",children:"Parent"}),(0,s.jsx)("option",{value:"Offspring",children:"Offspring"}),(0,s.jsx)("option",{value:"Sibling",children:"Sibling"}),(0,s.jsx)("option",{value:"Cousin",children:"Cousin"}),(0,s.jsx)("option",{value:"Extended",children:"Extended"}),(0,s.jsx)("option",{value:"Guardian",children:"Guardian"}),(0,s.jsx)("option",{value:"Mentor",children:"Mentor"}),(0,s.jsx)("option",{value:"Other",children:"Other"}),(0,s.jsx)("option",{value:"Custom",children:"Custom"})]}),G&&["SYNASTRY","SYNASTRY_TRANSITS","COMPOSITE","DUAL_NATAL_TRANSITS"].includes(B)&&!er&&(0,s.jsx)("p",{className:"mt-1 text-xs text-amber-400",children:"Partner relationships require an intimacy tier."})]}),"FRIEND"===ei&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"rel-role-f",className:"block text-sm text-slate-300",children:"Role (optional)"}),(0,s.jsxs)("select",{id:"rel-role-f",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100",value:ed,onChange:e=>ec(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"—"}),(0,s.jsx)("option",{value:"Acquaintance",children:"Acquaintance"}),(0,s.jsx)("option",{value:"Mentor",children:"Mentor"}),(0,s.jsx)("option",{value:"Other",children:"Other"}),(0,s.jsx)("option",{value:"Custom",children:"Custom"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{id:"rel-ex",type:"checkbox",className:"h-4 w-4 rounded border-slate-600 bg-slate-900 text-indigo-600 focus:ring-indigo-500",checked:eu,onChange:e=>em(e.target.checked),disabled:!G||"FRIEND"===ei}),(0,s.jsx)("label",{htmlFor:"rel-ex",className:"text-sm text-slate-300",children:"Ex / Estranged"})]}),(0,s.jsxs)("div",{className:"sm:col-span-2",children:[(0,s.jsx)("label",{htmlFor:"rel-notes",className:"block text-sm text-slate-300",children:"Notes"}),(0,s.jsx)("textarea",{id:"rel-notes",disabled:!G,className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",rows:3,placeholder:"Optional context (max 500 chars)",value:ex,onChange:e=>eh(e.target.value.slice(0,500))})]})]})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(x,{title:"Transits",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"t-start",className:"block text-sm text-slate-300",children:"Start Date"}),(0,s.jsx)("input",{id:"t-start",type:"date",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:E,onChange:e=>D(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"t-end",className:"block text-sm text-slate-300",children:"End Date"}),(0,s.jsx)("input",{id:"t-end",type:"date",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:I,onChange:e=>L(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"t-step",className:"block text-sm text-slate-300",children:"Step"}),(0,s.jsxs)("select",{id:"t-step",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:Y,onChange:e=>U(e.target.value),children:[(0,s.jsx)("option",{value:"daily",children:"Daily"}),(0,s.jsx)("option",{value:"weekly",children:"Weekly"}),(0,s.jsx)("option",{value:"monthly",children:"Monthly"})]})]})]}),(0,s.jsxs)("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"t-mode",className:"block text-sm text-slate-300",children:"Mode"}),(0,s.jsxs)("select",{id:"t-mode",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:B,onChange:e=>{let t=e.target.value;z(t),["SYNASTRY","SYNASTRY_TRANSITS","COMPOSITE","DUAL_NATAL_TRANSITS"].includes(t)&&$(!0)},children:[(0,s.jsx)("option",{value:"NATAL_ONLY",children:"Natal only"}),(0,s.jsx)("option",{value:"NATAL_TRANSITS",children:"Natal + Transits"}),(0,s.jsx)("option",{value:"DUAL_NATAL_TRANSITS",children:"Dual Natal + Transits (A & B, no synastry)"}),(0,s.jsx)("option",{value:"SYNASTRY",children:"Synastry (A ↔ B)"}),(0,s.jsx)("option",{value:"SYNASTRY_TRANSITS",children:"Synastry + Transits"}),(0,s.jsx)("option",{value:"COMPOSITE",children:"Composite (midpoint) + Relational Mirror"})]}),!G&&(0,s.jsx)("p",{className:"mt-1 text-xs text-amber-400",children:"Selecting a relational mode will enable “Include Person B”."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"t-reloc",className:"block text-sm text-slate-300",children:"Relocation (angles/houses)"}),(0,s.jsxs)("select",{id:"t-reloc",className:"mt-1 w-full rounded-md border border-slate-600 bg-slate-900 px-3 py-2 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:e_,onChange:e=>eA(e.target.value),children:[(0,s.jsx)("option",{value:"NONE",children:"None (Natal Base)"}),(0,s.jsx)("option",{value:"A_LOCAL",children:"Person A"}),(0,s.jsx)("option",{value:"B_LOCAL",disabled:!G,children:"Person B"}),(0,s.jsx)("option",{value:"MIDPOINT",disabled:!G,children:"Midpoint (A + B)"})]}),(0,s.jsx)("p",{className:"mt-1 text-xs text-slate-400",children:"Clinical toggle only; no narrative. If not applied, angles/houses remain natal."}),(0,s.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"Note: Midpoint here relocates houses to the geographic midpoint; Composite mode above creates the midpoint chart."}),"NONE"!==e_?(0,s.jsxs)("div",{className:"mt-4 inline-flex items-center gap-2 rounded-full border border-emerald-700 bg-emerald-900/30 px-3 py-1 text-xs text-emerald-200",children:[(0,s.jsx)("span",{className:"inline-block h-1.5 w-1.5 rounded-full bg-emerald-400","aria-hidden":!0}),(0,s.jsx)("span",{className:"font-medium",children:"Relocated to:"}),(0,s.jsx)("span",{className:"text-emerald-100",children:eF||"Custom"}),(0,s.jsxs)("span",{className:"text-emerald-300",children:["(",eE||T.timezone||"—",")"]})]}):null]})]}),"NONE"!==e_&&(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("label",{htmlFor:"t-reloc-coords",className:"block text-sm text-slate-300",children:"Relocation Coordinates"}),(0,s.jsx)("input",{id:"t-reloc-coords",type:"text",className:"mt-1 w-full h-10 rounded-md border bg-slate-900 px-3 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 ".concat(eC?"border-red-600":"border-slate-600"),value:eT,onChange:e=>{let t=e.target.value;ek(t);let l=i(t,{rejectZeroZero:!0});l?(eP(l),eR(null)):(eP(null),eR("Invalid coordinates"))},placeholder:"e.g., 30\xb010′N, 85\xb040′W"}),(0,s.jsxs)("p",{className:"mt-1 text-xs text-slate-400",children:["Default: 30\xb010′N, 85\xb040′W \xb7 Normalized: ",eM?r(eM.lat,eM.lon):"—"]}),eC&&(0,s.jsx)("p",{className:"mt-1 text-xs text-red-400",children:eC}),(0,s.jsxs)("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"t-reloc-label",className:"block text-sm text-slate-300",children:"Relocation Label"}),(0,s.jsx)("input",{id:"t-reloc-label",type:"text",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:eF,onChange:e=>eO(e.target.value),placeholder:"e.g., Panama City, FL"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"t-reloc-tz",className:"block text-sm text-slate-300",children:"Relocation Timezone"}),(0,s.jsx)("select",{id:"t-reloc-tz",className:"mt-1 w-full h-10 rounded-md border border-slate-600 bg-slate-900 px-3 text-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",value:eE,onChange:e=>eD(e.target.value),children:ef.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]})]})]}),"weekly"===Y&&(0,s.jsxs)("div",{className:"mt-2 flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-xs text-slate-400",children:"Weekly aggregation"}),(0,s.jsx)("button",{type:"button",className:"h-5 w-5 rounded-full border border-slate-600 text-[11px] text-slate-300 hover:bg-slate-700/60 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500",title:"Mean = average of daily values per week; Max = highest daily value per week","aria-label":"Help: Weekly aggregation semantics",children:"?"}),(0,s.jsxs)("div",{role:"group","aria-label":"Weekly aggregation",className:"inline-flex overflow-hidden rounded-md border border-slate-700 bg-slate-800",children:[(0,s.jsx)("button",{type:"button",onClick:()=>e8("mean"),className:"px-3 py-1 text-xs ".concat("mean"===e9?"bg-indigo-600 text-white":"text-slate-200 hover:bg-slate-700"," focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500"),children:"Mean"}),(0,s.jsx)("button",{type:"button",onClick:()=>e8("max"),className:"px-3 py-1 text-xs ".concat("max"===e9?"bg-indigo-600 text-white":"text-slate-200 hover:bg-slate-700"," focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500"),children:"Max"})]})]}),"NONE"!==e_&&(0,s.jsxs)("div",{className:"mt-3 inline-flex items-center gap-2 rounded-full border border-emerald-700 bg-emerald-900/30 px-3 py-1 text-xs text-emerald-200",children:[(0,s.jsx)("span",{className:"inline-block h-1.5 w-1.5 rounded-full bg-emerald-400","aria-hidden":!0}),(0,s.jsx)("span",{className:"font-medium",children:"Relocated to:"}),(0,s.jsx)("span",{className:"text-emerald-100",children:eF||"—"}),(0,s.jsx)("span",{className:"text-emerald-300",children:eE||T.timezone||"—"})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"All processing is geometry-first and non-deterministic. Your data isn’t stored."}),(0,s.jsxs)("div",{className:"mr-2 hidden sm:flex items-center gap-2 text-[11px] text-slate-400",children:[(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 rounded-full border border-slate-700 bg-slate-800 px-2 py-0.5",children:[(0,s.jsx)("span",{className:"text-slate-300",children:"Mode:"}),(0,s.jsx)("span",{className:"text-slate-100",children:B.replace(/_/g," ")})]}),(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 rounded-full border border-slate-700 bg-slate-800 px-2 py-0.5",children:[(0,s.jsx)("span",{className:"text-slate-300",children:"Report:"}),(0,s.jsx)("span",{className:"text-slate-100 capitalize",children:eQ})]})]}),(0,s.jsx)("button",{type:"submit",disabled:ti,className:"inline-flex items-center rounded-md px-4 py-2 text-white disabled:opacity-50 bg-indigo-600 hover:bg-indigo-500",children:H?"Mapping geometry…":"balance"===eQ?"Generate Report":"Prepare Mirror"})]}),["SYNASTRY","SYNASTRY_TRANSITS","COMPOSITE","DUAL_NATAL_TRANSITS"].includes(B)&&!G&&(0,s.jsx)("p",{className:"mt-2 text-xs text-amber-400",children:"Hint: Toggle “Include Person B” and fill in required fields to enable relational modes."})]})]})]}),W&&(0,s.jsxs)("div",{className:"mt-6 rounded-md border border-red-700 bg-red-900/30 p-4 text-red-200",children:[(0,s.jsx)("p",{className:"font-medium",children:"Error"}),(0,s.jsx)("p",{className:"mt-1 text-sm",children:W})]}),H&&(0,s.jsxs)("div",{className:"mt-8 grid grid-cols-1 gap-6 print:hidden",children:[(0,s.jsxs)("section",{className:"rounded-lg border border-slate-700 bg-slate-800/60 p-4",children:[(0,s.jsx)("div",{className:"h-5 w-40 rounded bg-slate-700 animate-pulse"}),(0,s.jsxs)("div",{className:"mt-4 grid grid-cols-3 gap-3",children:[(0,s.jsx)("div",{className:"h-16 rounded bg-slate-700/70 animate-pulse"}),(0,s.jsx)("div",{className:"h-16 rounded bg-slate-700/70 animate-pulse"}),(0,s.jsx)("div",{className:"h-16 rounded bg-slate-700/70 animate-pulse"})]})]}),(0,s.jsxs)("section",{className:"rounded-lg border border-slate-700 bg-slate-800/60 p-4",children:[(0,s.jsx)("div",{className:"h-5 w-56 rounded bg-slate-700 animate-pulse"}),(0,s.jsx)("div",{className:"mt-4 h-24 rounded bg-slate-700/60 animate-pulse"})]})]}),Z&&(0,s.jsxs)("div",{className:"mt-8 grid grid-cols-1 gap-6",children:[(()=>{var e,t;let l=(null==Z?void 0:null===(e=Z.person_a)||void 0===e?void 0:e.meta)||(null==Z?void 0:null===(t=Z.provenance)||void 0===t?void 0:t.time_meta_a);if(!l)return null;let a=!!l.houses_suppressed,i=String(l.time_precision||""),n=l.effective_time_used;return(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[a&&(0,s.jsx)("div",{className:"rounded-md border border-slate-700 bg-slate-800/70 px-3 py-1 text-xs text-slate-200",children:"Angles unavailable without birth time; houses suppressed."}),n&&(0,s.jsxs)("div",{className:"inline-flex items-center gap-2 rounded-full border border-emerald-700 bg-emerald-900/30 px-3 py-1 text-xs text-emerald-200",children:[(0,s.jsx)("span",{className:"inline-block h-1.5 w-1.5 rounded-full bg-emerald-400","aria-hidden":!0}),(0,s.jsx)("span",{className:"font-medium",children:"Effective time"}),(0,s.jsx)("span",{className:"text-emerald-100",children:n})]}),"unknown"===i&&"planetary_only"===eb&&(0,s.jsx)("div",{className:"rounded-md border border-amber-700 bg-amber-900/30 px-3 py-1 text-xs text-amber-200",children:"Using planetary-only mode. You can run a sensitivity scan for house-dependent work."})]})})(),(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2 print:hidden",children:[(0,s.jsx)("button",{type:"button",onClick:function(){if(Z)try{let e=new Blob([JSON.stringify(Z,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),l=document.createElement("a"),s=new Date().toISOString().slice(0,10).replace(/-/g,"");l.href=t,l.download="math-brain-result-".concat(s,".json"),document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(t);try{eX("Downloading result JSON"),setTimeout(()=>eX(null),1400)}catch(e){}}catch(e){}},className:"rounded-md border border-slate-700 bg-slate-800 px-3 py-1.5 text-slate-100 hover:bg-slate-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400","aria-label":"Download result JSON",children:"Download JSON"}),(0,s.jsx)("button",{type:"button",onClick:function(){!function(){try{window.print()}catch(e){}}()},className:"rounded-md border border-slate-700 bg-slate-800 px-3 py-1.5 text-slate-100 hover:bg-slate-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400","aria-label":"Download result PDF",children:"Download PDF"}),(0,s.jsx)("button",{type:"button",onClick:tt,disabled:!eI||!eB,title:eI&&eB?void 0:"Sign in to continue","aria-label":eI&&eB?"Talk to Raven Calder":"Talk to Raven Calder (sign in to continue)",className:"rounded-md px-3 py-1.5 text-white focus-visible:outline-none focus-visible:ring-2 ".concat(eI&&eB?"bg-emerald-600 hover:bg-emerald-500 focus-visible:ring-emerald-400":"bg-emerald-700/60 cursor-not-allowed opacity-60"),children:"Talk to Raven Calder →"})]}),"balance"===eQ&&(0,s.jsxs)(s.Fragment,{children:[Object.keys((null==Z?void 0:null===(y=Z.person_a)||void 0===y?void 0:null===(f=y.chart)||void 0===f?void 0:f.transitsByDate)||{}).length>0?null:(0,s.jsx)("div",{className:"rounded-md border border-amber-700 bg-amber-900/30 p-3 text-amber-200",children:(0,s.jsx)("p",{className:"text-sm",children:"No daily series data returned. Double-check your dates, step, and inputs, then try again. If this persists, view the Raw Result (debug) below."})}),(()=>{var e,t;let l=null==Z?void 0:Z.woven_map;if(!(null==l?void 0:null===(t=l.hook_stack)||void 0===t?void 0:null===(e=t.hooks)||void 0===e?void 0:e.length))return null;let a=l.hook_stack.hooks||[];return(0,s.jsxs)(x,{title:"Hook Stack — Recognition Gateway",children:[(0,s.jsxs)("div",{className:"mb-3 text-sm text-slate-400",children:["Front-door UX: ",a.length," high-charge patterns from tightest aspects",l.hook_stack.tier_1_orbs>0&&" \xb7 ".concat(l.hook_stack.tier_1_orbs," Tier-1 (≤1\xb0)"),"\xb7 Coverage: ",l.hook_stack.coverage]}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:a.map((e,t)=>{var l,a;return(0,s.jsxs)("div",{className:"rounded-md border border-amber-600/30 bg-amber-900/20 p-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,s.jsx)("div",{className:"text-amber-100 font-medium leading-tight",children:e.title}),e.is_tier_1&&(0,s.jsx)("span",{className:"ml-2 inline-flex items-center rounded bg-amber-600 px-1.5 py-0.5 text-xs font-medium text-amber-100",children:"T1"})]}),(0,s.jsxs)("div",{className:"text-xs text-amber-200/70 space-y-1",children:[(0,s.jsxs)("div",{children:["Orb: ",null===(l=e.orb)||void 0===l?void 0:l.toFixed(1),"\xb0 \xb7 Intensity: ",Math.round(e.intensity)]}),(0,s.jsxs)("div",{children:[(null===(a=e.planets)||void 0===a?void 0:a.join(" "))||""," ",e.aspect_type]})]})]},t)})}),(0,s.jsx)("div",{className:"mt-3 text-xs text-slate-400",children:'Purpose: Bypass analysis → trigger "that\'s me" recognition → open depth work'})]})})(),(()=>{var e,t,l,a,i;let n=null==Z?void 0:Z.woven_map;if(!n)return null;let r=n.integration_factors||{},o=Array.isArray(n.time_series)?n.time_series:[],d=null===(e=o[0])||void 0===e?void 0:e.date,c=null===(t=o[o.length-1])||void 0===t?void 0:t.date;return(0,s.jsxs)(x,{title:"Woven Map (data-only)",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-300",children:"Integration Factors"}),(0,s.jsx)("div",{className:"mt-2 space-y-2",children:[{key:"fertile_field",label:"Fertile Field"},{key:"harmonic_resonance",label:"Harmonic Resonance"},{key:"expansion_lift",label:"Expansion Lift"},{key:"combustion_clarity",label:"Combustion Clarity"},{key:"liberation_release",label:"Liberation / Release"},{key:"integration",label:"Integration"}].map(e=>{var t;let{key:l,label:a}=e,i=Math.max(0,Math.min(100,Number(null!==(t=r[l])&&void 0!==t?t:0)));return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-400",children:[(0,s.jsx)("span",{children:a}),(0,s.jsxs)("span",{children:[i,"%"]})]}),(0,s.jsxs)("svg",{viewBox:"0 0 100 6",className:"h-1.5 w-full",children:[(0,s.jsx)("rect",{x:"0",y:"0",width:"100",height:"6",className:"fill-slate-700"}),(0,s.jsx)("rect",{x:"0",y:"0",width:i,height:"6",className:"fill-emerald-500"})]})]},String(l))})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-300",children:"Time Series"}),(0,s.jsxs)("div",{className:"mt-2 text-xs text-slate-400",children:["Entries: ",o.length||0,d&&c?" \xb7 ".concat(d," → ").concat(c):""]}),(0,s.jsx)("div",{className:"mt-2 max-h-40 overflow-auto rounded border border-slate-700 bg-slate-900/40 p-2",children:(0,s.jsxs)("table",{className:"w-full text-xs text-slate-300",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"text-slate-400",children:[(0,s.jsx)("th",{className:"text-left font-medium",children:"Date"}),(0,s.jsx)("th",{className:"text-right font-medium",children:"Mag"}),(0,s.jsx)("th",{className:"text-right font-medium",children:"Val"}),(0,s.jsx)("th",{className:"text-right font-medium",children:"Vol"})]})}),(0,s.jsx)("tbody",{children:o.slice(-10).map((e,t)=>{var l,a,i;return(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"py-0.5 pr-2",children:e.date}),(0,s.jsx)("td",{className:"py-0.5 text-right",children:Number(null!==(l=e.magnitude)&&void 0!==l?l:0).toFixed(2)}),(0,s.jsx)("td",{className:"py-0.5 text-right",children:Number(null!==(a=e.valence)&&void 0!==a?a:0).toFixed(2)}),(0,s.jsx)("td",{className:"py-0.5 text-right",children:Number(null!==(i=e.volatility)&&void 0!==i?i:0).toFixed(2)})]},t)})})]})})]})]}),(0,s.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-3 sm:grid-cols-4",children:[(0,s.jsxs)("div",{className:"rounded-md border border-slate-700 bg-slate-900/40 p-3 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Natal aspects (A)"}),(0,s.jsx)("div",{className:"text-lg text-slate-100",children:null!==(i=null===(a=n.natal_summary)||void 0===a?void 0:null===(l=a.major_aspects)||void 0===l?void 0:l.length)&&void 0!==i?i:0})]}),(0,s.jsxs)("div",{className:"rounded-md border border-slate-700 bg-slate-900/40 p-3 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Polarity cards (hooks)"}),(0,s.jsx)("div",{className:"text-lg text-slate-100",children:Array.isArray(n.polarity_cards)?n.polarity_cards.length:0})]}),(0,s.jsxs)("div",{className:"rounded-md border border-slate-700 bg-slate-900/40 p-3 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Report type"}),(0,s.jsx)("div",{className:"text-lg text-slate-100 capitalize",children:n.type||"solo"})]}),(0,s.jsxs)("div",{className:"rounded-md border border-slate-700 bg-slate-900/40 p-3 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Schema"}),(0,s.jsx)("div",{className:"text-xs text-slate-100",children:n.schema})]})]})]})})(),(()=>{let e=null==Z?void 0:Z.context;if(!(null==e?void 0:e.translocation))return null;let t=e.translocation;return(0,s.jsx)(x,{title:"Translocation Context",className:"print:hidden",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-4 text-sm text-slate-300",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Applies"}),(0,s.jsx)("div",{className:"text-slate-100",children:t.applies?"Yes":"No"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Method"}),(0,s.jsx)("div",{className:"text-slate-100",children:(()=>{let e=String(t.method||"Natal");return/^A[_ ]?local$/i.test(e)||"A_local"===e?"Person A":/^B[_ ]?local$/i.test(e)||"B_local"===e?"Person B":/^midpoint$/i.test(e)?"Person A + B":/^natal$/i.test(e)?"None (Natal Base)":e})()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"House System"}),(0,s.jsx)("div",{className:"text-slate-100",children:t.house_system||"Placidus"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"TZ"}),(0,s.jsx)("div",{className:"text-slate-100",children:t.tz||(null==T?void 0:T.timezone)||"—"})]})]})})})(),(()=>{var e,t,l,a,i,n,r,o;let d=null==Z?void 0:null===(t=Z.person_a)||void 0===t?void 0:null===(e=t.derived)||void 0===e?void 0:e.seismograph_summary;if(!d)return null;let c=Number(null!==(i=d.magnitude)&&void 0!==i?i:0),u=Number(null!==(n=d.valence)&&void 0!==n?n:0),m=Number(null!==(r=d.volatility)&&void 0!==r?r:0);return(0,s.jsxs)(x,{title:"Balance Meter",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[(0,s.jsxs)("span",{className:"inline-flex items-center gap-2 rounded bg-slate-700/60 px-3 py-1 text-slate-100",children:[(0,s.jsx)("span",{children:"⚡"}),(0,s.jsx)("span",{children:"Magnitude"}),(0,s.jsxs)("span",{className:"text-slate-300",children:["\xb7 ",c>=3?"Surge":c>=1?"Active":"Calm"]})]}),(0,s.jsxs)("span",{className:"inline-flex items-center gap-2 rounded bg-slate-700/60 px-3 py-1 text-slate-100",children:[(0,s.jsx)("span",{children:"\uD83C\uDF13"}),(0,s.jsx)("span",{children:"Valence"}),(0,s.jsxs)("span",{className:"text-slate-300",children:["\xb7 ",u>.5?"Supportive":u<-.5?"Challenging":"Mixed"]})]}),(0,s.jsxs)("span",{className:"inline-flex items-center gap-2 rounded bg-slate-700/60 px-3 py-1 text-slate-100",children:[(0,s.jsx)("span",{children:"\uD83D\uDD37"}),(0,s.jsx)("span",{children:"Volatility"}),(0,s.jsxs)("span",{className:"text-slate-300",children:["\xb7 ",m>=3?"Scattered":m>=1?"Variable":"Stable"]})]})]}),(()=>{var e,t;let l=(null==Z?void 0:null===(t=Z.person_a)||void 0===t?void 0:null===(e=t.chart)||void 0===e?void 0:e.transitsByDate)||{},a=Object.keys(l).sort();if(!a.length)return null;let i=a.map(e=>{var t,s,a,i,n,r,o,d,c;return{date:e,magnitude:Number(null!==(o=null===(s=l[e])||void 0===s?void 0:null===(t=s.seismograph)||void 0===t?void 0:t.magnitude)&&void 0!==o?o:0),valence:Number(null!==(d=null===(i=l[e])||void 0===i?void 0:null===(a=i.seismograph)||void 0===a?void 0:a.valence)&&void 0!==d?d:0),volatility:Number(null!==(c=null===(r=l[e])||void 0===r?void 0:null===(n=r.seismograph)||void 0===n?void 0:n.volatility)&&void 0!==c?c:0)}}),n="weekly"===Y?(()=>{let e=[];for(let t=0;t<i.length;t+=7){let l=i.slice(t,t+7);if(!l.length)continue;let s=e=>e.reduce((e,t)=>e+t,0)/e.length,a=e=>e.reduce((e,t)=>Math.max(e,t),-1/0),n="max"===e9?a:s;e.push([{date:l[0].date,magnitude:Number(n(l.map(e=>e.magnitude)).toFixed(2)),valence:Number(n(l.map(e=>e.valence)).toFixed(2)),volatility:Number(n(l.map(e=>e.volatility)).toFixed(2))}])}return e.map(e=>e[0])})():i,r=Math.min(28,n.length),o=n.slice(-r);return(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("div",{className:"mb-1 text-[11px] text-slate-400",children:"Legend: ⚡ Magnitude \xb7 \uD83C\uDF13 Valence \xb7 \uD83D\uDD37 Volatility"}),(0,s.jsxs)("div",{className:"mb-1 flex justify-between text-[10px] text-slate-500",children:[(0,s.jsx)("span",{children:"Top ≈ 5"}),(0,s.jsx)("span",{children:"Date labels show MM-DD"})]}),(()=>{var e,t;let l=null===(e=o[0])||void 0===e?void 0:e.date,a=null===(t=o[o.length-1])||void 0===t?void 0:t.date;return l&&a?(0,s.jsxs)("div",{className:"mb-1 text-[10px] text-slate-500",children:[l," | ",a]}):null})(),(0,s.jsx)("div",{className:"flex items-end gap-2 overflow-x-auto rounded border border-slate-700 bg-slate-900/40 p-2",children:o.map((e,t)=>{let l=Math.max(0,Math.min(96,Math.round(e.magnitude/5*96))),a=Math.max(0,Math.min(96,Math.round(Math.min(5,Math.abs(e.valence))/5*96))),i=Math.max(0,Math.min(96,Math.round(e.volatility/5*96)));return(0,s.jsxs)("div",{className:"flex w-6 flex-col items-center justify-end gap-0.5",children:[(0,s.jsxs)("svg",{width:"16",height:"96",viewBox:"0 0 16 96",className:"block",children:[(0,s.jsx)("rect",{x:"0",y:96-l,width:"5",height:l,className:"fill-indigo-500 opacity-80"}),(0,s.jsx)("rect",{x:"6",y:96-a,width:"4",height:a,className:"fill-emerald-500 opacity-70"}),(0,s.jsx)("rect",{x:"11",y:96-i,width:"5",height:i,className:"fill-sky-500 opacity-70"})]}),(0,s.jsx)("div",{className:"text-[10px] text-center text-slate-400 truncate w-full",title:e.date,children:e.date.slice(5)})]},t)})})]})})(),(0,s.jsx)("div",{className:"mt-4 grid grid-cols-1 gap-3 sm:grid-cols-2 md:grid-cols-3",children:(()=>{let e=Math.min(1,Math.max(0,c/5)),t=Math.min(1,Math.max(0,m/5)),l=(Math.max(-2,Math.min(2,u))+2)/4;return[{name:"Fertile Field",hint:"Growth-friendly openings",score:.7*l+(1-t)*.3},{name:"Harmonic Resonance",hint:"Easier flow and alignment",score:.6*l+(1-t)*.4},{name:"Expansion Lift",hint:"Momentum and reach",score:.6*e+.4*l},{name:"Combustion Clarity",hint:"Honest frictions surface",score:.5*e+.5*t},{name:"Liberation / Release",hint:"Letting go, reset",score:.7*t+(1-l)*.3},{name:"Integration",hint:"Synthesis and grounding",score:(1-t)*.6+.4*l}].map((e,t)=>{let l=Math.round(100*e.score);return(0,s.jsxs)("div",{className:"rounded-md border border-slate-700 bg-slate-800/50 p-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"text-slate-100 font-medium",children:e.name}),(0,s.jsxs)("div",{className:"text-xs text-slate-400",children:[l,"%"]})]}),(0,s.jsxs)("svg",{viewBox:"0 0 100 8",className:"mt-2 h-2 w-full",children:[(0,s.jsx)("rect",{x:"0",y:"0",width:"100",height:"8",className:"fill-slate-700"}),(0,s.jsx)("rect",{x:"0",y:"0",width:l,height:"8",className:"fill-emerald-500"})]}),(0,s.jsx)("p",{className:"mt-2 text-xs text-slate-400",children:e.hint})]},t)})})()}),(0,s.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-3 sm:grid-cols-4",children:[(0,s.jsxs)("div",{className:"rounded-md border border-slate-700 bg-slate-900/40 p-3 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Magnitude"}),(0,s.jsx)("div",{className:"text-lg text-slate-100",children:c.toFixed(2)})]}),(0,s.jsxs)("div",{className:"rounded-md border border-slate-700 bg-slate-900/40 p-3 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Valence"}),(0,s.jsx)("div",{className:"text-lg text-slate-100",children:u.toFixed(2)})]}),(0,s.jsxs)("div",{className:"rounded-md border border-slate-700 bg-slate-900/40 p-3 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Volatility"}),(0,s.jsx)("div",{className:"text-lg text-slate-100",children:m.toFixed(2)})]}),(0,s.jsxs)("div",{className:"rounded-md border border-slate-700 bg-slate-900/40 p-3 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"SFD"}),(0,s.jsx)("div",{className:"text-lg text-slate-100",children:null!==(o=null==Z?void 0:null===(a=Z.person_a)||void 0===a?void 0:null===(l=a.sfd)||void 0===l?void 0:l.sfd)&&void 0!==o?o:"—"})]})]})]})})(),(null==Z?void 0:null===(t=Z.person_a)||void 0===t?void 0:null===(e=t.derived)||void 0===e?void 0:e.seismograph_summary)&&(0,s.jsx)(x,{title:"Seismograph Summary",className:"print:hidden",children:(0,s.jsx)("div",{className:"text-sm text-slate-300",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-slate-400",children:"Magnitude"}),(0,s.jsx)("p",{className:"text-slate-100",children:Z.person_a.derived.seismograph_summary.magnitude})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-slate-400",children:"Valence"}),(0,s.jsx)("p",{className:"text-slate-100",children:Z.person_a.derived.seismograph_summary.valence})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-slate-400",children:"Volatility"}),(0,s.jsx)("p",{className:"text-slate-100",children:Z.person_a.derived.seismograph_summary.volatility})]})]})})}),(null==Z?void 0:null===(n=Z.person_b)||void 0===n?void 0:null===(l=n.derived)||void 0===l?void 0:l.seismograph_summary)&&(0,s.jsx)(x,{title:"Person B — Seismograph Summary",className:"print:hidden",children:(0,s.jsx)("div",{className:"text-sm text-slate-300",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-slate-400",children:"Magnitude"}),(0,s.jsx)("p",{className:"text-slate-100",children:Z.person_b.derived.seismograph_summary.magnitude})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-slate-400",children:"Valence"}),(0,s.jsx)("p",{className:"text-slate-100",children:Z.person_b.derived.seismograph_summary.valence})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-slate-400",children:"Volatility"}),(0,s.jsx)("p",{className:"text-slate-100",children:Z.person_b.derived.seismograph_summary.volatility})]})]})})}),((null==Z?void 0:Z.synastry_relational_mirror)||(null==Z?void 0:Z.relational_mirror))&&(0,s.jsx)(x,{title:"Relational Mirror",className:"print:hidden",children:(0,s.jsxs)("div",{className:"text-sm text-slate-300 space-y-2",children:[(0,s.jsx)("p",{className:"text-slate-200 font-medium",children:"Climate"}),(0,s.jsx)("p",{className:"text-slate-300",children:(null==Z?void 0:null===(m=Z.synastry_relational_mirror)||void 0===m?void 0:null===(o=m.mirror_voice)||void 0===o?void 0:o.relationship_climate)||(null==Z?void 0:null===(p=Z.relational_mirror)||void 0===p?void 0:null===(h=p.mirror_voice)||void 0===h?void 0:h.relationship_climate)||"—"}),(0,s.jsx)("p",{className:"text-slate-200 font-medium",children:"Polarity"}),(0,s.jsx)("p",{className:"text-slate-300",children:(null==Z?void 0:null===(g=Z.synastry_relational_mirror)||void 0===g?void 0:null===(b=g.mirror_voice)||void 0===b?void 0:b.polarity_summary)||(null==Z?void 0:null===(N=Z.relational_mirror)||void 0===N?void 0:null===(v=N.mirror_voice)||void 0===v?void 0:v.polarity_summary)||"—"})]})}),(()=>{var e,t,l;let a=(null==Z?void 0:null===(t=Z.person_a)||void 0===t?void 0:null===(e=t.chart)||void 0===e?void 0:e.transitsByDate)||{},i=Object.keys(a).sort();if(!i.length)return null;let n=a[i[i.length-1]],r=null==n?void 0:null===(l=n.transit_table)||void 0===l?void 0:l.markdown;return r?(0,s.jsx)(x,{title:"Raw Geometry (latest day)",children:(0,s.jsx)("pre",{className:"max-h-[24rem] overflow-auto rounded bg-slate-950 p-3 text-xs text-slate-200 whitespace-pre-wrap",children:r})}):null})(),(0,s.jsx)(x,{title:"Raw Result (debug)",className:"print:hidden",children:(0,s.jsx)("pre",{className:"max-h-[28rem] overflow-auto rounded-md bg-slate-950 p-4 text-xs text-slate-200",children:JSON.stringify(Z,null,2)})}),(0,s.jsx)("div",{className:"flex items-center justify-end print:hidden",children:(0,s.jsx)("button",{type:"button",onClick:tt,disabled:!eI||!eB,title:eI&&eB?void 0:"Sign in to continue","aria-label":eI&&eB?"Talk to Raven Calder":"Talk to Raven Calder (sign in to continue)",className:"inline-flex items-center rounded-md px-4 py-2 text-white ".concat(eI&&eB?"bg-emerald-600 hover:bg-emerald-500":"bg-emerald-700/60 cursor-not-allowed opacity-60"),children:"Talk to Raven Calder →"})})]})]}),"balance"===eQ&&(!Number(T.latitude)||!Number(T.longitude)||!T.timezone)&&(0,s.jsx)("div",{className:"mt-4 rounded-md border border-red-700 bg-red-900/30 p-3 text-red-200",children:(0,s.jsx)("p",{className:"text-sm",children:"Transits need current location to place houses correctly. Add a location or switch to Mirror (no transits)."})}),!T.hour&&!T.minute&&(0,s.jsx)("div",{className:"mt-4 rounded-md border border-slate-700 bg-slate-800/70 p-3 text-slate-200",children:(0,s.jsx)("p",{className:"text-sm",children:"Angles unavailable without birth time; houses suppressed."})}),eK&&(0,s.jsx)("div",{className:"fixed bottom-4 left-1/2 z-50 -translate-x-1/2 rounded-md border border-red-700 bg-red-900/80 px-4 py-2 text-sm text-red-100 shadow-lg",children:eK}),(0,s.jsxs)("p",{className:"mt-8 text-center text-xs text-slate-500 print:hidden",children:["Poetic Brain at ",(0,s.jsx)("span",{className:"font-medium text-slate-300",children:"/chat"})," is gated by Auth0 and requires login."]}),eK&&(0,s.jsx)("div",{className:"fixed bottom-4 right-4 z-50 rounded-md bg-red-600 px-4 py-2 text-white shadow-lg text-sm",children:eK})]})}},5216:function(e,t,l){"use strict";function s(){return window.location.origin+"/math-brain"}l.d(t,{g:function(){return s}})},816:function(e,t,l){"use strict";function s(e,t,l){let s="balance"===e||"mirror"===e&&t,a=null==l?void 0:l.latitude,i=null==l?void 0:l.longitude,n="number"==typeof a||"string"==typeof a&&""!==a.trim()&&Number.isFinite(Number(a)),r="number"==typeof i||"string"==typeof i&&""!==i.trim()&&Number.isFinite(Number(i)),o=!!(null==l?void 0:l.timezone),d=!!l&&n&&r&&o,c="number"==typeof(null==l?void 0:l.hour)||"string"==typeof(null==l?void 0:l.hour)&&""!==l.hour,u="number"==typeof(null==l?void 0:l.minute)||"string"==typeof(null==l?void 0:l.minute)&&""!==l.minute;return{needsLoc:s,hasLoc:d,hasBirthTime:c&&u,canSubmit:!s||s&&d}}function a(e){let t=e.translocation;return t&&t.applies?{active:!0,lens:"".concat(t.current_location).concat(t.house_system?" ("+t.house_system+")":""),disclosure:"Relocation ON – Houses remapped to ".concat(t.current_location),invariants:"Planetary geometry identical; only arena (House channels) shifted"}:{active:!1,lens:(null==t?void 0:t.current_location)||"Natal Base",disclosure:"Relocation OFF – natal House mapping in effect",invariants:"Planets, signs, aspects as computed from natal coordinates"}}function i(e){if(!e)return!0;let t="number"==typeof e.hour||"string"==typeof e.hour&&""!==e.hour,l="number"==typeof e.minute||"string"==typeof e.minute&&""!==e.minute;return!(t&&l)}l.d(t,{N8:function(){return s},TG:function(){return a},jA:function(){return i}})},357:function(e,t,l){"use strict";var s,a;e.exports=(null==(s=l.g.process)?void 0:s.env)&&"object"==typeof(null==(a=l.g.process)?void 0:a.env)?l.g.process:l(8081)},8081:function(e){!function(){var t={229:function(e){var t,l,s,a=e.exports={};function i(){throw Error("setTimeout has not been defined")}function n(){throw Error("clearTimeout has not been defined")}function r(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(l){try{return t.call(null,e,0)}catch(l){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{l="function"==typeof clearTimeout?clearTimeout:n}catch(e){l=n}}();var o=[],d=!1,c=-1;function u(){d&&s&&(d=!1,s.length?o=s.concat(o):c=-1,o.length&&m())}function m(){if(!d){var e=r(u);d=!0;for(var t=o.length;t;){for(s=o,o=[];++c<t;)s&&s[c].run();c=-1,t=o.length}s=null,d=!1,function(e){if(l===clearTimeout)return clearTimeout(e);if((l===n||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}(e)}}function x(e,t){this.fun=e,this.array=t}function h(){}a.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var l=1;l<arguments.length;l++)t[l-1]=arguments[l];o.push(new x(e,t)),1!==o.length||d||r(m)},x.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=h,a.addListener=h,a.once=h,a.off=h,a.removeListener=h,a.removeAllListeners=h,a.emit=h,a.prependListener=h,a.prependOnceListener=h,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},l={};function s(e){var a=l[e];if(void 0!==a)return a.exports;var i=l[e]={exports:{}},n=!0;try{t[e](i,i.exports,s),n=!1}finally{n&&delete l[e]}return i.exports}s.ab="//";var a=s(229);e.exports=a}()}},function(e){e.O(0,[971,23,744],function(){return e(e.s=2037)}),_N_E=e.O()}]);