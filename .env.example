# =============================================================================
# Woven Map Application Environment Configuration
# =============================================================================
# Copy this file to .env and configure with your actual values
# All environment variables are optional except RAPIDAPI_KEY

# =============================================================================
# API CONFIGURATION
# =============================================================================

# RapidAPI Key for Astrologer API (REQUIRED)
# Get this from your RapidAPI dashboard: https://rapidapi.com/hub
# Subscribe to the Astrologer API and copy your API key here
# Format: 32+ character alphanumeric string
RAPIDAPI_KEY=your_rapidapi_key_here

# GeoNames Username (optional but recommended)
# Used when calling natal endpoints in city-mode; stabilizes city‚Üícoords and timezone validation.
# Create a free username at https://www.geonames.org/login and verify it via email, then place it here.
# When present and you provide city + nation for a person, the backend prefers city-mode with GeoNames;
# if missing or city data is incomplete, it falls back to coords-only automatically.
# Example: GEONAMES_USERNAME=RAVENCALDER
GEONAMES_USERNAME=

# =============================================================================
# APPLICATION CONFIGURATION  
# =============================================================================

# Environment mode (optional)
# Set to 'development' for local testing, 'production' for deployment
# Default: production
NODE_ENV=development

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log level (optional)
# Controls the verbosity of application logs
# Options: 'debug', 'info', 'warn', 'error'
# - debug: Show all logs including detailed API calls and data processing
# - info: Show general operational information (default)  
# - warn: Show only warnings and errors
# - error: Show only errors
# Default: info
LOG_LEVEL=info

# =============================================================================
# AUTH0 CONFIGURATION (optional, required only if enabling Auth)
# =============================================================================

# Auth0 Domain (REQUIRED for Auth)
# Format: your-tenant.region.auth0.com (no protocol)
# Example: myspace.us.auth0.com
AUTH0_DOMAIN=your-tenant.us.auth0.com

# Auth0 SPA Client ID (REQUIRED for Auth)
# Obtain from Auth0 Dashboard ‚Üí Applications ‚Üí Your SPA ‚Üí Settings
AUTH0_CLIENT_ID=your_auth0_client_id_here

# Auth0 API Audience (optional, recommended if calling a protected API)
# Must be your custom API identifier (NOT the Management API)
# Example: https://api.yourdomain.com or woven-api
AUTH0_AUDIENCE=https://api.wovenwebapp.com

# Optional override for Auth0 redirect callback path (default '/')
# Example: /post-login
NEXT_PUBLIC_AUTH_CALLBACK_PATH=/

# Gemini AI API Key (REQUIRED for Poetic Brain feature)
# Get this from Google AI Studio: https://makersuite.google.com/app/apikey
# Used for AI-powered poetic interpretations of astrological data
GEMINI_API_KEY=your_gemini_api_key_here

# =============================================================================
# TRANSIT CALCULATION CONFIGURATION
# =============================================================================

# Transit Reference Location (optional)
# Location used as reference point for planetary positions in transit calculations
# Default: Greenwich Observatory (Prime Meridian)

# Transit reference city
# Default: Greenwich
TRANSIT_CITY=Greenwich

# Transit reference country/nation code
# Use ISO 3166-1 alpha-2 codes (e.g., US, GB, FR, DE)
# Default: GB (United Kingdom)
TRANSIT_NATION=GB

# Transit reference coordinates
# Latitude in decimal degrees (-90 to 90)
# Default: 51.4825766 (Greenwich Observatory)
TRANSIT_LATITUDE=51.4825766

# Longitude in decimal degrees (-180 to 180)  
# Default: 0 (Prime Meridian)
TRANSIT_LONGITUDE=0

# Transit reference timezone
# Use IANA timezone identifiers (e.g., UTC, America/New_York, Europe/London)
# Default: UTC
TRANSIT_TIMEZONE=UTC

# =============================================================================
# PERFORMANCE AND RATE LIMITING
# =============================================================================

# API Rate Limiting (optional)
# Maximum API calls per minute to prevent quota exhaustion
# Adjust based on your RapidAPI subscription plan
# Default: 60 calls per minute
API_RATE_LIMIT=60

# Transit Batch Processing (optional)
# Number of concurrent transit calculations per batch
# Lower values reduce load on API but increase processing time
# Higher values speed up processing but may trigger rate limits
# Recommended: 3-10 depending on your API plan
# Default: 5
TRANSIT_BATCH_SIZE=5

# Transit Batch Delay (optional)
# Delay between batches in milliseconds
# Helps prevent rate limiting by spacing out API calls
# Minimum recommended: 100ms
# Default: 500ms
TRANSIT_BATCH_DELAY=500

# =============================================================================
# SECURITY CONSIDERATIONS
# =============================================================================

# Production Security Notes:
# 1. Never commit your actual .env file to version control
# 2. Use a secrets management service for production deployments
# 3. Regularly rotate your API keys
# 4. Monitor API usage to detect unusual activity
# 5. Consider using environment-specific API keys for development vs production

# For production deployments, consider using:
# - AWS Secrets Manager
# - Azure Key Vault  
# - HashiCorp Vault
# - Google Secret Manager
# - Platform-specific secret management (Netlify, Vercel, etc.)

# =============================================================================
# SECURITY BEST PRACTICES
# =============================================================================

# üîê API Key Security:
# - Never commit your actual API key to version control
# - Use different API keys for development and production
# - Regularly rotate API keys (recommended: every 90 days)
# - Monitor API key usage for unexpected activity

# üè≠ Production Security:
# - Use a secrets management system (AWS Secrets Manager, HashiCorp Vault, etc.)
# - Set up monitoring and alerting for API quota usage
# - Implement request rate limiting at the application/infrastructure level
# - Use HTTPS-only for all communications
# - Enable request logging for security auditing

# üîç Monitoring and Logging:
# - Set LOG_LEVEL=warn or LOG_LEVEL=error in production
# - Monitor memory usage and response times
# - Set up alerts for error rates > 5%
# - Track API quota consumption
# - Use unique error IDs for tracking issues

# üõ°Ô∏è Infrastructure Security:
# - Use environment-specific configurations
# - Implement proper CORS policies
# - Set up content security policies (CSP)
# - Use secure headers (HSTS, X-Frame-Options, etc.)
# - Regularly update dependencies

# üìä Performance Monitoring:
# - Monitor average response times (should be < 5 seconds)
# - Track API call patterns and optimize batching
# - Monitor memory usage (heap should not grow continuously)
# - Set up alerts for rate limit approaches (> 80% of quota)

# Example production security configuration:
# NODE_ENV=production
# LOG_LEVEL=warn
# API_RATE_LIMIT=50
# TRANSIT_BATCH_SIZE=3
# TRANSIT_BATCH_DELAY=1000

# =============================================================================
# TROUBLESHOOTING
# =============================================================================

# Common Issues:
# 
# 1. "Authentication failed" error:
#    - Verify RAPIDAPI_KEY is correct and active
#    - Check your RapidAPI subscription status
#    - Ensure you're subscribed to the Astrologer API
#
# 2. "Too many requests" error:
#    - Reduce TRANSIT_BATCH_SIZE (try 3 or lower)
#    - Increase TRANSIT_BATCH_DELAY (try 1000ms or higher)
#    - Check your API plan limits
#
# 3. Slow transit calculations:
#    - Increase TRANSIT_BATCH_SIZE (up to 10)
#    - Decrease TRANSIT_BATCH_DELAY (minimum 100ms)
#    - Consider upgrading your API plan
#
# 4. Missing transit data:
#    - Set LOG_LEVEL=debug to see detailed processing logs
#    - Check date format (use YYYY-MM-DD)
#    - Verify date ranges are reasonable (avoid very large ranges)

# =============================================================================
# DEVELOPMENT TIPS
# =============================================================================

# For local development:
# 1. Set LOG_LEVEL=debug for detailed logging
# 2. Use smaller date ranges for transit testing
# 3. Monitor your API usage in the RapidAPI dashboard
# 4. Test with known good birth data before deploying

# Example development configuration:
# LOG_LEVEL=debug
# TRANSIT_BATCH_SIZE=3
# TRANSIT_BATCH_DELAY=1000
